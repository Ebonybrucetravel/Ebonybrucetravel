{
	"info": {
		"_postman_id": "ebony-bruce-travels-api-v2",
		"name": "Ebony Bruce Travels API",
		"description": "Complete API collection for Ebony Bruce Travels Booking System\n\n**Base URL:** `{{baseUrl}}/api/v1`\n\n**Authentication:** Most endpoints require JWT Bearer token. Get token from `/auth/login` or `/auth/register`.\n\n**Environment Variables:**\n- `baseUrl`: http://localhost:3001 (or your Railway URL)\n- `token`: JWT token (auto-set after login)\n- `userId`: User ID (auto-set after login)\n- `offerRequestId`: Duffel offer request ID (auto-set after flight search)\n- `offerId`: Selected flight offer ID (auto-set after listing offers)\n- `nextCursor`: Pagination cursor for next page (auto-set)\n- `bookingId`: Booking ID (auto-set after creating booking)\n- `voucherCode`: Voucher code (auto-set after redeeming loyalty points)\n- `setupIntentClientSecret`: Stripe SetupIntent secret (auto-set after payment method setup)\n- `contactSubmissionId`: Contact submission ID (auto-set after Submit Contact Us)\n\n**Features (v3.0 - Complete):**\n- Authentication (register, login, OAuth, password reset, email verification)\n- User Profile (CRUD, avatar, password change, soft delete)\n- Loyalty Points System (earn, redeem, tiers, transactions)\n- Rewards & Vouchers (admin-configurable rules, percentage/fixed discounts)\n- Saved Payment Methods (PCI-compliant via Stripe tokenization)\n- Saved Items / Wishlist (hotels, flights, car rentals)\n- Saved Travelers (passport, nationality, frequent flyer)\n- User Dashboard (aggregated profile data)\n- Flight Search (Duffel - two-step with pagination)\n- Hotel Search & Booking (Amadeus recommended + Duffel)\n- Car Rental Search & Booking (Amadeus Transfers)\n- Payments (Stripe with voucher support)\n- Admin Management (users, bookings, rewards, audit logs, dashboard)\n- Contact Us (public form; confirmation + super-admin notifications)\n- Health Check endpoints\n- Rate Limiting, CORS, Correlation IDs\n\n---\n\n## API Sections\n\n### 1. Authentication\nRegister, Login, OAuth (Facebook/Google), Password Reset, Email Verification, Logout. **For admin actions use the protected Admin Auth routes:** `POST /admin/auth/login` and `POST /admin/auth/logout` (only ADMIN/SUPER_ADMIN can get a token from admin login; customers get 403).\n\n### 2. User Profile\nGet/Update Profile, Upload Avatar, Change Password, Delete Account\n\n### 3. Loyalty & Rewards\nGet Loyalty Account, Transaction History, Available Rewards, Redeem Points, Validate/Get Vouchers\n\n### 4. Saved Payment Methods\nSetup (Stripe SetupIntent), Confirm, List, Set Default, Delete\n\n### 5. Saved Items (Wishlist)\nSave/Unsave Items, Toggle, Check Status, Get Counts, Update Notes\n\n### 6. Saved Travelers\nCreate/List/Get/Update/Delete Travelers, Batch Fetch\n\n### 7. User Dashboard\nAggregated profile data (loyalty, bookings, stats) in single call\n\n### 8. Health Check\nService health, Database health\n\n### 9. Contact Us\nPublic form: POST /contact (name, email, serviceInterestedIn, message; optional phone). Confirmation to submitter; super admins (from DB) notified.\n\n### 10. Flight Search & Offers\nTwo-step search (offer_request_id -> paginated offers)\n\n### 11. Bookings\nCreate (auth/guest), List, Get, Cancel\n\n### 12. Payments\nCreate Payment Intent (with optional voucher), Guest Payment Intent, Stripe Webhook\n\n### 13. Hotels\nAmadeus (recommended), Duffel, Common Operations, Images\n\n### 14. Car Rentals\nSearch, Create Booking, Cancel\n\n### 15. Flight Utilities\nPlace Suggestions, Airlines List\n\n### 16. Platform Settings (Markups)\nList, Create, Update, Deactivate markup configs (productType, markup %, service fee). Admin only.\n\n### 17. Admin\n**Admin Auth (protected):** POST /admin/auth/login, POST /admin/auth/logout ‚Äî use for all admin sign-in/sign-out. User Management, Customer Management, Booking Management, Rewards, Contact Submissions, Cancellation Requests, Recent Activity, Audit Logs, Dashboard Stats\n\n---\n\n## Quick Start Guide\n\n### Step 1: Authentication\n1. Register or Login to get JWT token\n2. Token auto-saved to `{{token}}`\n\n### Step 2: Initial Setup (Admin - Run Once)\n1. Seed loyalty tiers: `POST /admin/rewards/tiers/seed-defaults`\n2. Seed earning rules: `POST /admin/rewards/earning-rules/seed-defaults`\n3. Create reward rules: `POST /admin/rewards/rules`\n\n### Step 3: Search & Book\n1. Search flights/hotels/cars\n2. Create booking with offer details\n3. Optionally validate and apply voucher\n4. Create payment intent (with optional `voucherCode`)\n5. Complete payment via Stripe.js\n6. Webhook confirms booking + awards loyalty points\n\n### Step 4: Profile Features\n1. Check loyalty points: `GET /users/me/loyalty`\n2. Save items to wishlist: `POST /users/me/saved-items`\n3. Add travelers: `POST /users/me/travelers`\n4. Save payment methods: `POST /users/me/payment-methods/setup`\n5. View dashboard: `GET /users/me/dashboard`\n\n---\n\n## Loyalty & Voucher Flow\n\n1. **Earn Points**: Automatically on completed bookings (via webhook)\n2. **Check Balance**: `GET /users/me/loyalty`\n3. **Browse Rewards**: `GET /users/me/loyalty/available-rewards`\n4. **Redeem Points**: `POST /users/me/loyalty/redeem` -> Get voucher code\n5. **Validate Voucher**: `POST /users/me/vouchers/validate`\n6. **Apply at Payment**: `POST /payments/stripe/create-intent` with `voucherCode`\n7. **Auto-Complete**: Webhook marks voucher USED, awards points on new booking\n\n**Tiers:** BRONZE (1x) -> SILVER (1.5x) -> GOLD (2x) -> PLATINUM (3x)\n\n---\n\n## Payment Flow\n\n1. **Create Booking** -> Get `bookingId`\n2. **Optional: Validate Voucher** -> Preview discount\n3. **Create Payment Intent** -> Get `clientSecret` (with optional `voucherCode`)\n4. Use `clientSecret` with Stripe.js on frontend\n5. Webhook updates booking + awards loyalty points + marks voucher used\n\n---\n\n## Security\n\n- Rate limiting on auth endpoints\n- JWT authentication\n- PCI-compliant payment method storage (Stripe tokenization)\n- AES-256-GCM encryption for hotel card details\n- Audit logging for admin actions\n- CORS configuration\n- Request correlation IDs\n- Email verification\n- Delayed login notifications",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.token) {",
									"        pm.environment.set('token', response.token);",
									"        pm.environment.set('userId', response.user.id);",
									"        console.log('Token saved:', response.token);",
									"    }",
									"}",
									"",
									"pm.test('Status code is 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test('Response has user and token', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('user');",
									"    pm.expect(response).to.have.property('token');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"john.doe@example.com\",\n  \"name\": \"John Doe\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/register",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"register"
							]
						},
						"description": "Register a new user account.\n\n**No authentication required.**\n\n**Rate Limit:** 3 requests per minute\n\n**Request Body:**\n- `email` (string, required): User email address\n- `name` (string, required): User full name\n- `password` (string, required): Password (min 6 characters)\n\n**Response:**\n- Returns user object and JWT token\n- Token is automatically saved to environment variable\n- **Verification email sent** - Check email for verification link\n- Email verification is optional but recommended\n\n**Email Verification:**\n- Verification email sent immediately after registration\n- Contains verification link with token\n- Token expires in 24 hours\n- Use `/auth/verify-email` endpoint to verify\n\n**Error Responses:**\n- `409 Conflict` - Email already exists\n- `429 Too Many Requests` - Rate limit exceeded (3/min)\n\n**Note:** After registration, you'll receive a welcome email with email verification link."
					},
					"response": []
				},
				{
					"name": "Login User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.token) {",
									"        pm.environment.set('token', response.token);",
									"        pm.environment.set('userId', response.user.id);",
									"        console.log('Token saved:', response.token);",
									"    }",
									"}",
									"",
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"john.doe@example.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"login"
							]
						},
						"description": "Login with email and password for **customers**. (For admin sign-in use **Admin ‚Üí Admin Auth ‚Üí Admin Login** instead; that route is protected and only allows ADMIN/SUPER_ADMIN.)\n\n**No authentication required.**\n\n**Rate Limit:** 5 requests per minute\n\n**Request Body:**\n- `email` (string, required): User email address\n- `password` (string, required): User password\n\n**Response:**\n- Returns user object (including `role`: CUSTOMER, ADMIN, SUPER_ADMIN) and JWT token\n- Token is automatically saved to `{{token}}`; use it for Admin endpoints when logged in as admin\n\n**Security Features:**\n- **Delayed Login Notification**: Email sent 10-20 minutes after login (random delay)\n- Notification includes IP address, device info, and login time\n- Link to change password if suspicious activity detected\n- Helps detect unauthorized access\n\n**Error Responses:**\n- `401 Unauthorized` - Invalid credentials\n- `401 Unauthorized` - Account deleted\n- `401 Unauthorized` - OAuth-only account (use social login)\n- `429 Too Many Requests` - Rate limit exceeded (5/min)\n\n**Note:**\n- OAuth users (Facebook/Google) cannot use email/password login\n- Deleted accounts cannot log in\n- Login notification email is sent asynchronously (doesn't delay login response)"
					},
					"response": []
				},
				{
					"name": "Facebook OAuth Login",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"console.log('üîµ Initiating Facebook OAuth login...');",
									"console.log('üí° Note: This will redirect to Facebook for authentication');",
									"console.log('üí° After authentication, you will be redirected to the callback URL');"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"// OAuth redirects to external provider, so we check for redirect",
									"if (pm.response.code === 302 || pm.response.code === 200) {",
									"    console.log('‚úÖ Facebook OAuth initiated');",
									"    console.log('üí° Follow the redirect to complete authentication');",
									"}",
									"",
									"pm.test('OAuth flow initiated', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 302]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/facebook",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"facebook"
							]
						},
						"description": "Initiate Facebook OAuth login.\n\n**No authentication required.**\n\n**How it works:**\n1. This endpoint redirects to Facebook for authentication\n2. User authorizes the app on Facebook\n3. Facebook redirects to `/auth/facebook/callback`\n4. Backend creates/updates user and generates JWT token\n5. User is redirected to frontend with token in query params\n\n**Frontend Integration:**\n- Redirect user to this endpoint: `GET /api/v1/auth/facebook`\n- Handle callback at `/auth/callback?token=...&user=...`\n- Extract token and user from query params\n- Store token and redirect to dashboard\n\n**Environment Variables Required:**\n- `FACEBOOK_APP_ID` - Facebook App ID\n- `FACEBOOK_APP_SECRET` - Facebook App Secret\n- `FACEBOOK_CALLBACK_URL` - Callback URL (default: `/api/v1/auth/facebook/callback`)\n- `FRONTEND_URL` - Frontend URL for redirect after auth (default: `http://localhost:3000`)\n\n**Graceful Handling:**\n- If OAuth credentials are not configured, endpoint returns error gracefully\n- Application continues to work without OAuth\n- Check logs for OAuth configuration status\n\n**Note:** In Postman, this will show a redirect. In a browser, it will redirect to Facebook."
					},
					"response": []
				},
				{
					"name": "Google OAuth Login",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"console.log('üî¥ Initiating Google OAuth login...');",
									"console.log('üí° Note: This will redirect to Google for authentication');",
									"console.log('üí° After authentication, you will be redirected to the callback URL');"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"// OAuth redirects to external provider, so we check for redirect",
									"if (pm.response.code === 302 || pm.response.code === 200) {",
									"    console.log('‚úÖ Google OAuth initiated');",
									"    console.log('üí° Follow the redirect to complete authentication');",
									"}",
									"",
									"pm.test('OAuth flow initiated', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 302]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/google",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"google"
							]
						},
						"description": "Initiate Google OAuth login.\n\n**No authentication required.**\n\n**How it works:**\n1. This endpoint redirects to Google for authentication\n2. User authorizes the app on Google\n3. Google redirects to `/auth/google/callback`\n4. Backend creates/updates user and generates JWT token\n5. User is redirected to frontend with token in query params\n\n**Frontend Integration:**\n- Redirect user to this endpoint: `GET /api/v1/auth/google`\n- Handle callback at `/auth/callback?token=...&user=...`\n- Extract token and user from query params\n- Store token and redirect to dashboard\n\n**Environment Variables Required:**\n- `GOOGLE_CLIENT_ID` - Google OAuth Client ID\n- `GOOGLE_CLIENT_SECRET` - Google OAuth Client Secret\n- `GOOGLE_CALLBACK_URL` - Callback URL (default: `/api/v1/auth/google/callback`)\n- `FRONTEND_URL` - Frontend URL for redirect after auth (default: `http://localhost:3000`)\n\n**Graceful Handling:**\n- If OAuth credentials are not configured, endpoint returns error gracefully\n- Application continues to work without OAuth\n- Check logs for OAuth configuration status\n\n**Note:** In Postman, this will show a redirect. In a browser, it will redirect to Google."
					},
					"response": []
				},
				{
					"name": "Forgot Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Password reset email sent', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('message');",
									"    console.log('‚úÖ Password reset email sent (if account exists)');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"user@example.com\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/forgot-password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"forgot-password"
							]
						},
						"description": "Request password reset email.\n\n**No authentication required.**\n\n**Rate Limit:** 3 requests per minute\n\n**Request Body:**\n- `email` (string, required): User email address\n\n**Response:**\n- Always returns success (security best practice - doesn't reveal if email exists)\n- If account exists, password reset email is sent\n- Reset token expires in 1 hour\n\n**Security:**\n- Does not reveal if email exists (prevents email enumeration)\n- Reset link sent to email if account exists\n- OAuth-only accounts are silently ignored\n\n**Error Responses:**\n- `429 Too Many Requests` - Rate limit exceeded (3/min)\n\n**Note:** Check email for password reset link. The link expires in 1 hour."
					},
					"response": []
				},
				{
					"name": "Reset Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Password reset successful', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('message');",
									"    console.log('‚úÖ Password reset successfully');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"token\": \"reset-token-from-email\",\n  \"newPassword\": \"newSecurePassword123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/reset-password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"reset-password"
							]
						},
						"description": "Reset password with token from email.\n\n**No authentication required.**\n\n**Rate Limit:** 5 requests per minute\n\n**Request Body:**\n- `token` (string, required): Reset token from password reset email\n- `newPassword` (string, required): New password (min 6 characters)\n\n**Response:**\n- Returns success message\n- Password is updated\n- User can now login with new password\n\n**Error Responses:**\n- `400 Bad Request` - Invalid or expired token\n- `429 Too Many Requests` - Rate limit exceeded (5/min)\n\n**Note:**\n- Token expires in 1 hour\n- Token can only be used once\n- After reset, user must login with new password"
					},
					"response": []
				},
				{
					"name": "Verify Email",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Email verified successfully', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('message');",
									"    console.log('‚úÖ Email verified successfully');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"token\": \"verification-token-from-email\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/verify-email",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"verify-email"
							]
						},
						"description": "Verify email address with token from registration email.\n\n**No authentication required.**\n\n**Rate Limit:** 10 requests per minute\n\n**Request Body:**\n- `token` (string, required): Verification token from registration email\n\n**Response:**\n- Returns success message\n- Email is marked as verified\n- `emailVerified` field set to `true`\n\n**Error Responses:**\n- `400 Bad Request` - Invalid or expired token\n- `400 Bad Request` - Email already verified\n- `429 Too Many Requests` - Rate limit exceeded (10/min)\n\n**Note:**\n- Token expires in 24 hours\n- Token can only be used once\n- Email verification is optional but recommended\n- Verification link is sent in welcome email after registration"
					},
					"response": []
				},
				{
					"name": "Logout User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    console.log('‚úÖ Logout successful');",
									"    console.log('üí° Note: Remove token from client storage on frontend');",
									"    // Optionally clear token from environment (uncomment if desired)",
									"    // pm.environment.unset('token');",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/logout",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"logout"
							]
						},
						"description": "Logout for **customers**. (Admins should use **Admin ‚Üí Admin Auth ‚Üí Admin Logout**.)\n\n**Authentication required.** Bearer token.\n\n**What This Does:**\n- Confirms logout on the server side\n- Since we use stateless JWT tokens, logout is primarily handled client-side\n- Client should remove the token from storage (localStorage/sessionStorage)\n- This endpoint is useful for:\n  - Audit logging\n  - Confirming logout action\n  - Optional: Server-side token blacklisting (if implemented)\n\n**Response:**\n- Returns success message\n- Client should remove token from storage\n\n**Note:**\n- JWT tokens are stateless - they remain valid until expiration\n- Frontend must remove token from storage to complete logout\n- Token expiration is handled by JWT expiry time\n- If you implement token blacklisting, this endpoint would add token to blacklist"
					},
					"response": []
				}
			],
			"description": "Authentication endpoints for **customers**: registration, login, logout, password reset, email verification, OAuth. **For admin:** use the protected **Admin ‚Üí Admin Auth** folder (POST /admin/auth/login and POST /admin/auth/logout); only ADMIN/SUPER_ADMIN can obtain a token from admin login.\n\n**OAuth Flow:**\n1. User clicks \"Login with Facebook/Google\" on frontend\n2. Frontend redirects to `/auth/facebook` or `/auth/google`\n3. Backend redirects to OAuth provider (Facebook/Google)\n4. User authorizes on OAuth provider\n5. OAuth provider redirects to callback endpoint\n6. Backend creates/updates user and generates JWT token\n7. Backend redirects to frontend with token: `{FRONTEND_URL}/auth/callback?token=...&user=...`\n8. Frontend extracts token and stores it (localStorage/sessionStorage)\n9. Frontend redirects user to dashboard\n\n**Account Linking:**\n- If user logs in with OAuth and email already exists, OAuth account is linked to existing email account\n- If user logs in with email/password and then uses OAuth with same email, accounts are automatically linked"
		},
		{
			"name": "User Profile",
			"item": [
				{
					"name": "Get My Profile",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has user profile', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('id');",
									"    pm.expect(response).to.have.property('email');",
									"    pm.expect(response).to.have.property('name');",
									"    pm.expect(response).to.have.property('role');",
									"    console.log('‚úÖ Profile retrieved:', response.email);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me"
							]
						},
						"description": "Get current user's profile information.\n\n**Authentication required.**\n\n**Response includes:**\n- id, email, name, phone\n- image (Cloudinary URL)\n- dateOfBirth, gender\n- role, timestamps"
					},
					"response": []
				},
				{
					"name": "Update Profile",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Profile updated successfully', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('id');",
									"    pm.expect(response).to.have.property('email');",
									"    console.log('‚úÖ Profile updated:', response.name || response.email);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Seyi Obadeyi\",\n  \"phone\": \"+2348165000000\",\n  \"dateOfBirth\": \"1992-05-15\",\n  \"gender\": \"Male\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me"
							]
						},
						"description": "Update user profile information.\n\n**Authentication required.**\n\n**Editable fields:**\n- `name` - Full name\n- `phone` - Phone number\n- `dateOfBirth` - Date of birth (YYYY-MM-DD format)\n- `gender` - Gender (Male, Female, Other, Prefer not to say)\n\n**Note:** Email cannot be changed (security)."
					},
					"response": []
				},
				{
					"name": "Upload Profile Image",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Image uploaded successfully', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('image');",
									"    if (response.image) {",
									"        console.log('‚úÖ Image uploaded:', response.image);",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "image",
									"type": "file",
									"src": [],
									"description": "Profile image file (jpg, jpeg, png, gif, webp). Max 5MB. Auto-resized to 400x400px."
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/avatar",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"avatar"
							]
						},
						"description": "Upload or update user profile image.\n\n**Authentication required.**\n\n**Requirements:**\n- File format: jpg, jpeg, png, gif, webp\n- Max file size: 5MB\n- Auto-resized to 400x400px\n- Stored in Cloudinary\n- Old image automatically deleted when updating\n\n**Field name:** `image` (multipart/form-data)"
					},
					"response": []
				},
				{
					"name": "Change Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Password changed successfully', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('message');",
									"    console.log('‚úÖ Password changed successfully');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"currentPassword\": \"oldPassword123\",\n  \"newPassword\": \"newPassword123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"password"
							]
						},
						"description": "Change user password.\n\n**Authentication required.**\n\n**Request Body:**\n- `currentPassword` (string, required): Current password\n- `newPassword` (string, required): New password (minimum 6 characters)\n\n**Security:**\n- Current password is verified before allowing change\n- Password change is logged to audit table\n- Includes IP address and user agent in audit log\n\n**Error Responses:**\n- `400 Bad Request` - Invalid current password or OAuth account (cannot change password for social login accounts)\n- `401 Unauthorized` - Current password is incorrect\n- `404 Not Found` - User not found\n\n**Note:** OAuth users (Facebook/Google) cannot change password. They must use social login."
					},
					"response": []
				},
				{
					"name": "Delete Account",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Account deleted successfully', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('message');",
									"    console.log('‚úÖ Account deleted successfully');",
									"    console.log('‚ö†Ô∏è  Note: This is a soft delete. Account data is preserved but marked as deleted.');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me"
							]
						},
						"description": "Delete user account (soft delete).\n\n**Authentication required.**\n\n**What happens:**\n- Account is soft deleted (marked as deleted, not permanently removed)\n- Email is anonymized to ensure uniqueness\n- Profile image is deleted from Cloudinary\n- User cannot log in after deletion\n\n**Restrictions:**\n- Cannot delete account with active bookings (PENDING, PAYMENT_PENDING, CONFIRMED)\n- Must cancel or complete all bookings first\n\n**Error Responses:**\n- `400 Bad Request` - Account has active bookings\n\n**Note:** This is a soft delete. Account data is preserved for audit purposes but the user cannot log in."
					},
					"response": []
				}
			],
			"description": "User profile management endpoints.\n\n**All endpoints require authentication.**\n\n**Features:**\n- Get profile information\n- Update profile (name, phone, date of birth, gender)\n- Upload profile image to Cloudinary\n- Change password (email/password accounts only)\n- Delete account (soft delete)\n\n**Security & Audit:**\n- Password changes are logged to audit table\n- Account deletions are logged to audit table\n- Includes IP address and user agent in audit logs\n\n**Note:** Email cannot be changed (security requirement). OAuth users cannot change password."
		},
		{
			"name": "Loyalty & Rewards",
			"item": [
				{
					"name": "Get My Loyalty Account",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/loyalty",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"loyalty"
							]
						},
						"description": "**Get current user's loyalty account details.**\n\n**Authentication required.**\n\n**Response:**\n```json\n{\n  \"id\": \"loyalty-account-id\",\n  \"userId\": \"user-id\",\n  \"points\": 2500,\n  \"lifetimePoints\": 5000,\n  \"tier\": \"SILVER\",\n  \"tierName\": \"Silver\",\n  \"tierMultiplier\": 1.5,\n  \"nextTier\": \"GOLD\",\n  \"pointsToNextTier\": 2500,\n  \"createdAt\": \"2026-01-01T00:00:00.000Z\"\n}\n```\n\n**Fields:**\n- `points`: Current available points (can be redeemed)\n- `lifetimePoints`: Total points earned (used for tier calculation)\n- `tier`: Current loyalty tier (BRONZE, SILVER, GOLD, PLATINUM)\n- `tierMultiplier`: Points earning multiplier for current tier\n- `nextTier`: Next tier to achieve\n- `pointsToNextTier`: Points needed to reach next tier\n\n**Note:** Account is auto-created on first access."
					},
					"response": []
				},
				{
					"name": "Get Loyalty Transactions",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/loyalty/transactions",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"loyalty",
								"transactions"
							]
						},
						"description": "**Get loyalty points transaction history.**\n\n**Authentication required.**\n\n**Response:**\nArray of transactions:\n```json\n[\n  {\n    \"id\": \"tx-id\",\n    \"type\": \"EARN\",\n    \"points\": 500,\n    \"description\": \"Points earned from booking EBT-20260212-ABC123\",\n    \"bookingId\": \"booking-id\",\n    \"createdAt\": \"2026-02-12T10:00:00.000Z\"\n  },\n  {\n    \"id\": \"tx-id-2\",\n    \"type\": \"REDEEM\",\n    \"points\": -1000,\n    \"description\": \"Redeemed for 10% discount voucher\",\n    \"createdAt\": \"2026-02-10T10:00:00.000Z\"\n  }\n]\n```\n\n**Transaction Types:**\n- `EARN` - Points earned from bookings\n- `REDEEM` - Points spent on vouchers/rewards\n- `BONUS` - Bonus points (admin-adjusted)\n- `EXPIRE` - Points expired\n- `ADJUSTMENT` - Manual adjustment by admin"
					},
					"response": []
				},
				{
					"name": "Get Available Rewards",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/loyalty/available-rewards",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"loyalty",
								"available-rewards"
							]
						},
						"description": "**Get rewards available for redemption with current points.**\n\n**Authentication required.**\n\n**Response:**\n```json\n[\n  {\n    \"id\": \"rule-id\",\n    \"name\": \"10% Discount Voucher\",\n    \"description\": \"Get 10% off your next booking\",\n    \"pointsCost\": 1000,\n    \"discountType\": \"PERCENTAGE\",\n    \"discountValue\": 10,\n    \"maxDiscountAmount\": 100,\n    \"applicableProductTypes\": [\"FLIGHT_INTERNATIONAL\", \"HOTEL\"],\n    \"isActive\": true,\n    \"canAfford\": true\n  },\n  {\n    \"id\": \"rule-id-2\",\n    \"name\": \"$50 Off Voucher\",\n    \"pointsCost\": 2500,\n    \"discountType\": \"FIXED\",\n    \"discountValue\": 50,\n    \"applicableProductTypes\": null,\n    \"isActive\": true,\n    \"canAfford\": false\n  }\n]\n```\n\n**Discount Types:**\n- `PERCENTAGE` - Percentage off booking total (e.g., 10%)\n- `FIXED` - Fixed amount off (e.g., $50)\n\n**Note:** `canAfford` indicates if user has enough points."
					},
					"response": []
				},
				{
					"name": "Redeem Points for Voucher",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200 || pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.voucher && response.voucher.code) {",
									"        pm.environment.set('voucherCode', response.voucher.code);",
									"        console.log('Voucher code saved:', response.voucher.code);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"rewardRuleId\": \"reward-rule-id-from-available-rewards\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/loyalty/redeem",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"loyalty",
								"redeem"
							]
						},
						"description": "**Redeem loyalty points for a voucher/discount.**\n\n**Authentication required.**\n\n**Request Body:**\n- `rewardRuleId` (string, required): ID of the reward rule to redeem. Get from `GET /api/v1/users/me/loyalty/available-rewards`.\n\n**Response:**\n```json\n{\n  \"voucher\": {\n    \"id\": \"voucher-id\",\n    \"code\": \"EBT-V-ABC123\",\n    \"discountType\": \"PERCENTAGE\",\n    \"discountValue\": 10,\n    \"maxDiscountAmount\": 100,\n    \"expiresAt\": \"2026-03-12T00:00:00.000Z\",\n    \"status\": \"ACTIVE\"\n  },\n  \"pointsDeducted\": 1000,\n  \"remainingPoints\": 1500\n}\n```\n\n**Flow:**\n1. Check available rewards: `GET /me/loyalty/available-rewards`\n2. Select a reward you can afford\n3. Redeem: `POST /me/loyalty/redeem` with `rewardRuleId`\n4. Receive voucher code\n5. Use voucher code during payment: `POST /payments/stripe/create-intent` with `voucherCode`\n\n**Error Responses:**\n- `400` - Insufficient points\n- `404` - Reward rule not found\n- `400` - Reward rule is inactive"
					},
					"response": []
				},
				{
					"name": "Validate Voucher",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"voucherCode\": \"{{voucherCode}}\",\n  \"productType\": \"FLIGHT_INTERNATIONAL\",\n  \"bookingAmount\": 500.00,\n  \"currency\": \"USD\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/vouchers/validate",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"vouchers",
								"validate"
							]
						},
						"description": "**Validate a voucher code and preview discount.**\n\n**Authentication required.**\n\n**Request Body:**\n- `voucherCode` (string, required): Voucher code to validate\n- `productType` (string, required): Product type (FLIGHT_INTERNATIONAL, FLIGHT_DOMESTIC, HOTEL, CAR_RENTAL)\n- `bookingAmount` (number, required): Booking amount before discount\n- `currency` (string, required): Currency code (e.g., USD, GBP)\n\n**Response (valid voucher):**\n```json\n{\n  \"valid\": true,\n  \"originalAmount\": 500.00,\n  \"discountAmount\": 50.00,\n  \"finalAmount\": 450.00,\n  \"currency\": \"USD\",\n  \"voucherCode\": \"EBT-V-ABC123\",\n  \"voucherId\": \"voucher-id\",\n  \"discountType\": \"PERCENTAGE\",\n  \"discountValue\": 10\n}\n```\n\n**Response (invalid voucher):**\n```json\n{\n  \"valid\": false,\n  \"message\": \"Voucher has expired\"\n}\n```\n\n**Use this before creating payment intent to preview the discount.**\n\n**Error Scenarios:**\n- Voucher expired\n- Voucher already used\n- Voucher not applicable to product type\n- Voucher belongs to different user\n- Invalid voucher code"
					},
					"response": []
				},
				{
					"name": "Get My Vouchers",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/vouchers",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"vouchers"
							]
						},
						"description": "**Get all vouchers belonging to the current user.**\n\n**Authentication required.**\n\n**Response:**\n```json\n[\n  {\n    \"id\": \"voucher-id\",\n    \"code\": \"EBT-V-ABC123\",\n    \"discountType\": \"PERCENTAGE\",\n    \"discountValue\": 10,\n    \"maxDiscountAmount\": 100,\n    \"status\": \"ACTIVE\",\n    \"expiresAt\": \"2026-03-12T00:00:00.000Z\",\n    \"usedAt\": null,\n    \"bookingId\": null\n  },\n  {\n    \"id\": \"voucher-id-2\",\n    \"code\": \"EBT-V-DEF456\",\n    \"discountType\": \"FIXED\",\n    \"discountValue\": 50,\n    \"status\": \"USED\",\n    \"usedAt\": \"2026-02-10T10:00:00.000Z\",\n    \"bookingId\": \"booking-id\"\n  }\n]\n```\n\n**Voucher Statuses:**\n- `ACTIVE` - Available for use\n- `USED` - Already redeemed on a booking\n- `EXPIRED` - Expired (past expiresAt date)"
					},
					"response": []
				}
			],
			"description": "**Loyalty points, rewards, and voucher endpoints.**\n\n**All endpoints require authentication.**\n\n**How Loyalty Works:**\n1. **Earn Points**: Automatically earn points when bookings are completed (via webhook)\n2. **Check Balance**: View current points, tier, and transaction history\n3. **Browse Rewards**: See available rewards you can redeem\n4. **Redeem Points**: Exchange points for voucher codes\n5. **Use Vouchers**: Apply voucher code during payment for discounts\n\n**Loyalty Tiers:**\n- BRONZE (0-999 points): 1x multiplier\n- SILVER (1000-4999 points): 1.5x multiplier\n- GOLD (5000-9999 points): 2x multiplier\n- PLATINUM (10000+ points): 3x multiplier\n\n**Points Earning:**\n- International flights: 10 points per $1\n- Domestic flights: 5 points per $1\n- Hotels: 8 points per $1\n- Car rentals: 3 points per $1\n- Tier multiplier applied on top\n\n**Voucher Types:**\n- PERCENTAGE discount (e.g., 10% off, max $100)\n- FIXED discount (e.g., $50 off)"
		},
		{
			"name": "Saved Payment Methods",
			"item": [
				{
					"name": "Setup Payment Method (Get Setup Intent)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200 || pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.clientSecret) {",
									"        pm.environment.set('setupIntentClientSecret', response.clientSecret);",
									"        console.log('Setup intent client secret saved');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/payment-methods/setup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"payment-methods",
								"setup"
							]
						},
						"description": "**Create a Stripe SetupIntent to save a new payment method.**\n\n**Authentication required.**\n\n**What This Does:**\n- Creates a Stripe SetupIntent\n- Returns `clientSecret` for Stripe.js\n- Frontend uses `stripe.confirmCardSetup(clientSecret)` to save card\n\n**Response:**\n```json\n{\n  \"clientSecret\": \"seti_xxx_secret_xxx\",\n  \"setupIntentId\": \"seti_xxx\"\n}\n```\n\n**Frontend Flow:**\n1. Call this endpoint to get `clientSecret`\n2. Use Stripe.js: `stripe.confirmCardSetup(clientSecret, { payment_method: { card: cardElement } })`\n3. After setup completes, call `POST /me/payment-methods/confirm` with the SetupIntent ID\n4. Card is saved securely via Stripe tokenization\n\n**Security:**\n- Card details NEVER touch your server\n- Stripe handles PCI compliance\n- Only Stripe tokens stored in database"
					},
					"response": []
				},
				{
					"name": "Confirm Payment Method Setup",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"setupIntentId\": \"seti_xxx\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/payment-methods/confirm",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"payment-methods",
								"confirm"
							]
						},
						"description": "**Confirm and save a payment method after Stripe SetupIntent completes.**\n\n**Authentication required.**\n\n**Request Body:**\n- `setupIntentId` (string, required): The SetupIntent ID from the setup step\n\n**Response:**\n```json\n{\n  \"id\": \"saved-pm-id\",\n  \"brand\": \"visa\",\n  \"last4\": \"4242\",\n  \"expiryMonth\": 12,\n  \"expiryYear\": 2028,\n  \"isDefault\": false,\n  \"stripePaymentMethodId\": \"pm_xxx\"\n}\n```\n\n**Note:** Call this after `stripe.confirmCardSetup()` succeeds on the frontend."
					},
					"response": []
				},
				{
					"name": "List Saved Payment Methods",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/payment-methods",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"payment-methods"
							]
						},
						"description": "**List all saved payment methods for the current user.**\n\n**Authentication required.**\n\n**Response:**\n```json\n[\n  {\n    \"id\": \"saved-pm-id\",\n    \"brand\": \"visa\",\n    \"last4\": \"4242\",\n    \"expiryMonth\": 12,\n    \"expiryYear\": 2028,\n    \"isDefault\": true,\n    \"stripePaymentMethodId\": \"pm_xxx\",\n    \"createdAt\": \"2026-02-01T00:00:00.000Z\"\n  }\n]\n```\n\n**Note:** Only tokenized card info shown (brand, last4, expiry). Full card details never stored."
					},
					"response": []
				},
				{
					"name": "Set Default Payment Method",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/payment-methods/:id/default",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"payment-methods",
								":id",
								"default"
							],
							"variable": [
								{
									"key": "id",
									"value": "saved-pm-id",
									"description": "Saved payment method ID"
								}
							]
						},
						"description": "**Set a saved payment method as the default.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved payment method ID\n\n**Response:**\nUpdated payment method with `isDefault: true`."
					},
					"response": []
				},
				{
					"name": "Delete Payment Method",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/payment-methods/:id",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"payment-methods",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "saved-pm-id",
									"description": "Saved payment method ID to delete"
								}
							]
						},
						"description": "**Delete a saved payment method.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved payment method ID to delete\n\n**What This Does:**\n- Removes payment method from database\n- Detaches from Stripe customer\n- Cannot be undone\n\n**Error Responses:**\n- `404` - Payment method not found\n- `403` - Payment method belongs to different user"
					},
					"response": []
				}
			],
			"description": "**Saved payment methods (PCI-compliant via Stripe tokenization).**\n\n**All endpoints require authentication.**\n\n**How It Works:**\n1. `POST /setup` - Get Stripe SetupIntent client secret\n2. Frontend: `stripe.confirmCardSetup(clientSecret)` - Card details go to Stripe only\n3. `POST /confirm` - Save the tokenized card reference in database\n4. `GET /` - List saved cards (only shows brand, last4, expiry)\n5. Use saved card for future payments\n\n**Security:**\n- Card details NEVER touch your server (PCI-compliant)\n- Only Stripe tokens stored\n- Encrypted at rest\n- Cards detached from Stripe on deletion"
		},
		{
			"name": "Saved Items (Wishlist)",
			"item": [
				{
					"name": "Save Item to Wishlist",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"itemType\": \"HOTEL\",\n  \"itemId\": \"MCLONGHM\",\n  \"itemDetails\": {\n    \"name\": \"JW Marriott Grosvenor House London\",\n    \"city\": \"London\",\n    \"rating\": 4.5,\n    \"pricePerNight\": 350\n  },\n  \"notes\": \"Perfect for anniversary trip\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items"
							]
						},
						"description": "**Save an item (hotel, flight, car rental) to wishlist.**\n\n**Authentication required.**\n\n**Request Body:**\n- `itemType` (string, required): HOTEL, FLIGHT, or CAR_RENTAL\n- `itemId` (string, required): Provider item ID (e.g., hotel ID, offer ID)\n- `itemDetails` (object, optional): Item details snapshot for display\n- `notes` (string, optional): Personal notes\n\n**Response:**\nSaved item object with ID."
					},
					"response": []
				},
				{
					"name": "Get Saved Items",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items?itemType=HOTEL",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items"
							],
							"query": [
								{
									"key": "itemType",
									"value": "HOTEL",
									"description": "Filter by type (HOTEL, FLIGHT, CAR_RENTAL)",
									"disabled": true
								}
							]
						},
						"description": "**Get all saved items (wishlist).**\n\n**Authentication required.**\n\n**Query Parameters:**\n- `itemType` (string, optional): Filter by item type (HOTEL, FLIGHT, CAR_RENTAL)\n\n**Response:**\nArray of saved items with details."
					},
					"response": []
				},
				{
					"name": "Get Saved Item Counts",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items/counts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items",
								"counts"
							]
						},
						"description": "**Get counts of saved items by type.**\n\n**Authentication required.**\n\n**Response:**\n```json\n{\n  \"total\": 15,\n  \"HOTEL\": 8,\n  \"FLIGHT\": 5,\n  \"CAR_RENTAL\": 2\n}\n```"
					},
					"response": []
				},
				{
					"name": "Toggle Saved Item",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"itemType\": \"HOTEL\",\n  \"itemId\": \"MCLONGHM\",\n  \"itemDetails\": {\n    \"name\": \"JW Marriott Grosvenor House London\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items/toggle",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items",
								"toggle"
							]
						},
						"description": "**Toggle an item in wishlist (save if not saved, unsave if saved).**\n\n**Authentication required.**\n\n**Request Body:**\n- `itemType` (string, required): HOTEL, FLIGHT, or CAR_RENTAL\n- `itemId` (string, required): Provider item ID\n- `itemDetails` (object, optional): Item details snapshot\n\n**Response:**\n```json\n{\n  \"saved\": true,\n  \"item\": { ... }\n}\n```\nor\n```json\n{\n  \"saved\": false\n}\n```\n\n**Use for heart/bookmark toggle buttons on search results.**"
					},
					"response": []
				},
				{
					"name": "Check If Item Saved",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"itemType\": \"HOTEL\",\n  \"itemId\": \"MCLONGHM\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items/check",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items",
								"check"
							]
						},
						"description": "**Check if a specific item is saved in wishlist.**\n\n**Authentication required.**\n\n**Request Body:**\n- `itemType` (string, required): HOTEL, FLIGHT, or CAR_RENTAL\n- `itemId` (string, required): Provider item ID\n\n**Response:**\n```json\n{\n  \"saved\": true,\n  \"savedItemId\": \"saved-item-id\"\n}\n```\n\n**Use to set initial state of heart/bookmark buttons.**"
					},
					"response": []
				},
				{
					"name": "Update Saved Item Notes",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"notes\": \"Updated notes - great for summer holiday!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items/:id/notes",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items",
								":id",
								"notes"
							],
							"variable": [
								{
									"key": "id",
									"value": "saved-item-id",
									"description": "Saved item ID"
								}
							]
						},
						"description": "**Update notes on a saved item.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved item ID\n\n**Request Body:**\n- `notes` (string, required): Updated notes"
					},
					"response": []
				},
				{
					"name": "Remove Saved Item",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/saved-items/:id",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"saved-items",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "saved-item-id",
									"description": "Saved item ID to remove"
								}
							]
						},
						"description": "**Remove an item from wishlist.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved item ID to remove"
					},
					"response": []
				}
			],
			"description": "**Wishlist/saved items endpoints.**\n\n**All endpoints require authentication.**\n\n**Features:**\n- Save hotels, flights, car rentals for later\n- Toggle save/unsave with single endpoint\n- Check if item is saved (for UI state)\n- Add personal notes to saved items\n- Filter by item type\n- Get counts per type"
		},
		{
			"name": "Saved Travelers",
			"item": [
				{
					"name": "Create Saved Traveler",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"firstName\": \"Jane\",\n  \"lastName\": \"Doe\",\n  \"dateOfBirth\": \"1995-03-15\",\n  \"gender\": \"Female\",\n  \"passportNumber\": \"AB1234567\",\n  \"passportExpiry\": \"2030-01-01\",\n  \"nationality\": \"GB\",\n  \"frequentFlyerNumber\": \"BA12345678\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/travelers",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"travelers"
							]
						},
						"description": "**Save a traveler profile for quick checkout.**\n\n**Authentication required.**\n\n**Request Body:**\n- `firstName` (string, required): First name as on passport\n- `lastName` (string, required): Last name as on passport\n- `dateOfBirth` (string, optional): Date of birth (YYYY-MM-DD)\n- `gender` (string, optional): Male, Female, Other\n- `passportNumber` (string, optional): Passport number\n- `passportExpiry` (string, optional): Passport expiry date (YYYY-MM-DD)\n- `nationality` (string, optional): Country code (e.g., GB, US, NG)\n- `frequentFlyerNumber` (string, optional): Airline frequent flyer number\n\n**Response:**\nCreated traveler object with ID.\n\n**Use Case:**\nSave family members, friends, or frequent co-travelers for quick booking."
					},
					"response": []
				},
				{
					"name": "List Saved Travelers",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/travelers",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"travelers"
							]
						},
						"description": "**List all saved traveler profiles.**\n\n**Authentication required.**\n\n**Response:**\nArray of saved travelers with details."
					},
					"response": []
				},
				{
					"name": "Get Saved Traveler by ID",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/travelers/:id",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"travelers",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "traveler-id",
									"description": "Saved traveler ID"
								}
							]
						},
						"description": "**Get a specific saved traveler by ID.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved traveler ID"
					},
					"response": []
				},
				{
					"name": "Update Saved Traveler",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"firstName\": \"Jane\",\n  \"lastName\": \"Smith\",\n  \"passportNumber\": \"CD9876543\",\n  \"passportExpiry\": \"2031-06-15\",\n  \"nationality\": \"US\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/travelers/:id",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"travelers",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "traveler-id",
									"description": "Saved traveler ID to update"
								}
							]
						},
						"description": "**Update a saved traveler's details.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved traveler ID to update\n\n**Request Body (all fields optional):**\n- `firstName`, `lastName`, `dateOfBirth`, `gender`, `passportNumber`, `passportExpiry`, `nationality`, `frequentFlyerNumber`"
					},
					"response": []
				},
				{
					"name": "Delete Saved Traveler",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/travelers/:id",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"travelers",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "traveler-id",
									"description": "Saved traveler ID to delete"
								}
							]
						},
						"description": "**Delete a saved traveler.**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `id` (string, required): Saved traveler ID to delete"
					},
					"response": []
				},
				{
					"name": "Get Travelers by IDs (Batch)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"travelerIds\": [\"traveler-id-1\", \"traveler-id-2\"]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/travelers/batch",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"travelers",
								"batch"
							]
						},
						"description": "**Get multiple saved travelers by their IDs (for checkout).**\n\n**Authentication required.**\n\n**Request Body:**\n- `travelerIds` (array, required): Array of saved traveler IDs\n\n**Use Case:**\nWhen user selects multiple travelers at checkout, fetch all their details in one call.\n\n**Response:**\nArray of traveler objects matching the provided IDs."
					},
					"response": []
				}
			],
			"description": "**Saved travelers management endpoints.**\n\n**All endpoints require authentication.**\n\n**Features:**\n- Save traveler profiles (family, friends, co-travelers)\n- Store passport details, nationality, frequent flyer numbers\n- Quickly attach saved travelers at checkout\n- Batch fetch for multi-passenger bookings\n\n**Use Cases:**\n- Save family members for quick booking\n- Store passport info for international flights\n- Pre-fill passenger details at checkout\n- Manage frequent traveler profiles"
		},
		{
			"name": "User Dashboard",
			"item": [
				{
					"name": "Get User Dashboard",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/users/me/dashboard",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"users",
								"me",
								"dashboard"
							]
						},
						"description": "**Get comprehensive user dashboard data in a single call.**\n\n**Authentication required.**\n\n**Response:**\n```json\n{\n  \"profile\": {\n    \"id\": \"user-id\",\n    \"name\": \"John Doe\",\n    \"email\": \"john@example.com\",\n    \"image\": \"https://...\"\n  },\n  \"loyalty\": {\n    \"points\": 2500,\n    \"tier\": \"SILVER\",\n    \"lifetimePoints\": 5000\n  },\n  \"stats\": {\n    \"totalBookings\": 12,\n    \"confirmedBookings\": 10,\n    \"pendingBookings\": 2,\n    \"totalSpent\": 15000.00,\n    \"savedItems\": 8,\n    \"savedTravelers\": 3,\n    \"savedPaymentMethods\": 2,\n    \"activeVouchers\": 1\n  },\n  \"recentBookings\": [...],\n  \"recentTransactions\": [...]\n}\n```\n\n**Use this for the user profile/dashboard page to get all data in one call instead of multiple API calls.**"
					},
					"response": []
				}
			],
			"description": "**User dashboard endpoint - single call for all profile data.**\n\n**Authentication required.**\n\n**Returns combined data:**\n- Profile information\n- Loyalty account summary\n- Booking statistics\n- Recent bookings\n- Recent loyalty transactions"
		},
		{
			"name": "Health Check",
			"item": [
				{
					"name": "Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Service is healthy', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('status', 'ok');",
									"    pm.expect(response).to.have.property('uptime');",
									"    console.log('‚úÖ Service is healthy');",
									"    console.log('Uptime:', response.uptime, 'seconds');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/health",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"health"
							]
						},
						"description": "Check service health status.\n\n**No authentication required.**\n\n**Response:**\n- `status`: Service status (\"ok\" or \"error\")\n- `timestamp`: Current timestamp\n- `uptime`: Service uptime in seconds\n- `environment`: Current environment (development/production)\n\n**Use Cases:**\n- Load balancer health checks\n- Monitoring and alerting\n- Service status verification\n\n**Note:** This endpoint is public and doesn't require authentication."
					},
					"response": []
				},
				{
					"name": "Database Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Database status', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('status');",
									"    pm.expect(response).to.have.property('database');",
									"    if (response.database === 'connected') {",
									"        console.log('‚úÖ Database is connected');",
									"    } else {",
									"        console.log('‚ùå Database is disconnected');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/health/db",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"health",
								"db"
							]
						},
						"description": "Check database connection health.\n\n**No authentication required.**\n\n**Response:**\n- `status`: Health status (\"ok\" or \"error\")\n- `database`: Database connection status (\"connected\" or \"disconnected\")\n- `timestamp`: Current timestamp\n- `error`: Error message (only in production if connection fails)\n\n**Use Cases:**\n- Database monitoring\n- Connection pool health checks\n- Troubleshooting database issues\n\n**Note:**\n- Returns 200 even if database is disconnected (for monitoring)\n- Check `database` field to determine actual status\n- Error details hidden in production for security"
					},
					"response": []
				}
			],
			"description": "Health check endpoints for monitoring service and database status.\n\n**No authentication required.**\n\n**Endpoints:**\n- **Health Check** - General service health\n- **Database Health** - Database connection status\n\n**Use Cases:**\n- Load balancer health checks\n- Monitoring dashboards\n- Alerting systems\n- Service status verification"
		},
		{
			"name": "Contact Us",
			"description": "**Public.** Contact Us form. No authentication. On submit: entry is saved, confirmation email is sent to the submitter, and all **super admins (from the database)** receive a notification email. No .env emails are used.",
			"item": [
				{
					"name": "Submit Contact Us Form",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function () { pm.response.to.have.status(201); });",
									"if (pm.response.code === 201) {",
									"    const j = pm.response.json();",
									"    pm.expect(j).to.have.property('success', true);",
									"    pm.expect(j).to.have.property('data');",
									"    if (j.data && j.data.id) pm.environment.set('contactSubmissionId', j.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"phone\": \"+44 1582 340807\",\n  \"serviceInterestedIn\": \"Travel Services\",\n  \"message\": \"Tell us how we can help you...\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/contact",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"contact"
							]
						}
					},
					"response": [],
					"description": "Submit the Contact Us form. **No auth.**\n\n**Body (required):**\n- `name` (string) ‚Äì Full name\n- `email` (string) ‚Äì Valid email\n- `serviceInterestedIn` (string) ‚Äì One of: `Travel Services`, `Logistics - DHL`, `Educational Consulting`, `Hotel Reservations`, `Other`\n- `message` (string) ‚Äì Message content\n\n**Body (optional):**\n- `phone` (string)\n- `subject` (string)\n\n**Response (201):** `{ \"success\": true, \"message\": \"Thank you for your message...\", \"data\": { \"id\": \"...\" } }`\n\n**Emails:**\n- Confirmation email is sent to the submitter's email.\n- All users with role SUPER_ADMIN in the database receive a notification email (no .env addresses used)."
				}
			]
		},
		{
			"name": "Platform Settings (Markups)",
			"description": "**Admin-only.** Configure markup and service fee per product type and currency. Used for flights, hotels, and car rentals. All mutations are audit-logged.",
			"item": [
				{
					"name": "List Markups",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/markups?productType=FLIGHT_DOMESTIC&currency=GBP",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"markups"
							],
							"query": [
								{
									"key": "productType",
									"value": "FLIGHT_DOMESTIC",
									"description": "Filter by product type",
									"disabled": true
								},
								{
									"key": "currency",
									"value": "GBP",
									"description": "Filter by currency",
									"disabled": true
								}
							]
						},
						"description": "List markup configs. Query: `productType` (optional), `currency` (optional).\n\n**Expected response:** `{ \"success\": true, \"data\": [...], \"message\": \"...\" }`"
					},
					"response": []
				},
				{
					"name": "Create Markup",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const j = pm.response.json();",
									"    if (j.data && j.data.id) pm.environment.set('markupId', j.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productType\": \"FLIGHT_DOMESTIC\",\n  \"markupPercentage\": 5,\n  \"serviceFeeAmount\": 10,\n  \"currency\": \"GBP\",\n  \"description\": \"Domestic flights\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/markups",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"markups"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Markup",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"markupPercentage\": 6,\n  \"serviceFeeAmount\": 12,\n  \"description\": \"Updated\",\n  \"isActive\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/markups/{{markupId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"markups",
								"{{markupId}}"
							]
						},
						"description": "Body: `markupPercentage?`, `serviceFeeAmount?`, `description?`, `isActive?`. Audit: UPDATE_MARKUP_CONFIG."
					},
					"response": []
				},
				{
					"name": "Deactivate Markup",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/markups/{{markupId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"markups",
								"{{markupId}}"
							]
						},
						"description": "Sets effectiveTo and isActive: false. Audit: DEACTIVATE_MARKUP_CONFIG."
					},
					"response": []
				}
			]
		},
		{
			"name": "Flight Search",
			"item": [
				{
					"name": "Search Flights - Get Offer Request ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has offer_request_id', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response.data).to.have.property('offer_request_id');",
									"    ",
									"    // Save offer_request_id for pagination",
									"    if (response.data.offer_request_id) {",
									"        pm.environment.set('offerRequestId', response.data.offer_request_id);",
									"        console.log('Offer Request ID saved:', response.data.offer_request_id);",
									"        console.log('Cached:', response.data.cached || false);",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"passengers\": 1,\n  \"cabinClass\": \"economy\",\n  \"currency\": \"GBP\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/search/flights",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"search",
								"flights"
							]
						},
						"description": "**STEP 1: Search for flights and get offer_request_id**\n\n**No authentication required.**\n\n**What This Does:**\n- Creates a flight search request with Duffel API\n- Returns immediately with `offer_request_id` (2-3 seconds)\n- Duffel continues searching airlines in background\n- Does NOT return flight offers (use Step 2 for that)\n\n**Why Two Steps?**\n- Faster response (don't wait 20+ seconds for all airlines)\n- Enables pagination (can't show 500 flights at once)\n- Allows caching (reuse searches, reduce costs)\n\n**Caching:**\n- Search results cached for 10 minutes\n- Same search parameters = cached `offer_request_id` (no API call)\n- Check `cached: true` in response to see if from cache\n\n**Request Body:**\n- `origin` (string, required): Origin airport IATA code (e.g., \"LHR\", \"LOS\", \"JFK\")\n- `destination` (string, required): Destination airport IATA code\n- `departureDate` (string, required): ISO 8601 date (YYYY-MM-DD)\n- `returnDate` (string, optional): For round trips (YYYY-MM-DD)\n- `passengers` (number, required): Number of passengers (min: 1)\n- `cabinClass` (string, optional): economy, premium_economy, business, first (default: economy)\n- `maxConnections` (number, optional): Max connections (0 = direct only, default: 1)\n- `passengerDetails` (array, optional): Detailed passenger info (age, type, etc.)\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"offer_request_id\": \"orq_0000B2dmFMfv0fyigjlHNI\",\n    \"live_mode\": false,\n    \"cached\": false,\n    \"message\": \"Use /bookings/offers endpoint to paginate offers\"\n  },\n  \"message\": \"Flight search completed...\"\n}\n```\n\n**Next Step:**\nUse the `offer_request_id` with **List Offers** endpoint to get actual flight options.\n\n**Example Scenarios:**\n\n**One-Way Flight:**\n```json\n{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"passengers\": 1,\n  \"cabinClass\": \"economy\",\n  \"currency\": \"GBP\"\n}\n```\n\n**Round Trip Flight (IMPORTANT - Add returnDate):**\n```json\n{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"returnDate\": \"2026-02-05\",\n  \"passengers\": 2,\n  \"cabinClass\": \"economy\",\n  \"currency\": \"GBP\"\n}\n```\n\n**Direct Flights Only:**\n```json\n{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"passengers\": 1,\n  \"maxConnections\": 0,\n  \"cabinClass\": \"economy\"\n}\n```\n\n**Business Class:**\n```json\n{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"passengers\": 1,\n  \"cabinClass\": \"business\",\n  \"currency\": \"GBP\"\n}\n```\n\n**With Children/Infants:**\n```json\n{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"passengers\": 3,\n  \"passengerDetails\": [\n    { \"type\": \"adult\" },\n    { \"type\": \"adult\" },\n    { \"type\": \"child\", \"age\": 5 }\n  ],\n  \"cabinClass\": \"economy\"\n}\n```\n\n**‚ö†Ô∏è ROUND TRIP TROUBLESHOOTING:**\n- Ensure `returnDate` is AFTER `departureDate`\n- Wait 20-30 seconds after search before calling List Offers (Duffel needs time to search)\n- Round trips may take longer to process than one-way\n- Check `offer_request_id` is valid before listing offers\n- Use the same `offer_request_id` for both outbound and return flights"
					},
					"response": []
				},
				{
					"name": "Search Flights - Round Trip Example",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.data && response.data.offer_request_id) {",
									"        pm.environment.set('offerRequestId', response.data.offer_request_id);",
									"        console.log('‚úÖ Round trip search successful!');",
									"        console.log('üìã Offer Request ID:', response.data.offer_request_id);",
									"        console.log('‚è≥ Wait 20-30 seconds before calling List Offers');",
									"        console.log('üí° Round trips take longer to process than one-way');",
									"    }",
									"}",
									"",
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has offer_request_id', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response.data).to.have.property('offer_request_id');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"returnDate\": \"2026-02-05\",\n  \"passengers\": 2,\n  \"cabinClass\": \"economy\",\n  \"currency\": \"GBP\",\n  \"maxConnections\": 1\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/search/flights",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"search",
								"flights"
							]
						},
						"description": "**ROUND TRIP FLIGHT SEARCH EXAMPLE**\n\n**No authentication required.**\n\n**‚ö†Ô∏è IMPORTANT FOR ROUND TRIPS:**\n1. **Wait 20-30 seconds** after this search before calling List Offers\n2. Round trips take longer to process than one-way flights\n3. Duffel searches both outbound AND return flights\n4. Use the same `offer_request_id` for both directions\n\n**Key Difference from One-Way:**\n- **Add `returnDate`** field (must be AFTER `departureDate`)\n- Round trip searches create 2 slices (outbound + return)\n- Processing time is longer (20-30 seconds vs 10-15 seconds)\n\n**Request Body:**\n```json\n{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-01-25\",\n  \"returnDate\": \"2026-02-05\",  ‚Üê REQUIRED for round trips\n  \"passengers\": 2,\n  \"cabinClass\": \"economy\",\n  \"currency\": \"GBP\"\n}\n```\n\n**Response:**\n- Returns `offer_request_id` immediately (2-3 seconds)\n- Duffel continues searching in background\n- **Wait 20-30 seconds** before calling List Offers\n- Offers will include both outbound and return flights\n\n**Troubleshooting:**\n- ‚ùå No results? Wait longer (round trips take 20-30 seconds)\n- ‚ùå Invalid date? Ensure `returnDate` is AFTER `departureDate`\n- ‚ùå No offers? Try different dates or routes\n- ‚úÖ Check `offer_request_id` is valid before listing offers\n\n**Next Steps:**\n1. Wait 20-30 seconds\n2. Call **List Offers** with the `offer_request_id`\n3. Offers will show combined round trip prices\n4. Each offer includes both outbound and return segments"
					},
					"response": []
				},
				{
					"name": "List Offers - First Page",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Ensure offerRequestId is set",
									"const offerRequestId = pm.environment.get('offerRequestId');",
									"if (!offerRequestId) {",
									"    console.error('‚ùå No offerRequestId found!');",
									"    console.warn('‚ö†Ô∏è  Please run \"Search Flights - Get Offer Request ID\" first.');",
									"} else {",
									"    console.log('‚úÖ Using offerRequestId:', offerRequestId);",
									"}"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has paginated offers', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('data');",
									"    pm.expect(response).to.have.property('meta');",
									"    pm.expect(response.data).to.be.an('array');",
									"    pm.expect(response.meta).to.have.property('nextCursor');",
									"    pm.expect(response.meta).to.have.property('hasMore');",
									"    ",
									"    // Save first offer ID if available",
									"    if (response.data && response.data.length > 0) {",
									"        pm.environment.set('offerId', response.data[0].id);",
									"        pm.environment.set('offerPrice', response.data[0].final_amount);",
									"        pm.environment.set('offerCurrency', response.data[0].currency);",
									"        console.log('‚úÖ Found', response.data.length, 'offers');",
									"        console.log('üìÑ Has more:', response.meta.hasMore);",
									"        console.log('‚û°Ô∏è  Next cursor:', response.meta.nextCursor || 'none');",
									"        console.log('üí∞ First offer price:', response.data[0].final_amount, response.data[0].currency);",
									"        console.log('üìä Markup:', response.data[0].markup_percentage + '%');",
									"    } else {",
									"        console.warn('‚ö†Ô∏è  No offers found. Try a different search.');",
									"    }",
									"    ",
									"    // Save next cursor for pagination",
									"    if (response.meta && response.meta.nextCursor) {",
									"        pm.environment.set('nextCursor', response.meta.nextCursor);",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/offers?offer_request_id={{offerRequestId}}&limit=20&sort=total_amount&sortOrder=asc",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"offers"
							],
							"query": [
								{
									"key": "offer_request_id",
									"value": "{{offerRequestId}}",
									"description": "Offer request ID from search endpoint"
								},
								{
									"key": "limit",
									"value": "20",
									"description": "Items per page (1-200)",
									"disabled": false
								},
								{
									"key": "sort",
									"value": "total_amount",
									"description": "Sort field",
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": "asc",
									"description": "Sort order (asc/desc)",
									"disabled": true
								}
							]
						},
						"description": "**STEP 2: Get paginated flight offers**\n\n**No authentication required.**\n\n**What This Does:**\n- Fetches flight offers for a given `offer_request_id`\n- Returns paginated results (default: 20 per page)\n- Applies markup automatically (adds your profit margin)\n- Fast response (1 second)\n\n**Prerequisites:**\n- Must have `offer_request_id` from Step 1 (Search Flights)\n- Automatically saved to environment after search\n\n**Caching:**\n- Offers cached for 2 minutes\n- Same pagination params = cached results (no API call)\n- Prices change frequently, so short cache time\n\n**Query Parameters:**\n- `offer_request_id` (required): From search endpoint (auto-filled from environment)\n- `limit` (optional): Items per page (1-200, default: 20)\n- `cursor` (optional): For next/previous pages (from `meta.nextCursor`)\n- `sort` (optional): Sort field - `total_amount`, `total_duration`, `departure_time`\n- `sortOrder` (optional): `asc` (lowest first) or `desc` (highest first)\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"off_123\",\n      \"original_amount\": \"500.00\",\n      \"markup_percentage\": 10,\n      \"markup_amount\": \"50.00\",\n      \"final_amount\": \"550.00\",\n      \"currency\": \"USD\",\n      \"slices\": [...],\n      \"segments\": [...],\n      \"expires_at\": \"2026-01-25T10:00:00Z\"\n    }\n  ],\n  \"meta\": {\n    \"count\": 20,\n    \"total\": 20,\n    \"limit\": 20,\n    \"nextCursor\": \"g2wAAAACbQAAABBBZXJvbWlzdC1LaGFya2l2bQAAAB=\",\n    \"prevCursor\": null,\n    \"hasMore\": true,\n    \"page\": 1,\n    \"totalPages\": 2\n  }\n}\n```\n\n**Pagination:**\n- Use `meta.nextCursor` for next page\n- Use `meta.prevCursor` for previous page\n- Check `meta.hasMore` to see if more pages available\n- Use \"List Offers - Next Page\" request with cursor\n\n**Markup Applied:**\n- `original_amount`: Price from airline\n- `markup_percentage`: Your profit margin\n- `markup_amount`: Profit in currency\n- `final_amount`: Price customer pays (original + markup)\n\n**Important:**\n- Offers expire (check `expires_at`)\n- Use offer `id` to create booking\n- Sort by price: `sort=total_amount&sortOrder=asc`"
					},
					"response": []
				},
				{
					"name": "List Offers - Next Page",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Get cursor from previous response or environment",
									"const cursor = pm.environment.get('nextCursor');",
									"const offerRequestId = pm.environment.get('offerRequestId');",
									"",
									"if (!offerRequestId) {",
									"    console.error('‚ùå No offerRequestId found!');",
									"    console.warn('‚ö†Ô∏è  Please run \"Search Flights\" first.');",
									"}",
									"",
									"if (!cursor) {",
									"    console.warn('‚ö†Ô∏è  No cursor found. Getting first page instead.');",
									"    console.info('üí° Tip: Run \"List Offers - First Page\" first to get cursor.');",
									"} else {",
									"    console.log('‚úÖ Using cursor for next page:', cursor);",
									"}"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has next page data', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response.meta).to.have.property('nextCursor');",
									"    ",
									"    // Save next cursor for subsequent pages",
									"    if (response.meta && response.meta.nextCursor) {",
									"        pm.environment.set('nextCursor', response.meta.nextCursor);",
									"        console.log('‚úÖ Next cursor saved:', response.meta.nextCursor);",
									"    } else {",
									"        console.log('‚ÑπÔ∏è  No more pages available');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/offers?offer_request_id={{offerRequestId}}&limit=20&cursor={{nextCursor}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"offers"
							],
							"query": [
								{
									"key": "offer_request_id",
									"value": "{{offerRequestId}}"
								},
								{
									"key": "limit",
									"value": "20"
								},
								{
									"key": "cursor",
									"value": "{{nextCursor}}",
									"description": "Cursor from previous response meta.nextCursor"
								}
							]
						},
						"description": "**Get next page of offers using pagination cursor**\n\n**No authentication required.**\n\n**What This Does:**\n- Fetches the next page of offers using cursor from previous response\n- Automatically uses `nextCursor` from environment (set by previous request)\n\n**How It Works:**\n1. Call \"List Offers - First Page\" (no cursor)\n2. Response includes `meta.nextCursor`\n3. Call this endpoint (cursor auto-filled)\n4. Repeat until `meta.hasMore` is `false`\n\n**Query Parameters:**\n- `offer_request_id` (required): From search endpoint\n- `limit` (optional): Items per page (default: 20)\n- `cursor` (required): From `meta.nextCursor` of previous response (auto-filled)\n\n**Response:**\n- Same structure as first page\n- New `meta.nextCursor` for next page\n- `meta.hasMore` indicates if more pages\n\n**Example Flow:**\n```\nPage 1: ?offer_request_id=orq_123&limit=20\n  ‚Üí nextCursor: \"abc\"\n\nPage 2: ?offer_request_id=orq_123&limit=20&cursor=abc\n  ‚Üí nextCursor: \"def\"\n\nPage 3: ?offer_request_id=orq_123&limit=20&cursor=def\n  ‚Üí hasMore: false (no more pages)\n```"
					},
					"response": []
				},
				{
					"name": "List Offers - Sort by Price (Low to High)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/offers?offer_request_id={{offerRequestId}}&limit=20&sort=total_amount&sortOrder=asc",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"offers"
							],
							"query": [
								{
									"key": "offer_request_id",
									"value": "{{offerRequestId}}"
								},
								{
									"key": "limit",
									"value": "20"
								},
								{
									"key": "sort",
									"value": "total_amount"
								},
								{
									"key": "sortOrder",
									"value": "asc"
								}
							]
						},
						"description": "Get offers sorted by price (lowest first)."
					},
					"response": []
				},
				{
					"name": "List Offers - Sort by Duration (Shortest First)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/offers?offer_request_id={{offerRequestId}}&limit=20&sort=total_duration&sortOrder=asc",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"offers"
							],
							"query": [
								{
									"key": "offer_request_id",
									"value": "{{offerRequestId}}"
								},
								{
									"key": "limit",
									"value": "20"
								},
								{
									"key": "sort",
									"value": "total_duration"
								},
								{
									"key": "sortOrder",
									"value": "asc"
								}
							]
						},
						"description": "Get offers sorted by flight duration (shortest first)."
					},
					"response": []
				}
			],
			"description": "**Flight Search & Offers - Two-Step Process**\n\n**Complete Workflow:**\n1. **Search Flights** ‚Üí Get `offer_request_id` (2-3 seconds)\n   - Creates search request with Duffel\n   - Returns immediately with search ID\n   - Duffel searches airlines in background\n\n2. **List Offers** ‚Üí Get paginated flights (1 second)\n   - Use `offer_request_id` from step 1\n   - Get 20 flights per page (default)\n   - Markup automatically applied\n   - Use cursor to paginate\n\n3. **Create Booking** ‚Üí Use offer `id` from step 2\n   - Select an offer from results\n   - Use offer `id` to create booking\n\n**Why Two Requests?**\n- ‚ö° **Faster**: User sees results in 3-4 seconds (vs 20+ seconds)\n- üìÑ **Pagination**: Can't show 500 flights at once\n- üíæ **Caching**: Reuse searches, reduce API costs\n- üí∞ **Cost-effective**: Fetch only what you need\n\n**Caching Benefits:**\n- Search results cached 10 minutes\n- Offers cached 2 minutes\n- Reduces API costs by 80-90%\n- Faster response times\n- Multiple users can share same search\n\n**Important Notes:**\n- Search endpoint does NOT return offers (only ID)\n- Must use List Offers endpoint to get flights\n- Offers expire (check `expires_at` field)\n- Use `offer_request_id` for all pagination requests"
		},
		{
			"name": "Bookings",
			"item": [
				{
					"name": "Create Booking (Authenticated)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"if (!pm.environment.get('token')) {",
									"    console.warn('No token found. Please login first.');",
									"}"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.data.reference) {",
									"        pm.environment.set('bookingReference', response.data.reference);",
									"        pm.environment.set('bookingId', response.data.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productType\": \"FLIGHT_INTERNATIONAL\",\n  \"provider\": \"DUFFEL\",\n  \"basePrice\": 45000,\n  \"currency\": \"GBP\",\n  \"bookingData\": {\n    \"offerId\": \"{{offerId}}\",\n    \"origin\": \"LHR\",\n    \"destination\": \"JFK\",\n    \"departureDate\": \"2026-01-25\",\n    \"airline\": \"British Airways\"\n  },\n  \"passengerInfo\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"phone\": \"+1234567890\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings"
							]
						},
						"description": "Create a booking for an authenticated user.\n\n**Authentication required:** JWT Bearer token\n\n**Uses offer ID from flight search results.**"
					},
					"response": []
				},
				{
					"name": "Create Guest Booking",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productType\": \"FLIGHT_INTERNATIONAL\",\n  \"provider\": \"DUFFEL\",\n  \"basePrice\": 45000,\n  \"currency\": \"GBP\",\n  \"bookingData\": {\n    \"offerId\": \"{{offerId}}\",\n    \"origin\": \"LHR\",\n    \"destination\": \"JFK\"\n  },\n  \"passengerInfo\": {\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Smith\",\n    \"email\": \"jane.smith@example.com\",\n    \"phone\": \"+1234567890\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/guest",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"guest"
							]
						},
						"description": "Create a booking without authentication (guest checkout)."
					},
					"response": []
				},
				{
					"name": "List Bookings",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings"
							]
						},
						"description": "Get list of bookings.\n\n**Authentication required.**\n- CUSTOMER: Sees only their bookings\n- ADMIN: Sees all bookings"
					},
					"response": []
				},
				{
					"name": "Get Booking by ID",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/{{bookingId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"{{bookingId}}"
							]
						},
						"description": "Get booking details by ID."
					},
					"response": []
				},
				{
					"name": "Cancel Duffel Flight Booking",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"if (!pm.environment.get('token')) {",
									"    console.warn('‚ö†Ô∏è  No token found. Please login first.');",
									"}",
									"",
									"if (!pm.environment.get('bookingId')) {",
									"    console.warn('‚ö†Ô∏è  No bookingId found. Please create a booking first.');",
									"} else {",
									"    console.log('‚úÖ Cancelling booking:', pm.environment.get('bookingId'));",
									"}"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200 or 403', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 403, 400]);",
									"});",
									"",
									"if (pm.response.code === 403) {",
									"    console.error('‚ùå Access denied. Only administrators can cancel bookings.');",
									"    console.log('üí° Tip: Use an admin account token');",
									"} else if (pm.response.code === 400) {",
									"    const response = pm.response.json();",
									"    console.error('‚ùå Cancellation not allowed:', response.message || response.error);",
									"    console.log('üí° Possible reasons:');",
									"    console.log('   - Within 24 hours of departure');",
									"    console.log('   - Non-refundable fare');",
									"    console.log('   - Departure time has passed');",
									"} else if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    console.log('‚úÖ Booking cancelled successfully');",
									"    if (response.data.cancellationId) {",
									"        pm.environment.set('cancellationId', response.data.cancellationId);",
									"        console.log('üìã Cancellation ID:', response.data.cancellationId);",
									"    }",
									"    if (response.data.refundAmount) {",
									"        console.log('üí∞ Refund amount:', response.data.refundAmount, response.data.refundTo || '');",
									"    }",
									"    if (response.data.hasAirlineCredits) {",
									"        console.log('üé´ Airline credits issued (no cash refund)');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/{{bookingId}}/cancel",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"{{bookingId}}",
								"cancel"
							]
						},
						"description": "Cancel a Duffel flight booking (ADMIN ONLY).\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Admin Only:** Only administrators (ADMIN, SUPER_ADMIN) can cancel bookings\n- **Time Restriction:** Cancellations are NOT allowed within 24 hours of departure\n- **Non-Refundable Fares:** Cancellations are blocked for non-refundable fares\n- **After Departure:** Cannot cancel after departure time has passed\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Requirements:**\n- Booking must be a Duffel flight booking (`provider: DUFFEL`)\n- Booking must be in `CONFIRMED` status\n- User must have ADMIN or SUPER_ADMIN role\n- Departure must be more than 24 hours away\n- Fare must allow refunds (non-refundable fares blocked)\n\n**Process:**\n1. Validates cancellation restrictions (time, fare type)\n2. Creates pending cancellation in Duffel\n3. Confirms cancellation\n4. Updates booking status to `CANCELLED`\n5. Processes refund if applicable\n6. Sends cancellation email to customer\n\n**Response includes:**\n- `cancellationId` - Duffel cancellation ID\n- `refundAmount` - Refund amount (if applicable)\n- `refundTo` - Where refund goes (balance, airline_credits, card)\n- `hasAirlineCredits` - Whether airline issued credits instead of cash\n- `airlineCredits` - Credit details (if applicable)\n\n**Error Responses:**\n- `403 Forbidden` - User is not an administrator\n- `400 Bad Request` - Cancellation not allowed (time restriction or non-refundable fare)\n\n**Note:** Customers cannot cancel directly. They must contact support for cancellations."
					},
					"response": []
				},
				{
					"name": "Duffel Webhook (Test)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"type\": \"order.created\",\n  \"object\": {\n    \"id\": \"ord_0000A3tQcEcrfuFAb0RQPH\",\n    \"booking_reference\": \"ABC123\",\n    \"status\": \"confirmed\"\n  },\n  \"created_at\": \"2026-01-25T20:00:00Z\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/duffel/webhook",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"duffel",
								"webhook"
							]
						},
						"description": "Duffel webhook endpoint for order updates.\n\n**‚ö†Ô∏è IMPORTANT:** This endpoint is called by Duffel, not by your application.\n\n**Configuration:**\n1. Go to Duffel Dashboard ‚Üí Webhooks\n2. Add endpoint: `https://your-domain.com/api/v1/bookings/duffel/webhook`\n3. Select events:\n   - `order.created` - Order successfully created\n   - `order.creation_failed` - Order creation failed\n   - `order.updated` - Order details updated\n   - `order.airline_initiated_change` - Airline changed the booking\n   - `order_cancellation.created` - Cancellation initiated\n   - `order_cancellation.confirmed` - Cancellation confirmed\n\n**Events Handled:**\n- `order.created` ‚Üí Updates booking with order details\n- `order.creation_failed` ‚Üí Marks booking as failed\n- `order.updated` ‚Üí Updates booking with latest order data\n- `order.airline_initiated_change` ‚Üí Stores change information\n- `order_cancellation.created` ‚Üí Stores cancellation details\n- `order_cancellation.confirmed` ‚Üí Updates booking to cancelled, processes refund\n\n**Note:** This request is for testing only. In production, Duffel calls this endpoint automatically.\n\n**Test Payload Example:**\n```json\n{\n  \"type\": \"order.created\",\n  \"object\": {\n    \"id\": \"ord_0000A3tQcEcrfuFAb0RQPH\",\n    \"booking_reference\": \"ABC123\",\n    \"status\": \"confirmed\"\n  },\n  \"created_at\": \"2026-01-25T20:00:00Z\"\n}\n```"
					},
					"response": []
				}
			],
			"description": "Booking management endpoints.\n\n**All endpoints require authentication (except webhook).**\n\n**Endpoints:**\n- Create Booking (Authenticated) - Create booking for logged-in user\n- Create Guest Booking - Create booking without account\n- Get Booking - Retrieve booking details by ID\n- Cancel Duffel Flight Booking - Cancel a confirmed Duffel flight booking\n- Duffel Webhook - Handle order updates from Duffel (no auth required)\n\n**Complete Booking Flow:**\n1. Search flights and get offers\n2. Select an offer\n3. Create booking with offer details\n4. Get booking ID\n5. Create payment intent using booking ID\n6. Payment succeeds ‚Üí Duffel order created automatically\n7. Duffel webhook updates booking with order details\n8. Cancel booking if needed (Duffel order cancelled automatically)\n\n**Order Creation:**\n- Duffel orders are created automatically when payment succeeds\n- No manual order creation needed\n- Order ID stored in `providerBookingId`\n- Full order data stored in `providerData`\n\n**Cancellation:**\n- Only Duffel flight bookings can be cancelled via this endpoint\n- Cancellation is immediate\n- Refunds processed automatically if applicable\n- Booking status updated to `CANCELLED`"
		},
		{
			"name": "Payments",
			"item": [
				{
					"name": "Create Payment Intent",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"if (!pm.environment.get('token')) {",
									"    console.warn('‚ö†Ô∏è  No token found. Please login first.');",
									"}",
									"",
									"if (!pm.environment.get('bookingId')) {",
									"    console.warn('‚ö†Ô∏è  No bookingId found. Please create a booking first.');",
									"    console.log('üí° Tip: Use \"Create Booking\" endpoint to get bookingId');",
									"} else {",
									"    console.log('‚úÖ Using bookingId:', pm.environment.get('bookingId'));",
									"}"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200 or 201', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"",
									"pm.test('Response has clientSecret', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('clientSecret');",
									"    pm.expect(response).to.have.property('paymentIntentId');",
									"    ",
									"    console.log('‚úÖ Payment intent created');",
									"    console.log('üí≥ Payment Intent ID:', response.paymentIntentId);",
									"    console.log('üîë Client Secret:', response.clientSecret.substring(0, 20) + '...');",
									"    console.log('üí° Use clientSecret with Stripe.js on frontend');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"bookingId\": \"{{bookingId}}\",\n  \"voucherCode\": \"EBT-V-ABC123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/stripe/create-intent",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"stripe",
								"create-intent"
							]
						},
						"description": "Create a Stripe payment intent for a booking (authenticated user).\n\n**Authentication required.**\n\n**Prerequisites:**\n- Must have a booking ID (from Create Booking endpoint)\n- Booking must be in PENDING or PAYMENT_PENDING status\n- User must own the booking (or be ADMIN/SUPER_ADMIN)\n\n**Request:**\n```json\n{\n  \"bookingId\": \"clx1234567890\",\n  \"voucherCode\": \"EBT-V-ABC123\"  // Optional - apply voucher discount\n}\n```\n\n**Parameters:**\n- `bookingId` (string, required): Booking ID from Create Booking endpoint\n- `voucherCode` (string, optional): Voucher code to apply discount. Get from redeeming loyalty points via `POST /api/v1/users/me/loyalty/redeem`. Validate first via `POST /api/v1/users/me/vouchers/validate`.\n\n**Response (without voucher):**\n```json\n{\n  \"clientSecret\": \"pi_xxx_secret_xxx\",\n  \"paymentIntentId\": \"pi_xxx\"\n}\n```\n\n**Response (with voucher):**\n```json\n{\n  \"clientSecret\": \"pi_xxx_secret_xxx\",\n  \"paymentIntentId\": \"pi_xxx\",\n  \"voucherApplied\": {\n    \"voucherCode\": \"EBT-V-ABC123\",\n    \"discountAmount\": 50,\n    \"originalAmount\": 500,\n    \"finalAmount\": 450\n  }\n}\n```\n\n**Voucher Flow:**\n1. User earns loyalty points from bookings\n2. User redeems points: `POST /api/v1/users/me/loyalty/redeem` -> Gets voucher code\n3. User validates voucher: `POST /api/v1/users/me/vouchers/validate`\n4. User creates payment intent with `voucherCode` -> Discount applied to Stripe amount\n5. After payment, voucher is automatically marked as USED\n\n**Next Steps:**\n1. Use `clientSecret` with Stripe.js on frontend\n2. Stripe handles payment processing\n3. Webhook automatically updates booking status:\n   - `payment_intent.succeeded` -> Booking: `CONFIRMED`, voucher marked `USED`, loyalty points awarded\n   - `payment_intent.payment_failed` -> Booking: `FAILED`\n   - `charge.refunded` -> Booking: `REFUNDED`\n\n**Note:** Webhook endpoint is `/api/v1/payments/stripe/webhook` (configured in Stripe Dashboard)"
					},
					"response": []
				},
				{
					"name": "Create Guest Payment Intent",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"bookingReference\": \"EBT-20260126-123456\",\n  \"email\": \"guest@example.com\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/stripe/create-intent/guest",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"stripe",
								"create-intent",
								"guest"
							]
						},
						"description": "Create a Stripe payment intent for a **guest booking**.\n\n**Authentication:** Not required (public endpoint) ‚úÖ\n\n**Security:**\n- Uses **booking reference** + **passenger email** to securely identify the booking\n- Common industry pattern for guest checkout (similar to PNR + last name)\n\n**Prerequisites:**\n- Guest booking must exist (from `Create Guest Booking` endpoint)\n- Booking must be in PENDING or PAYMENT_PENDING status\n- Email must match passenger or user email on the booking\n\n**Request:**\n```json\n{\n  \"bookingReference\": \"EBT-20260126-123456\",\n  \"email\": \"guest@example.com\"\n}\n```\n\n**Response:**\n```json\n{\n  \"clientSecret\": \"pi_xxx_secret_xxx\",\n  \"paymentIntentId\": \"pi_xxx\"\n}\n```\n\n**Next Steps:**\n1. Use `clientSecret` with Stripe.js on frontend\n2. Stripe handles payment processing\n3. Webhook automatically updates booking status\n\n**Note:** This flow is designed for guest checkout (no login required)."
					},
					"response": []
				},
				{
					"name": "Amadeus Hotel - Charge Margin",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"bookingId\": \"{{bookingId}}\"\n}\n"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/amadeus-hotel/charge-margin",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"amadeus-hotel",
								"charge-margin"
							]
						}
					},
					"response": [],
					"description": "After creating an Amadeus hotel booking (with card), call this to charge the margin via Stripe. Auth: user or admin. Admin: pass any booking ID to pay on behalf; backend uses booking.userId."
				},
				{
					"name": "Amadeus Hotel - Charge Margin (Guest)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"bookingReference\": \"EBT-20260201-XXXXXX\",\n  \"email\": \"guest@example.com\"\n}\n"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/amadeus-hotel/charge-margin/guest",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"amadeus-hotel",
								"charge-margin",
								"guest"
							]
						}
					},
					"response": [],
					"description": "Guest Amadeus hotel: charge margin by booking reference + email (must match lead guest). No auth."
				},
				{
					"name": "Amadeus Car Rental - Charge Margin",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"bookingId\": \"{{bookingId}}\"\n}\n"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/amadeus-car-rental/charge-margin",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"amadeus-car-rental",
								"charge-margin"
							]
						}
					},
					"response": [],
					"description": "After creating an Amadeus car rental booking, charge the margin. Admin can pay on behalf (bookingId of any booking; backend uses booking.userId)."
				},
				{
					"name": "Amadeus Car Rental - Charge Margin (Guest)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"bookingReference\": \"EBT-20260201-XXXXXX\",\n  \"email\": \"guest@example.com\"\n}\n"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/amadeus-car-rental/charge-margin/guest",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"amadeus-car-rental",
								"charge-margin",
								"guest"
							]
						}
					},
					"response": [],
					"description": "Guest car rental: charge margin by booking reference + email. No auth."
				},
				{
					"name": "Stripe Webhook (Test)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Webhook received', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('received', true);",
									"    console.log('‚úÖ Webhook event processed');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "stripe-signature",
								"value": "t=1234567890,v1=signature_here",
								"description": "Stripe webhook signature (automatically added by Stripe)"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": \"evt_xxx\",\n  \"type\": \"payment_intent.succeeded\",\n  \"data\": {\n    \"object\": {\n      \"id\": \"pi_xxx\",\n      \"metadata\": {\n        \"bookingId\": \"{{bookingId}}\"\n      }\n    }\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/payments/stripe/webhook",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"payments",
								"stripe",
								"webhook"
							]
						},
						"description": "Stripe webhook endpoint for payment events.\n\n**‚ö†Ô∏è IMPORTANT:** This endpoint is called by Stripe, not by your application.\n\n**Configuration:**\n1. Go to Stripe Dashboard ‚Üí Webhooks\n2. Add endpoint: `https://your-domain.com/api/v1/payments/stripe/webhook`\n3. Select events:\n   - `payment_intent.succeeded`\n   - `payment_intent.payment_failed`\n   - `payment_intent.canceled`\n   - `charge.refunded`\n4. Copy webhook signing secret (starts with `whsec_...`)\n5. Add to `.env`: `STRIPE_WEBHOOK_SECRET=\"whsec_...\"`\n\n**Security:**\n- Webhook signature is verified automatically\n- Only legitimate Stripe events are processed\n- Invalid signatures are rejected\n\n**Events Handled:**\n- `payment_intent.succeeded` ‚Üí Updates booking to `CONFIRMED`\n- `payment_intent.payment_failed` ‚Üí Updates booking to `FAILED`\n- `payment_intent.canceled` ‚Üí Updates booking to `CANCELLED`\n- `charge.refunded` ‚Üí Updates booking to `REFUNDED`\n\n**Note:** This request is for testing only. In production, Stripe calls this endpoint automatically."
					},
					"response": []
				}
			],
			"description": "Payment processing endpoints using Stripe.\n\n**Payment Flow:**\n1. Create booking ‚Üí Get `bookingId`\n2. Create payment intent (or Amadeus charge-margin for hotel/car) ‚Üí Get `clientSecret` or confirm charge\n3. Use `clientSecret` with Stripe.js on frontend (flights)\n4. Webhook updates booking status automatically\n\n**Admin pay on behalf:** For create-intent and Amadeus charge-margin, when caller is ADMIN/SUPER_ADMIN the backend uses the booking's userId so the payment is attributed to the customer.\n\n**Amadeus Hotel/Car:** Use charge-margin (authenticated or guest) after creating the Amadeus booking; margin is charged via Stripe.\n\n**Webhook Setup:**\n- Configure in Stripe Dashboard\n- Endpoint URL: `https://your-domain.com/api/v1/payments/stripe/webhook`\n- Required events: `payment_intent.succeeded`, `payment_intent.payment_failed`, `payment_intent.canceled`, `charge.refunded`\n- Webhook secret required for security (signature verification)\n\n**Security:**\n- All payment endpoints verify webhook signatures\n- Only legitimate Stripe events are processed\n- Invalid signatures are rejected"
		},
		{
			"name": "Hotels",
			"item": [
				{
					"name": "Hotels - Amadeus (Recommended)",
					"description": "**üéØ RECOMMENDED: Use Amadeus for hotel bookings**\n\n**Why Amadeus?**\n- ‚úÖ Free quota: 2,400-3,000 searches/month\n- ‚úÖ Better test data (use big cities: LON, NYC, PAR)\n- ‚úÖ More reliable and comprehensive\n- ‚úÖ Advanced filtering (amenities, ratings, chain codes)\n- ‚úÖ Map-based search support\n- ‚úÖ Server-side pagination\n\n**üìã Complete Amadeus Hotel Booking Flow:**\n\n**Step 1: Search Hotels**\n`POST /api/v1/bookings/search/hotels/amadeus`\n- Search by city code, geographic coordinates, or hotel IDs\n- Returns hotel offers with pricing, policies, availability\n- Supports pagination, filtering, map-based search\n- **Save `offer.id` from response** (used in Step 2)\n\n**Step 2: Create Booking**\n`POST /api/v1/bookings/hotels/bookings/amadeus`\n- Use `offer.id` from Step 1 as `hotelOfferId`\n- Use `final_price` from offer as `offerPrice`\n- Provide guest details and payment card info\n- **Returns `booking.id`** (used in Step 3)\n- Booking status: `PENDING` (waiting for payment)\n\n**Step 3: Create Payment Intent**\n`POST /api/v1/payments/stripe/create-intent`\n- Use `booking.id` from Step 2\n- Returns `clientSecret` for Stripe Checkout\n\n**Step 4: Complete Payment**\n- Frontend: Use Stripe.js with `clientSecret`\n- User completes payment via Stripe\n\n**Step 5: Automatic Amadeus Booking (Webhook)**\n- After payment success, Stripe webhook triggers\n- System automatically creates Amadeus booking\n- Card details decrypted and sent to Amadeus\n- Booking status updates to `CONFIRMED`\n\n**Step 6: Get Booking (Optional)**\n`GET /api/v1/bookings/hotels/bookings/:bookingId`\n- View booking details from Amadeus\n- Automatically fetches latest data\n\n**Step 7: Cancel Booking (Admin Only)**\n`POST /api/v1/bookings/hotels/bookings/:bookingId/cancel`\n- Admin-only cancellation\n- Cancels in Amadeus system\n- Updates local database\n\n**üîê Security:**\n- Card details encrypted with AES-256-GCM\n- Encrypted data cleared after successful booking\n- Only last 4 digits stored for display\n\n**üìä API Versions:**\n- **Search**: v3 (`/v3/shopping/hotel-offers`) - Latest\n- **Booking**: v2 (`/v2/booking/hotel-orders`) - Latest\n- *Note: Different endpoints can have different version numbers - this is standard practice*",
					"item": [
						{
							"name": "1. Search Hotels (Amadeus)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Status code is 200', function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"if (pm.response.code === 200) {",
											"    const response = pm.response.json();",
											"    pm.expect(response).to.have.property('success', true);",
											"    pm.expect(response).to.have.property('data');",
											"    ",
											"    if (response.data && response.data.data && response.data.data.length > 0) {",
											"        const firstHotel = response.data.data[0];",
											"        if (firstHotel.offers && firstHotel.offers.length > 0) {",
											"            const firstOffer = firstHotel.offers[0];",
											"            if (firstOffer.id) {",
											"                pm.environment.set('amadeusOfferId', firstOffer.id);",
											"                console.log('‚úÖ Amadeus offer ID saved:', firstOffer.id);",
											"            }",
											"            if (firstHotel.hotel && firstHotel.hotel.hotelId) {",
											"                pm.environment.set('amadeusHotelId', firstHotel.hotel.hotelId);",
											"                console.log('‚úÖ Amadeus hotel ID saved:', firstHotel.hotel.hotelId);",
											"            }",
											"        }",
											"    }",
											"} else if (pm.response.code === 400) {",
											"    const response = pm.response.json();",
											"    console.error('‚ùå Bad Request:', response.message);",
											"    if (response.errors && response.errors.length > 0) {",
											"        response.errors.forEach((err, idx) => {",
											"            console.error(`Error ${idx + 1}:`, err.title, '-', err.detail);",
											"            if (err.source && err.source.parameter) {",
											"                console.error('  Parameter:', err.source.parameter);",
											"            }",
											"        });",
											"    }",
											"} else if (pm.response.code === 401) {",
											"    console.error('‚ùå Authentication failed. Check AMADEUS_API_KEY and AMADEUS_API_SECRET.');",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"cityCode\": \"LON\",\n  \"checkInDate\": \"2026-06-04\",\n  \"checkOutDate\": \"2026-06-07\",\n  \"adults\": 2,\n  \"roomQuantity\": 1,\n  \"currency\": \"GBP\",\n  \"bestRateOnly\": true,\n  \"limit\": 20,\n  \"page\": 1\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/search/hotels/amadeus",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"search",
										"hotels",
										"amadeus"
									]
								},
								"description": "**Search for hotels using Amadeus Self-Service API**\n\n**No authentication required.**\n\n**What This Does:**\n- Searches hotels using Amadeus v3 API\n- Returns hotel offers with pricing, policies, and availability\n- Applies currency conversion (2.5% buffer) and markup automatically\n- Cached for 5 minutes\n- Supports search by city code or specific hotel IDs\n\n**‚ö†Ô∏è IMPORTANT - Amadeus v3 API Requirements:**\n- Amadeus v3 `/shopping/hotel-offers` endpoint **requires `hotelIds`** (cityCode is NOT supported in v3)\n- When you provide `cityCode`, the system automatically:\n  1. Calls Hotel List API to get hotel IDs by city\n  2. Then searches for offers using those hotel IDs\n- Either `cityCode` OR `hotelIds` must be provided (not both, not neither)\n- Use big cities like LON (London), NYC (New York), PAR (Paris) for best results in test environment\n- Test environment has limited data - use production for full results\n\n**Search Methods:**\n\n**1. Search by City Code (Recommended - Automatic Hotel ID Lookup):**\n```json\n{\n  \"cityCode\": \"LON\",\n  \"checkInDate\": \"2026-06-04\",\n  \"checkOutDate\": \"2026-06-07\",\n  \"adults\": 2,\n  \"roomQuantity\": 1,\n  \"currency\": \"GBP\",\n  \"limit\": 20,\n  \"page\": 1\n}\n```\n*Note: System automatically fetches hotel IDs for the city, then searches (may take slightly longer)*\n\n**2. Search by Geographic Coordinates (Map-Based Search):**\n```json\n{\n  \"geographicCoordinates\": {\n    \"latitude\": 51.5071,\n    \"longitude\": -0.1416\n  },\n  \"radius\": 5,\n  \"radiusUnit\": \"KM\",\n  \"checkInDate\": \"2026-06-04\",\n  \"checkOutDate\": \"2026-06-07\",\n  \"adults\": 2,\n  \"roomQuantity\": 1,\n  \"currency\": \"GBP\",\n  \"amenities\": [\"SWIMMING_POOL\", \"SPA\", \"FITNESS_CENTER\"],\n  \"ratings\": [4, 5],\n  \"chainCodes\": [\"MC\"],\n  \"limit\": 20,\n  \"page\": 1\n}\n```\n*Note: Perfect for map-based hotel discovery. Supports radius, amenities, ratings, and chain filtering.*\n\n**3. Search by Hotel IDs (Faster - Direct Search):**\n```json\n{\n  \"hotelIds\": [\"MCLONGHM\", \"ADPAR001\"],\n  \"checkInDate\": \"2026-06-04\",\n  \"checkOutDate\": \"2026-06-07\",\n  \"adults\": 2,\n  \"roomQuantity\": 1,\n  \"currency\": \"GBP\",\n  \"limit\": 20,\n  \"page\": 1\n}\n```\n*Note: Get hotel IDs from previous searches or use Hotel List API*\n\n**Request Parameters:**\n\n**Required:**\n- `checkInDate` (string, required): Check-in date (YYYY-MM-DD). Must be today or future.\n- `checkOutDate` (string, required): Check-out date (YYYY-MM-DD). Must be after check-in date.\n- Either `cityCode`, `geographicCoordinates`, OR `hotelIds` (required): Search method\n  - `cityCode` (string): IATA city code (e.g., \"LON\", \"NYC\", \"PAR\")\n  - `geographicCoordinates` (object): Map-based search\n    - `latitude` (number, -90 to 90): Latitude\n    - `longitude` (number, -180 to 180): Longitude\n  - `hotelIds` (array): Amadeus property codes (8 chars each, e.g., [\"MCLONGHM\"])\n\n**Optional - Search Filters:**\n- `radius` (number, optional): Search radius in kilometers when using `geographicCoordinates` (1-100, default: 5)\n- `radiusUnit` (string, optional): Radius unit. Options: `KM`, `MILE` (default: KM)\n- `chainCodes` (array, optional): Hotel chain codes (2 chars each, e.g., [\"MC\", \"HI\"])\n- `amenities` (array, optional): Hotel amenities filter. Options: SWIMMING_POOL, SPA, FITNESS_CENTER, AIR_CONDITIONING, RESTAURANT, PARKING, PETS_ALLOWED, AIRPORT_SHUTTLE, BUSINESS_CENTER, DISABLED_FACILITIES, WIFI, MEETING_ROOMS, NO_KID_ALLOWED, TENNIS, GOLF, KITCHEN, ANIMAL_WATCHING, BABY-SITTING, BEACH, CASINO, JACUZZI, SAUNA, SOLARIUM, MASSAGE, VALET_PARKING, BAR or LOUNGE, KIDS_WELCOME, NO_PORN_FILMS, MINIBAR, TELEVISION, WI-FI_IN_ROOM, ROOM_SERVICE, GUARDED_PARKG, SERV_SPEC_MENU\n- `ratings` (array, optional): Hotel star ratings (1-5, e.g., [4, 5])\n- `hotelSource` (string, optional): Hotel source. Options: `BEDBANK`, `DIRECTCHAIN`, `ALL` (default: ALL)\n\n**Optional - Booking Parameters:**\n- `adults` (number, optional): Number of adults (1-9, default: 1)\n- `roomQuantity` (number, optional): Number of rooms (1-9, default: 1)\n- `currency` (string, optional): Currency code (default: GBP). Supported: GBP, USD, EUR, NGN, JPY, CNY, GHS, KES, ZAR\n- `priceRange` (string, optional): Price per night filter (e.g., \"200-300\", \"-300\", \"100\"). Requires `currency` if set.\n- `paymentPolicy` (string, optional): Filter by payment type. Options: `GUARANTEE`, `DEPOSIT`, `NONE` (default: NONE)\n- `boardType` (string, optional): Filter by meal plan. Options: `ROOM_ONLY`, `BREAKFAST`, `HALF_BOARD`, `FULL_BOARD`, `ALL_INCLUSIVE`\n- `includeClosed` (boolean, optional): Include sold-out properties (default: false)\n- `bestRateOnly` (boolean, optional): Return only cheapest offer per hotel (default: true)\n- `countryOfResidence` (string, optional): ISO 3166-1 country code (e.g., \"GB\")\n- `lang` (string, optional): Language for descriptions (e.g., \"EN\", \"fr-FR\")\n\n**Optional - Pagination:**\n- `limit` (number, optional): Hotels per page (1-100, default: 20)\n- `page` (number, optional): Page number (1-based, default: 1)\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"data\": [\n      {\n        \"type\": \"hotel-offers\",\n        \"hotel\": {\n          \"hotelId\": \"MCLONGHM\",\n          \"name\": \"JW Marriott Grosvenor House London\",\n          \"cityCode\": \"LON\",\n          \"chainCode\": \"MC\"\n        },\n        \"available\": true,\n        \"offers\": [\n          {\n            \"id\": \"TSXOJ6LFQ2\",\n            \"checkInDate\": \"2026-06-04\",\n            \"checkOutDate\": \"2026-06-07\",\n            \"price\": {\n              \"currency\": \"GBP\",\n              \"base\": \"716.00\",\n              \"total\": \"716.00\",\n              \"original_total\": \"716.00\",\n              \"original_currency\": \"GBP\"\n            },\n            \"final_price\": \"734.90\",\n            \"markup_percentage\": 10,\n            \"markup_amount\": \"7.17\",\n            \"conversion_fee\": \"0.00\",\n            \"room\": { ... },\n            \"policies\": { ... }\n          }\n        ]\n      }\n    ],\n    \"meta\": {\n      \"count\": 20,\n      \"total\": 45,\n      \"limit\": 20,\n      \"page\": 1,\n      \"totalPages\": 3,\n      \"hasMore\": true,\n      \"nextPage\": 2,\n      \"prevPage\": null\n    },\n    \"currency\": \"GBP\",\n    \"conversion_note\": \"Prices include a 2.5% conversion fee...\",\n    \"cached\": false\n  },\n  \"message\": \"Hotels retrieved successfully\"\n}\n```\n\n**Pagination Metadata:**\n- `count`: Number of hotels in current page\n- `total`: Total number of hotels matching search criteria\n- `limit`: Hotels per page\n- `page`: Current page number\n- `totalPages`: Total number of pages\n- `hasMore`: Whether there are more pages\n- `nextPage`: Next page number (null if last page)\n- `prevPage`: Previous page number (null if first page)\n\n**Price Breakdown:**\n- `original_price`: Price from Amadeus (before conversion)\n- `original_currency`: Currency from Amadeus (usually USD or hotel local currency)\n- `base_price`: Converted base price (no fees)\n- `conversion_fee`: Currency conversion buffer (2.5% default)\n- `price_after_conversion`: Base + conversion fee\n- `markup_percentage`: Business markup percentage\n- `markup_amount`: Markup amount\n- `final_price`: Total price customer pays (base + conversion fee + markup)\n\n**Common Error Codes:**\n- `61` - INVALID CURRENCY CODE\n- `137` - INVALID ADULTS OCCUPANCY REQUESTED\n- `145` - DURATION PERIOD OR DATES INCORRECT\n- `381` - INVALID CHECK-IN DATE (date in past)\n- `382` - INVALID CHECK-OUT DATE\n- `383` - INVALID CITY CODE\n- `392` - INVALID HOTEL CODE\n- `397` - INVALID NUMBER OF ADULTS\n- `400` - INVALID PROPERTY CODE\n- `404` - CHECK_OUT DATE MUST BE FURTHER IN THE FUTURE THAN CHECK-IN DATE\n- `424` - NO HOTELS FOUND WHICH MATCH THIS INPUT\n- `431` - CHECK-OUT DATE IS TOO FAR IN THE FUTURE\n\n**Error Response Format:**\n```json\n{\n  \"success\": false,\n  \"statusCode\": 400,\n  \"message\": \"INVALID CITY CODE\",\n  \"error\": \"Bad Request\",\n  \"errors\": [\n    {\n      \"status\": 400,\n      \"code\": 383,\n      \"title\": \"INVALID CITY CODE\",\n      \"detail\": \"The city code provided is not valid\",\n      \"source\": {\n        \"parameter\": \"cityCode\"\n      },\n      \"documentation\": \"https://developers.amadeus.com/...\"\n    }\n  ]\n}\n```\n\n**Tips:**\n- Use city codes for broad searches (LON, NYC, PAR, etc.)\n- Use `geographicCoordinates` for map-based hotel discovery\n- Use hotel IDs for specific hotels (get from previous searches)\n- Test environment has limited data - use big cities\n- `bestRateOnly: true` returns only cheapest offer per hotel (faster)\n- `bestRateOnly: false` returns all available offers (more options)\n- Prices are automatically converted to requested currency\n- Markup is applied based on your configuration\n- Use pagination (`limit`, `page`) to navigate through large result sets\n- Filter by `amenities`, `ratings`, `chainCodes` to narrow results\n- Results are cached for 5 minutes (same search returns instantly)\n\n**Free Quota:**\n- 2,400-3,000 free searches per month (depending on API version)\n- Additional requests charged per transaction\n\n**Use Case:**\n- Hotel search by location\n- Hotel search by specific properties\n- Price comparison across hotels\n- Filter by payment policy, meal plans, etc."
							},
							"response": []
						},
						{
							"name": "Get Hotel Details (Amadeus)",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/amadeus/:hotelId/details?includeImages=true&includeRatings=true&includeOffers=true&checkInDate=2026-06-04&checkOutDate=2026-06-07&adults=2&roomQuantity=1",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"amadeus",
										":hotelId",
										"details"
									],
									"query": [
										{
											"key": "offerId",
											"value": "",
											"description": "Specific offer ID to get detailed pricing for",
											"disabled": true
										},
										{
											"key": "checkInDate",
											"value": "2026-06-04",
											"description": "Check-in date (YYYY-MM-DD) - Required for current offers"
										},
										{
											"key": "checkOutDate",
											"value": "2026-06-07",
											"description": "Check-out date (YYYY-MM-DD) - Required for current offers"
										},
										{
											"key": "adults",
											"value": "2",
											"description": "Number of adults (for current offers)"
										},
										{
											"key": "roomQuantity",
											"value": "1",
											"description": "Number of rooms (for current offers)"
										},
										{
											"key": "includeImages",
											"value": "true",
											"description": "Include hotel images (default: true)"
										},
										{
											"key": "includeRatings",
											"value": "true",
											"description": "Include hotel ratings/sentiments (default: true)"
										},
										{
											"key": "includeOffers",
											"value": "true",
											"description": "Include current offers if dates provided (default: true)"
										}
									]
								},
								"description": "**Get comprehensive hotel details (Amadeus)**\n\n**No authentication required.**\n\n**üéØ What This Does:**\n- Returns comprehensive hotel information in a single endpoint\n- Combines: hotel basic info, ratings, offers, and images\n- **Recommended endpoint for building hotel details pages**\n- Supports optional filtering and selective data inclusion\n\n**üìã URL Parameters:**\n- `hotelId` (string, required): Amadeus hotel ID (8 characters, e.g., \"MCLONGHM\")\n  - Get this from: `POST /api/v1/bookings/search/hotels/amadeus` ‚Üí `hotel.hotelId`\n\n**üìã Query Parameters:**\n- `offerId` (string, optional): Specific offer ID to get detailed pricing for\n- `checkInDate` (string, optional): Check-in date (YYYY-MM-DD) - Required if you want current offers\n- `checkOutDate` (string, optional): Check-out date (YYYY-MM-DD) - Required if you want current offers\n- `adults` (number, optional): Number of adults (default: 1)\n- `roomQuantity` (number, optional): Number of rooms (default: 1)\n- `includeImages` (boolean, optional): Include hotel images (default: true)\n- `includeRatings` (boolean, optional): Include hotel ratings/sentiments (default: true)\n- `includeOffers` (boolean, optional): Include current offers if dates provided (default: true)\n\n**‚úÖ Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"hotel\": {\n      \"hotelId\": \"MCLONGHM\",\n      \"name\": \"JW Marriott Grosvenor House London\",\n      \"chainCode\": \"MC\",\n      \"cityCode\": \"LON\",\n      \"latitude\": 51.5074,\n      \"longitude\": -0.1278,\n      \"address\": {...},\n      \"amenities\": [\"WIFI\", \"PARKING\", \"RESTAURANT\"],\n      \"description\": \"...\"\n    },\n    \"ratings\": {\n      \"overallRating\": 4.5,\n      \"numberOfRatings\": 1234,\n      \"sentiment\": \"POSITIVE\",\n      \"categories\": [...]\n    },\n    \"offerPricing\": {...},\n    \"currentOffers\": [\n      {\n        \"id\": \"TSXOJ6LFQ2\",\n        \"price\": {...},\n        \"room\": {...},\n        \"policies\": {...}\n      }\n    ],\n    \"images\": {\n      \"images\": [\n        {\n          \"url\": \"https://res.cloudinary.com/...\",\n          \"type\": \"exterior\",\n          \"source\": \"google_places\"\n        }\n      ],\n      \"cached\": false,\n      \"fallbackUsed\": false\n    },\n    \"metadata\": {\n      \"hotelId\": \"MCLONGHM\",\n      \"offerId\": null,\n      \"checkInDate\": \"2026-06-04\",\n      \"checkOutDate\": \"2026-06-07\",\n      \"fetchedAt\": \"2026-02-03T10:30:00.000Z\"\n    }\n  }\n}\n```\n\n**üí° Usage Examples:**\n\n**1. Basic Hotel Info Only:**\n```\nGET /api/v1/bookings/hotels/amadeus/MCLONGHM/details\n```\n- Returns: Hotel basic info, ratings, images\n- No offers (dates not provided)\n\n**2. With Current Offers:**\n```\nGET /api/v1/bookings/hotels/amadeus/MCLONGHM/details?checkInDate=2026-06-04&checkOutDate=2026-06-07&adults=2\n```\n- Returns: Hotel info + current offers for dates\n- Includes pricing, room types, policies\n\n**3. Specific Offer Pricing:**\n```\nGET /api/v1/bookings/hotels/amadeus/MCLONGHM/details?offerId=TSXOJ6LFQ2\n```\n- Returns: Hotel info + detailed pricing for specific offer\n- Use when user selects a specific offer\n\n**4. Without Images (Faster):**\n```\nGET /api/v1/bookings/hotels/amadeus/MCLONGHM/details?includeImages=false\n```\n- Skips image fetching (faster response)\n- Use if images already loaded\n\n**5. Without Ratings (Faster):**\n```\nGET /api/v1/bookings/hotels/amadeus/MCLONGHM/details?includeRatings=false\n```\n- Skips ratings API call (faster response)\n\n**üéØ Complete Flow for Hotel Details Page:**\n\n```\n1. User clicks hotel from search results\n2. Frontend calls:\n   GET /api/v1/bookings/hotels/amadeus/{hotelId}/details?checkInDate=...&checkOutDate=...\n3. Backend returns:\n   - Hotel basic info\n   - Ratings/sentiments\n   - Current offers (if dates provided)\n   - Images (from Google Places or fallback)\n4. Frontend displays complete hotel details page\n```\n\n**üîó Related Endpoints:**\n- `POST /api/v1/bookings/search/hotels/amadeus` - Get hotelId from search\n- `GET /api/v1/bookings/hotels/:hotelId/images` - Get images separately (if needed)\n\n**‚ö†Ô∏è Important Notes:**\n- **All data is optional** - If a service fails, others still work\n- **Images always returned** - Uses fallback if Google Places unavailable\n- **Offers require dates** - Won't return offers without checkInDate/checkOutDate\n- **Ratings may be null** - Not all hotels have ratings data\n- **Fast response** - Uses caching where possible\n\n**üìä Performance:**\n- **With all data**: ~2-3 seconds (multiple API calls)\n- **Without images**: ~1-2 seconds\n- **Without ratings**: ~1-2 seconds\n- **Basic info only**: ~0.5-1 second"
							},
							"response": []
						},
						{
							"name": "2. Create Hotel Booking (Amadeus)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Status code is 200 or 201', function () {",
											"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
											"});",
											"",
											"const json = pm.response.json();",
											"if (json && json.data && json.data.booking && json.data.booking.id) {",
											"    pm.environment.set('bookingId', json.data.booking.id);",
											"    pm.environment.set('bookingReference', json.data.booking.reference || '');",
											"    console.log('‚úÖ bookingId saved from Amadeus hotel booking:', json.data.booking.id);",
											"} else if (json && json.booking && json.booking.id) {",
											"    // Fallback shape: { booking: { ... } }",
											"    pm.environment.set('bookingId', json.booking.id);",
											"    pm.environment.set('bookingReference', json.booking.reference || '');",
											"    console.log('‚úÖ bookingId saved from Amadeus hotel booking (fallback shape):', json.booking.id);",
											"} else {",
											"    console.warn('‚ö†Ô∏è Could not find bookingId in response.');",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Authorization",
										"value": "Bearer {{token}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"hotelOfferId\": \"{{amadeusOfferId}}\",\n  \"offerPrice\": 2002.40,\n  \"currency\": \"GBP\",\n  \"guests\": [\n    {\n      \"name\": {\n        \"title\": \"MR\",\n        \"firstName\": \"John\",\n        \"lastName\": \"Doe\"\n      },\n      \"contact\": {\n        \"phone\": \"+33679278416\",\n        \"email\": \"john.doe@example.com\"\n      }\n    }\n  ],\n  \"roomAssociations\": [\n    {\n      \"hotelOfferId\": \"{{amadeusOfferId}}\",\n      \"guestReferences\": [\n        {\n          \"guestReference\": \"1\"\n        }\n      ]\n    }\n  ],\n  \"payment\": {\n    \"method\": \"CREDIT_CARD\",\n    \"paymentCard\": {\n      \"paymentCardInfo\": {\n        \"vendorCode\": \"VI\",\n        \"cardNumber\": \"4151289722471370\",\n        \"expiryDate\": \"2026-08\",\n        \"holderName\": \"JOHN DOE\",\n        \"securityCode\": \"123\"\n      }\n    }\n  },\n  \"travelAgentEmail\": \"agent@example.com\",\n  \"accommodationSpecialRequests\": \"Late check-in requested\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/bookings/amadeus",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"bookings",
										"amadeus"
									]
								},
								"description": "**Create an Amadeus hotel booking**\n\n**Authentication required.**\n\n**What This Does:**\n- Creates a local booking for an Amadeus hotel offer\n- Stores booking details and guest information (card details encrypted)\n- Returns booking ID for payment intent creation\n- After payment succeeds, the actual Amadeus booking will be created automatically via webhook\n\n**‚ö†Ô∏è IMPORTANT - Complete Booking Flow:**\n\n**Step 1: Search Hotels (Amadeus)**\n`POST /api/v1/bookings/search/hotels/amadeus`\n- Get hotel offers with pricing\n- **Save `offer.id` from response** (this is your `hotelOfferId`)\n- **Save `final_price` from offer** (this is your `offerPrice`)\n\n**Step 2: Create Booking (This Endpoint)**\n`POST /api/v1/bookings/hotels/bookings/amadeus`\n- Use `offer.id` as `hotelOfferId`\n- Use `final_price` as `offerPrice`\n- Provide guest details and payment card info\n- **Returns `booking.id`** (used in Step 3)\n- Booking status: `PENDING` (waiting for payment)\n- Card details encrypted and stored securely\n\n**Step 3: Create Payment Intent**\n`POST /api/v1/payments/stripe/create-intent`\n- Use `booking.id` from Step 2\n- Returns `clientSecret` for Stripe Checkout\n\n**Step 4: Complete Payment**\n- Frontend: Use Stripe.js with `clientSecret`\n- User completes payment via Stripe\n\n**Step 5: Automatic Amadeus Booking (Webhook)**\n- After payment success, Stripe webhook triggers automatically\n- System decrypts card details\n- Creates actual booking in Amadeus system\n- Booking status updates to `CONFIRMED`\n\n**Request Body:**\n- `hotelOfferId` (string, required): Offer ID from search results (e.g., \"TSXOJ6LFQ2\")\n- `offerPrice` (number, required): Final price from offer (use `final_price` from search results)\n- `currency` (string, required): Currency code (ISO 4217, e.g., \"GBP\")\n- `guests` (array, required): Guest details\n  - `name` (object, required): Guest name\n    - `title` (string, required): MR, MRS, MS, MISS, DR, PROF\n    - `firstName` (string, required): First name\n    - `lastName` (string, required): Last name\n  - `contact` (object, required): Contact information\n    - `phone` (string, required): Phone in E.164 format (e.g., +33679278416)\n    - `email` (string, required): Email address\n- `roomAssociations` (array, required): Room and guest assignments\n  - `hotelOfferId` (string, required): Same as top-level hotelOfferId\n  - `guestReferences` (array, required): Guest references (1-based index)\n    - `guestReference` (string, required): \"1\", \"2\", etc. (matches guest index in `guests` array)\n- `payment` (object, required): Payment card information\n  - `method` (string, required): \"CREDIT_CARD\"\n  - `paymentCard` (object, required): Card details\n    - `paymentCardInfo` (object, required): Card information\n      - `vendorCode` (string, required): VI (Visa), MC (Mastercard), AX (Amex), CA (Carte Blanche), DC (Diners Club), DI (Discover), JC (JCB), TP (Universal Air Travel)\n      - `cardNumber` (string, required): Full card number (16 digits for most cards)\n      - `expiryDate` (string, required): YYYY-MM format (e.g., \"2026-08\")\n      - `holderName` (string, optional): Card holder name (as on card)\n      - `securityCode` (string, optional): CVV/CVC (3-4 digits)\n- `travelAgentEmail` (string, optional): Travel agent email\n- `accommodationSpecialRequests` (string, optional): Special requests (e.g., \"Late check-in requested\")\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"booking\": {\n      \"id\": \"clx1234567890\",\n      \"reference\": \"EBT-20260203-ABC123\",\n      \"status\": \"PENDING\",\n      \"paymentStatus\": \"PENDING\",\n      \"totalAmount\": \"2002.40\",\n      \"currency\": \"GBP\",\n      \"provider\": \"AMADEUS\"\n    },\n    \"message\": \"Booking created. Please proceed to payment.\"\n  },\n  \"message\": \"Booking created. Please proceed to payment.\"\n}\n```\n\n**Next Steps:**\n1. Use `booking.id` to create payment intent: `POST /api/v1/payments/stripe/create-intent`\n2. Complete payment via Stripe\n3. After payment success, Amadeus booking is created automatically (webhook)\n4. Booking status updates to `CONFIRMED`\n5. Get booking details: `GET /api/v1/bookings/hotels/bookings/:bookingId`\n\n**üîê Security:**\n- Card details are encrypted with AES-256-GCM before storage\n- Only last 4 digits stored for display\n- Encrypted data cleared after successful Amadeus booking\n- Full card details decrypted only when creating Amadeus booking (after payment)\n\n**Example Request:**\n```json\n{\n  \"hotelOfferId\": \"{{amadeusOfferId}}\",\n  \"offerPrice\": 2002.40,\n  \"currency\": \"GBP\",\n  \"guests\": [\n    {\n      \"name\": {\n        \"title\": \"MR\",\n        \"firstName\": \"John\",\n        \"lastName\": \"Doe\"\n      },\n      \"contact\": {\n        \"phone\": \"+33679278416\",\n        \"email\": \"john.doe@example.com\"\n      }\n    }\n  ],\n  \"roomAssociations\": [\n    {\n      \"hotelOfferId\": \"{{amadeusOfferId}}\",\n      \"guestReferences\": [{\"guestReference\": \"1\"}]\n    }\n  ],\n  \"payment\": {\n    \"method\": \"CREDIT_CARD\",\n    \"paymentCard\": {\n      \"paymentCardInfo\": {\n        \"vendorCode\": \"VI\",\n        \"cardNumber\": \"4151289722471370\",\n        \"expiryDate\": \"2026-08\",\n        \"holderName\": \"JOHN DOE\",\n        \"securityCode\": \"123\"\n      }\n    }\n  }\n}\n```\n\n**Note:** Use `{{amadeusOfferId}}` from Step 1 (Search Hotels) response, and `final_price` as `offerPrice`."
							},
							"response": []
						}
					]
				},
				{
					"name": "Hotels - Duffel",
					"description": "**Duffel Stays API for hotel bookings**\n\n**‚ö†Ô∏è IMPORTANT:**\n- Requires Duffel Stays account access\n- May return `403 Forbidden` if not enabled for your account\n- Contact Duffel support to enable Stays API access\n\n**üìã Duffel Hotel Booking Flow:**\n\n**Step 1: Search Hotels**\n`POST /api/v1/bookings/search/hotels`\n- Search by location (coordinates) or accommodation IDs\n- Returns hotels with prices\n\n**Step 2: Get Hotel Rates**\n`GET /api/v1/bookings/hotels/rates/:searchResultId`\n- Get detailed rates for a specific hotel\n- Returns all room types and pricing\n\n**Step 3: Create Hotel Quote**\n`POST /api/v1/bookings/hotels/quotes`\n- Reserve a rate temporarily\n- Returns `quote_id`\n\n**Step 4: Create Hotel Booking**\n`POST /api/v1/bookings/hotels/bookings`\n- Use `quote_id` from Step 3\n- Provide guest details\n- Booking is immediately confirmed\n\n**Step 5: List/Get Hotel Bookings**\n- View bookings (see Common Operations)\n\n**Step 6: Cancel Hotel Booking (Admin Only)**\n- Admin-only cancellation (see Common Operations)\n\n**Utilities:**\n- **Get Accommodation Details** - Hotel info by ID\n- **Search Accommodation Suggestions** - Autocomplete\n- **Get Accommodation Reviews** - Guest reviews",
					"item": [
						{
							"name": "Search Hotels (Duffel)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"location\": {\n    \"geographic_coordinates\": {\n      \"latitude\": 51.5071,\n      \"longitude\": -0.1416\n    },\n    \"radius\": 5\n  },\n  \"check_in_date\": \"2026-06-04\",\n  \"check_out_date\": \"2026-06-07\",\n  \"rooms\": 1,\n  \"guests\": [\n    { \"type\": \"adult\" },\n    { \"type\": \"adult\" }\n  ],\n  \"currency\": \"GBP\",\n  \"free_cancellation_only\": false\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/search/hotels",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"search",
										"hotels"
									]
								},
								"description": "**Search for hotels/accommodation (Duffel)**\n\n**No authentication required.**\n\n**What This Does:**\n- Searches hotels using Duffel Stays API\n- Returns hotels with prices (converted to selected currency)\n- Applies markup automatically\n- Cached for 5 minutes\n\n**‚ö†Ô∏è IMPORTANT:**\n- Requires Duffel Stays account access\n- May return `403 Forbidden` if not enabled\n- Contact Duffel support to enable Stays API\n\n**Search Methods:**\n\n**1. Location-Based Search (by coordinates):**\n```json\n{\n  \"location\": {\n    \"geographic_coordinates\": {\n      \"latitude\": 51.5071,\n      \"longitude\": -0.1416\n    },\n    \"radius\": 5\n  },\n  \"check_in_date\": \"2026-06-04\",\n  \"check_out_date\": \"2026-06-07\",\n  \"rooms\": 1,\n  \"guests\": [{ \"type\": \"adult\" }],\n  \"currency\": \"GBP\"\n}\n```\n\n**2. Accommodation-Based Search (by hotel IDs):**\n```json\n{\n  \"accommodation\": {\n    \"ids\": [\"acc_0000AWr2VsUNIF1Vl91xg0\"],\n    \"fetch_rates\": true\n  },\n  \"check_in_date\": \"2026-06-04\",\n  \"check_out_date\": \"2026-06-07\",\n  \"rooms\": 1,\n  \"guests\": [{ \"type\": \"adult\" }],\n  \"currency\": \"GBP\"\n}\n```\n\n**Request Parameters:**\n- `location` (object, optional): Location-based search\n  - `geographic_coordinates`: { `latitude` (-90 to 90), `longitude` (-180 to 180) }\n  - `radius` (number, optional): Search radius in km (1-100, default: 5)\n- `accommodation` (object, optional): Search by hotel IDs\n  - `ids` (array, required): List of accommodation IDs (max 10 with rates, 200 without)\n  - `fetch_rates` (boolean, optional): Whether to fetch rates (default: false)\n- `check_in_date` (string, required): ISO 8601 date (max 330 days in future)\n- `check_out_date` (string, required): ISO 8601 date (max 99 nights stay)\n- `rooms` (number, required): Number of rooms (min: 1)\n- `guests` (array, required): List of guests\n  - `type` (string, required): \"adult\" or \"child\"\n  - `age` (number, optional): Age for children (0-17)\n- `currency` (string, optional): Currency code (default: GBP). Supported: GBP, USD, EUR, NGN, JPY, CNY, GHS, KES, ZAR\n- `free_cancellation_only` (boolean, optional): Filter for free cancellation only (default: false)\n- `mobile` (boolean, optional): Whether search is from mobile (default: false)\n- `negotiated_rate_ids` (array, optional): Corporate/group rate IDs\n\n**Response:**\n- Returns hotels with `cheapest_rate_total_amount` (includes markup and conversion fee)\n- Each hotel includes `accommodation` details and available `rooms`\n- Prices are in selected currency with transparent conversion fee"
							},
							"response": []
						},
						{
							"name": "Get Hotel Rates (Duffel)",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/rates/:searchResultId?currency=GBP",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"rates",
										":searchResultId"
									],
									"query": [
										{
											"key": "currency",
											"value": "GBP",
											"description": "Currency code (default: GBP)"
										}
									]
								},
								"description": "**Get detailed rates for a specific hotel search result (Duffel)**\n\n**No authentication required.**\n\n**What This Does:**\n- Fetches all available rates for a hotel from search results\n- Returns detailed pricing for each room type\n- Applies currency conversion and markup\n\n**URL Parameters:**\n- `searchResultId` (string, required): Search result ID from hotel search\n\n**Query Parameters:**\n- `currency` (string, optional): Currency code (default: GBP)\n\n**Use Case:**\n- User clicks on a hotel from search results\n- Frontend calls this endpoint to get all room types and rates\n- Display detailed pricing options to user"
							},
							"response": []
						},
						{
							"name": "Create Hotel Quote (Duffel)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"rate_id\": \"rat_0000BTVRuKZTavzrZDJ4cb\",\n  \"search_result_id\": \"srr_0000ASVBuJVLdmqtZDJ4ca\",\n  \"currency\": \"GBP\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/quotes",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"quotes"
									]
								},
								"description": "**Create a hotel quote (reserve rate) - Duffel**\n\n**No authentication required.**\n\n**What This Does:**\n- Creates a quote for a specific hotel rate\n- Reserves the rate temporarily\n- Returns final pricing with all fees\n\n**Request Body:**\n- `rate_id` (string, required): Rate ID from hotel rates\n- `search_result_id` (string, required): Search result ID\n- `currency` (string, optional): Currency code (default: GBP)\n\n**Response:**\n- Returns quote with `quote_id`\n- Use `quote_id` to create booking\n- Quote includes all pricing breakdown"
							},
							"response": []
						},
						{
							"name": "Create Hotel Booking (Duffel)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Authorization",
										"value": "Bearer {{token}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"quote_id\": \"quo_0000BTVRuKZTavzrZDJ4cb\",\n  \"email\": \"guest@example.com\",\n  \"phone_number\": \"+442080160509\",\n  \"guests\": [\n    {\n      \"given_name\": \"John\",\n      \"family_name\": \"Doe\",\n      \"type\": \"adult\"\n    }\n  ],\n  \"accommodation_special_requests\": \"Late check-in requested\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/bookings",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"bookings"
									]
								},
								"description": "**Create a hotel booking (Duffel)**\n\n**Authentication required.**\n\n**What This Does:**\n- Creates a confirmed hotel booking using Duffel Stays API\n- Requires quote_id from Create Hotel Quote\n- Stores booking in database\n\n**Request Body:**\n- `quote_id` (string, required): Quote ID from Create Hotel Quote\n- `email` (string, required): Lead guest email\n- `phone_number` (string, required): Phone in E.164 format (e.g., +442080160509)\n- `guests` (array, required): Guest details\n  - `given_name` (string, required): First name\n  - `family_name` (string, required): Last name\n  - `type` (string, required): \"adult\" or \"child\"\n  - `age` (number, optional): Age for children (0-17)\n- `accommodation_special_requests` (string, optional): Special requests\n- `payment` (object, optional): Payment method (if paying via Duffel balance)\n- `metadata` (object, optional): Custom metadata\n\n**Response:**\n- Returns booking with `bookingId`\n- Booking is immediately confirmed\n- Use booking ID for payment processing"
							},
							"response": []
						},
						{
							"name": "Get Accommodation Details (Duffel)",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/accommodation/:accommodationId",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"accommodation",
										":accommodationId"
									]
								},
								"description": "**Get accommodation/hotel details by ID**\n\n**No authentication required.**\n\n**URL Parameters:**\n- `accommodationId` (string, required): Accommodation ID\n\n**Use Case:**\n- Display hotel details page\n- Show amenities, location, photos\n- Use before searching for rates"
							},
							"response": []
						},
						{
							"name": "Search Accommodation Suggestions (Duffel)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"query\": \"london\",\n  \"location\": {\n    \"geographic_coordinates\": {\n      \"latitude\": 51.5071,\n      \"longitude\": -0.1416\n    },\n    \"radius\": 10\n  }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/accommodation/suggestions",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"accommodation",
										"suggestions"
									]
								},
								"description": "**Search for hotel/accommodation suggestions (autocomplete)**\n\n**No authentication required.**\n\n**What This Does:**\n- Provides autocomplete suggestions for hotel search\n- Minimum 3 characters required\n- Optional location-based filtering\n\n**Request Body:**\n- `query` (string, required): Search query (min 3 characters)\n- `location` (object, optional): Location filter\n  - `geographic_coordinates`: { `latitude`, `longitude` }\n  - `radius` (number, optional): Radius in km (1-100, default: 5)\n\n**Use Case:**\n- Hotel search autocomplete\n- Location-based suggestions\n- Find hotels by name or location"
							},
							"response": []
						},
						{
							"name": "Get Accommodation Reviews (Duffel)",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/accommodation/:accommodationId/reviews?limit=20",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"accommodation",
										":accommodationId",
										"reviews"
									],
									"query": [
										{
											"key": "limit",
											"value": "20",
											"description": "Items per page"
										},
										{
											"key": "after",
											"value": "",
											"description": "Pagination cursor",
											"disabled": true
										}
									]
								},
								"description": "**Get accommodation reviews**\n\n**No authentication required.**\n\n**URL Parameters:**\n- `accommodationId` (string, required): Accommodation ID\n\n**Query Parameters:**\n- `limit` (number, optional): Items per page\n- `after` (string, optional): Pagination cursor\n- `before` (string, optional): Previous page cursor\n\n**Response:**\n- Returns paginated guest reviews\n- Includes ratings, comments, dates"
							},
							"response": []
						}
					]
				},
				{
					"name": "Hotels - Common Operations",
					"description": "**Common hotel booking operations that work for both Duffel and Amadeus**\n\nThese endpoints automatically detect the provider (Duffel or Amadeus) and work seamlessly with both.\n\n**Endpoints:**\n- **List Hotel Bookings** - View all user's hotel bookings (both providers)\n- **Get Hotel Booking** - Get booking details (automatically fetches from correct provider)\n- **Cancel Hotel Booking** - Admin-only cancellation (works for both providers)",
					"item": [
						{
							"name": "List Hotel Bookings",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/bookings?limit=20",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"bookings"
									],
									"query": [
										{
											"key": "limit",
											"value": "20",
											"description": "Items per page"
										},
										{
											"key": "cursor",
											"value": "",
											"description": "Pagination cursor",
											"disabled": true
										}
									]
								},
								"description": "**List user's hotel bookings**\n\n**Authentication required.**\n\n**Query Parameters:**\n- `limit` (number, optional): Items per page (default: 20, max: 200)\n- `cursor` (string, optional): Pagination cursor\n\n**Response:**\n- Returns paginated list of hotel bookings\n- Includes booking details, dates, pricing\n- Works for both Duffel and Amadeus bookings"
							},
							"response": []
						},
						{
							"name": "Get Hotel Booking",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/bookings/:bookingId",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"bookings",
										":bookingId"
									]
								},
								"description": "**Get hotel booking details**\n\n**Authentication required.**\n\n**URL Parameters:**\n- `bookingId` (string, required): Booking ID\n\n**Response:**\n- Returns full booking details from provider (Duffel or Amadeus)\n- Includes accommodation, guests, dates, pricing\n- Supports both Duffel and Amadeus hotel bookings\n- Automatically fetches latest data from provider API\n- Falls back to cached data if provider API fails"
							},
							"response": []
						},
						{
							"name": "Cancel Hotel Booking (Admin Only)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/bookings/:bookingId/cancel",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"bookings",
										":bookingId",
										"cancel"
									]
								},
								"description": "**Cancel a hotel booking (Admin Only)**\n\n**Admin authentication required.**\n\n**What This Does:**\n- Cancels hotel booking in provider (Duffel or Amadeus)\n- Updates local database\n- Only admins can cancel (same as flight cancellations)\n- Supports both Duffel and Amadeus hotel bookings\n\n**URL Parameters:**\n- `bookingId` (string, required): Booking ID to cancel\n\n**Response:**\n- Returns cancellation confirmation\n- Booking status updated to CANCELLED\n- Refund status updated if applicable\n\n**Note:**\n- Works for both Duffel and Amadeus hotel bookings\n- Cancellation policies depend on hotel provider\n- Refunds processed according to hotel cancellation policy"
							},
							"response": []
						},
						{
							"name": "Get Hotel Images",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/:hotelId/images?hotelName=JW+Marriott+Grosvenor+House+London&googlePlaceId=",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										":hotelId",
										"images"
									],
									"query": [
										{
											"key": "hotelName",
											"value": "JW Marriott Grosvenor House London",
											"description": "Hotel name (required for Google Places search)",
											"disabled": false
										},
										{
											"key": "googlePlaceId",
											"value": "",
											"description": "Google Place ID (optional, if you have it)",
											"disabled": true
										}
									]
								},
								"description": "**Get hotel images with caching and fallback support**\n\n**No authentication required.**\n\n**üéØ What This Does:**\n- Fetches hotel images from Google Places API (if configured)\n- Caches images in Cloudinary for 60 days\n- **Automatically falls back to placeholder images** if:\n  - Google Places API key is missing/invalid\n  - Hotel not found in Google Places\n  - Rate limit reached\n  - Any error occurs\n- **Never crashes** - always returns images\n\n**üìã URL Parameters:**\n- `hotelId` (string, required): Hotel ID from search results (e.g., \"MCLONGHM\")\n  - Get this from: `POST /api/v1/bookings/search/hotels/amadeus` ‚Üí `hotel.hotelId`\n\n**üìã Query Parameters:**\n- `hotelName` (string, required): Hotel name for Google Places search\n  - Get this from: `POST /api/v1/bookings/search/hotels/amadeus` ‚Üí `hotel.name`\n  - Example: \"JW Marriott Grosvenor House London\"\n- `googlePlaceId` (string, optional): Google Place ID if you have it (skips search step)\n\n**‚úÖ Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"hotelId\": \"MCLONGHM\",\n    \"hotelName\": \"JW Marriott Grosvenor House London\",\n    \"images\": [\n      {\n        \"url\": \"https://res.cloudinary.com/.../hotel_MCLONGHM_0.jpg\",\n        \"type\": \"exterior\",\n        \"source\": \"google_places\",\n        \"attribution\": \"Photo from Google Places\"\n      }\n    ],\n    \"details\": {\n      \"address\": \"86-90 Park Lane, London\",\n      \"rating\": 4.5,\n      \"totalReviews\": 1234\n    },\n    \"cached\": false,\n    \"fallbackUsed\": false,\n    \"message\": \"Hotel images retrieved successfully\"\n  }\n}\n```\n\n**üîÑ Fallback Response (when Google Places unavailable):**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"hotelId\": \"MCLONGHM\",\n    \"hotelName\": \"JW Marriott Grosvenor House London\",\n    \"images\": [\n      {\n        \"url\": \"https://via.placeholder.com/800x600/4A90E2/FFFFFF?text=Hotel+Exterior\",\n        \"type\": \"exterior\",\n        \"source\": \"placeholder\",\n        \"attribution\": \"Generic hotel image\"\n      }\n    ],\n    \"cached\": false,\n    \"fallbackUsed\": true,\n    \"message\": \"Hotel-specific images are currently unavailable. Showing generic hotel images for reference.\"\n  }\n}\n```\n\n**üß™ Testing Scenarios:**\n\n**Scenario 1: Hotel with Google Places Images**\n```\nGET /api/v1/bookings/hotels/MCLONGHM/images?hotelName=JW+Marriott+Grosvenor+House+London\n```\n- ‚úÖ Returns Google Places images (if API key configured)\n- ‚úÖ Caches in database for 60 days\n- ‚úÖ Returns hotel details (address, rating, reviews)\n\n**Scenario 2: Hotel Not Found in Google Places**\n```\nGET /api/v1/bookings/hotels/UNKNOWNHM/images?hotelName=Very+New+Hotel+London\n```\n- ‚úÖ Returns placeholder images (fallback)\n- ‚úÖ `fallbackUsed: true`\n- ‚úÖ User-friendly message\n- ‚úÖ **No error - always succeeds**\n\n**Scenario 3: Google Places API Key Missing**\n```\n# Remove GOOGLE_PLACES_API_KEY from .env\nGET /api/v1/bookings/hotels/MCLONGHM/images?hotelName=JW+Marriott\n```\n- ‚úÖ Returns placeholder images (fallback)\n- ‚úÖ `fallbackUsed: true`\n- ‚úÖ **Works perfectly without API key**\n\n**Scenario 4: Cached Images**\n```\n# First request: Fetches from Google Places, caches\nGET /api/v1/bookings/hotels/MCLONGHM/images?hotelName=JW+Marriott\n\n# Second request (within 60 days): Returns from cache\nGET /api/v1/bookings/hotels/MCLONGHM/images?hotelName=JW+Marriott\n```\n- ‚úÖ `cached: true` in response\n- ‚úÖ Fast response (no API calls)\n- ‚úÖ No Google Places API usage\n\n**üìä Response Fields:**\n- `images[]`: Array of image objects\n  - `url`: Image URL (Cloudinary or placeholder)\n  - `type`: Image type (exterior, interior, room, amenity, other)\n  - `source`: Image source (google_places, placeholder)\n  - `attribution`: Attribution text (if required)\n- `details`: Hotel details from Google Places (if available)\n  - `address`: Full address\n  - `rating`: Hotel rating (1-5)\n  - `totalReviews`: Number of reviews\n- `cached`: Boolean - true if from cache\n- `fallbackUsed`: Boolean - true if using placeholder images\n- `message`: User-friendly message about image source\n\n**üí° Usage Tips:**\n1. **For Hotel Listings:** Lazy load images when card enters viewport\n2. **For Hotel Details Page:** Fetch images immediately on page load\n3. **Cache Strategy:** Frontend can cache image URLs for 24 hours\n4. **Error Handling:** Not needed - endpoint always returns success\n5. **Attribution:** Display \"Powered by Google\" if `source === \"google_places\"`\n\n**üîó Related Endpoints:**\n- `POST /api/v1/bookings/search/hotels/amadeus` - Get hotelId and hotelName\n- `GET /api/v1/bookings/hotels/accommodation/:accommodationId` - Get Duffel hotel details (may include images)\n\n**‚ö†Ô∏è Important Notes:**\n- **Always returns images** - never returns empty array (unless last resort)\n- **Never crashes** - all errors handled gracefully\n- **Works without Google Places API** - uses fallback images\n- **Caching:** Images cached for 60 days, then auto-deleted\n- **Rate Limiting:** Automatically falls back when Google Places limit reached\n- **Cost Control:** Free tier limits enforced, circuit breaker at 90%\n\n**üéØ Complete Flow Example:**\n```\n1. Search Hotels:\n   POST /api/v1/bookings/search/hotels/amadeus\n   ‚Üí Get: hotelId=\"MCLONGHM\", hotelName=\"JW Marriott...\"\n\n2. Get Hotel Images:\n   GET /api/v1/bookings/hotels/MCLONGHM/images?hotelName=JW+Marriott+...\n   ‚Üí Get: images array with URLs\n\n3. Display Hotel Details Page:\n   ‚Üí Combine search data + images\n   ‚Üí Show full gallery, hotel info, pricing\n```"
							},
							"response": []
						},
						{
							"name": "Search Hotel Suggestions (List Hotels by Region)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"keyword\": \"London\",\n  \"subType\": \"HOTEL_GD\",\n  \"countryCode\": \"GB\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/accommodation/suggestions",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"accommodation",
										"suggestions"
									]
								},
								"description": "**Search for hotel suggestions (autocomplete) - List hotels available per region**\n\n**No authentication required.**\n\n**What This Does:**\n- Provides hotel suggestions/autocomplete similar to flight place suggestions\n- Searches for hotels by keyword (city name, hotel name, etc.) using Amadeus Hotel Name Search API\n- Returns list of hotels available in the specified region\n- Uses Amadeus Hotel List API to find hotels by location\n\n**Request Body:**\n```json\n{\n  \"keyword\": \"London\",\n  \"subType\": \"HOTEL_GD\",\n  \"countryCode\": \"GB\"\n}\n```\n\n**Required Parameters:**\n- `keyword` (string, required, min 3 characters): Search keyword (city name, hotel name, etc.)\n  - Examples: \"London\", \"Marriott\", \"Paris\", \"New York\"\n\n**Optional Parameters:**\n- `subType` (string, optional): Hotel subtype filter (e.g., \"HOTEL_GD\")\n- `countryCode` (string, optional): ISO country code (e.g., \"GB\", \"US\", \"FR\")\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": [\n    {\n      \"type\": \"hotel\",\n      \"hotelId\": \"MCLONGHM\",\n      \"name\": \"JW Marriott Grosvenor House London\",\n      \"cityCode\": \"LON\",\n      \"iataCode\": \"LHR\",\n      \"geoCode\": {\n        \"latitude\": 51.5071,\n        \"longitude\": -0.1416\n      }\n    }\n  ],\n  \"message\": \"Hotel suggestions retrieved successfully\"\n}\n```\n\n**Use Case:**\n- Hotel search autocomplete\n- List hotels available in a region\n- Find hotels by name or location\n\n**Note:**\n- This endpoint uses Amadeus Hotel Name Search API (`/v1/reference-data/locations/hotel`)\n- Returns hotels that can be used in hotel search\n- Hotel IDs from this endpoint can be used in `POST /api/v1/bookings/search/hotels/amadeus` with `hotelIds` parameter\n- Minimum 3 characters required for keyword"
							},
							"response": []
						},
						{
							"name": "Get Hotel Images Usage Stats (Admin Only)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/bookings/hotels/images/usage-stats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"bookings",
										"hotels",
										"images",
										"usage-stats"
									]
								},
								"description": "**Get Google Places API and Cloudinary usage statistics (Admin Only)**\n\n**Admin authentication required.**\n\n**üéØ What This Does:**\n- Returns current month usage for Google Places API requests\n- Returns Cloudinary storage and bandwidth usage\n- Helps monitor costs and free tier limits\n- Shows circuit breaker status (if limits reached)\n\n**‚úÖ Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"googlePlaces\": {\n      \"currentValue\": 150,\n      \"limitValue\": 1000,\n      \"isLimitReached\": false,\n      \"percentageUsed\": 15.0\n    },\n    \"cloudinaryStorage\": {\n      \"currentValue\": 0.5,\n      \"limitValue\": 25.0,\n      \"isLimitReached\": false,\n      \"percentageUsed\": 2.0\n    },\n    \"cloudinaryBandwidth\": {\n      \"currentValue\": 2.3,\n      \"limitValue\": 25.0,\n      \"isLimitReached\": false,\n      \"percentageUsed\": 9.2\n    }\n  }\n}\n```\n\n**üìä Response Fields:**\n- `googlePlaces`: Google Places API usage\n  - `currentValue`: Current requests this month\n  - `limitValue`: Free tier limit (default: 1000)\n  - `isLimitReached`: Circuit breaker status (true if ‚â•90% used)\n  - `percentageUsed`: Percentage of limit used\n- `cloudinaryStorage`: Cloudinary storage usage (GB)\n- `cloudinaryBandwidth`: Cloudinary bandwidth usage (GB)\n\n**üí° Usage Tips:**\n- Check monthly to monitor API costs\n- Circuit breaker activates at 90% of free tier limit\n- Usage resets automatically on 1st of each month\n- If `isLimitReached: true`, images endpoint uses fallback only\n\n**‚ö†Ô∏è Important:**\n- Only admins can access this endpoint\n- Usage tracking prevents exceeding free tier limits\n- Circuit breaker stops API calls when limit approached"
							},
							"response": []
						}
					]
				}
			],
			"description": "**Hotel booking endpoints - Organized by provider**\n\n**üìÅ Folder Structure:**\n1. **Hotels - Amadeus (Recommended)** - Complete Amadeus hotel booking flow\n2. **Hotels - Duffel** - Duffel Stays API endpoints\n3. **Hotels - Common Operations** - Shared endpoints (List, Get, Cancel, Images)\n\n**üéØ Quick Start:**\n- **For Amadeus**: See \"Hotels - Amadeus (Recommended)\" folder for complete flow\n- **For Duffel**: See \"Hotels - Duffel\" folder (requires account access)\n- **Common Operations**: Works for both providers\n\n**üñºÔ∏è Hotel Images Flow:**\n1. **Search Hotels** ‚Üí Get `hotelId` and `hotelName`\n2. **Get Hotel Images** ‚Üí `GET /api/v1/bookings/hotels/:hotelId/images?hotelName=...`\n3. **Display** ‚Üí Show images in hotel cards or details page\n\n**üí° Recommendation:**\n- Use **Amadeus** for hotel bookings (free quota, better test data, more features)\n- Use **Duffel** only if you have Duffel Stays access enabled\n- **Hotel Images** endpoint works for both Amadeus and Duffel hotels\n\n**üîê Security:**\n- Card details encrypted with AES-256-GCM\n- Admin-only cancellations\n- Secure payment flow with Stripe\n\n**üõ°Ô∏è Image Fallback:**\n- Hotel images endpoint **never crashes**\n- Automatically falls back to placeholder images if Google Places unavailable\n- Works perfectly without Google Places API key\n- Always returns images (Google Places or fallback)"
		},
		{
			"name": "Flight Utilities",
			"item": [
				{
					"name": "Search Place Suggestions (Airports/Cities)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/flights/places/suggestions?query=london",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"flights",
								"places",
								"suggestions"
							],
							"query": [
								{
									"key": "query",
									"value": "london",
									"description": "Search query (min 3 characters)"
								},
								{
									"key": "lat",
									"value": "",
									"description": "Latitude for location-based search",
									"disabled": true
								},
								{
									"key": "lng",
									"value": "",
									"description": "Longitude for location-based search",
									"disabled": true
								},
								{
									"key": "rad",
									"value": "",
									"description": "Radius in metres",
									"disabled": true
								}
							]
						},
						"description": "**Search for airport/city suggestions (autocomplete)**\n\n**No authentication required.**\n\n**What This Does:**\n- Provides autocomplete suggestions for flight search origin/destination\n- Searches by airport name, city name, or IATA code\n- Optional location-based filtering\n\n**Query Parameters:**\n- `query` (string, required): Search query (minimum 3 characters)\n  - Examples: \"london\", \"LHR\", \"heathrow\", \"JFK\"\n- `lat` (number, optional): Latitude for location-based search (-90 to 90)\n- `lng` (number, optional): Longitude for location-based search (-180 to 180)\n- `rad` (number, optional): Search radius in metres\n\n**Response:**\n- Returns airports and cities matching the query\n- Includes IATA codes, names, coordinates\n- Use for origin/destination autocomplete in flight search\n\n**Examples:**\n- `?query=london` - Find all London airports/cities\n- `?query=LHR` - Find Heathrow airport\n- `?query=heathrow&lat=51.5071&lng=-0.1416&rad=10000` - Location-based search"
					},
					"response": []
				},
				{
					"name": "List Airlines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/flights/airlines?limit=50",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"flights",
								"airlines"
							],
							"query": [
								{
									"key": "limit",
									"value": "50",
									"description": "Items per page (1-200, default: 50)"
								},
								{
									"key": "after",
									"value": "",
									"description": "Pagination cursor",
									"disabled": true
								},
								{
									"key": "before",
									"value": "",
									"description": "Previous page cursor",
									"disabled": true
								}
							]
						},
						"description": "**List all airlines**\n\n**No authentication required.**\n\n**What This Does:**\n- Returns paginated list of all airlines\n- Includes airline name, IATA code, logo URLs\n- Useful for displaying airline information in flight results\n\n**Query Parameters:**\n- `limit` (number, optional): Items per page (1-200, default: 50)\n- `after` (string, optional): Cursor for next page\n- `before` (string, optional): Cursor for previous page\n\n**Response:**\n- Returns airlines with:\n  - `name`: Airline name (e.g., \"British Airways\")\n  - `iata_code`: IATA code (e.g., \"BA\")\n  - `logo_symbol_url`: Logo URL\n  - `logo_lockup_url`: Full logo URL\n  - `id`: Duffel airline ID\n\n**Use Case:**\n- Display airline logos in flight results\n- Show airline names\n- Filter flights by airline"
					},
					"response": []
				}
			],
			"description": "Utility endpoints for flight search.\n\n**Place Suggestions:**\n- Autocomplete for origin/destination fields\n- Search by airport name, city name, or IATA code\n- Optional location-based filtering\n- Minimum 3 characters required\n\n**List Airlines:**\n- Get all airlines with logos and IATA codes\n- Paginated results\n- Use for displaying airline information in flight results"
		},
		{
			"name": "Car Rentals",
			"item": [
				{
					"name": "Search Car Rentals",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('data');",
									"    ",
									"    if (response.data && response.data.data && response.data.data.length > 0) {",
									"        const firstOffer = response.data.data[0];",
									"        if (firstOffer.id) {",
									"            pm.environment.set('carOfferId', firstOffer.id);",
									"            console.log('‚úÖ Car rental offer ID saved:', firstOffer.id);",
									"        }",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocationCode\": \"LHR\",\n  \"pickupDateTime\": \"2026-03-15T10:00:00\",\n  \"dropoffLocationCode\": \"CDG\",\n  \"dropoffDateTime\": \"2026-03-18T10:00:00\",\n  \"currency\": \"GBP\",\n  \"passengers\": 2\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/search/car-rentals",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"search",
								"car-rentals"
							]
						},
						"description": "**Search for car rental/transfer options using Amadeus API**\n\n**No authentication required.**\n\n**What This Does:**\n- Searches for car rental and transfer options using Amadeus Transfers API\n- Returns available vehicles with pricing, features, and policies\n- Applies currency conversion and markup automatically\n- Supports filtering by vehicle type, location, and dates\n\n**Request Body Examples:**\n\n**Example 1: Same Location Return (Round Trip)**\n```json\n{\n  \"pickupLocationCode\": \"LHR\",\n  \"pickupDateTime\": \"2026-06-04T10:00:00\",\n  \"dropoffLocationCode\": \"LHR\",\n  \"dropoffDateTime\": \"2026-06-07T10:00:00\",\n  \"currency\": \"GBP\"\n}\n```\n*Note: You can omit `dropoffLocationCode` and `dropoffDateTime` for same location return*\n\n**Example 2: One-Way Rental (Different Dropoff Location)**\n```json\n{\n  \"pickupLocationCode\": \"LHR\",\n  \"pickupDateTime\": \"2026-06-04T10:00:00\",\n  \"dropoffLocationCode\": \"CDG\",\n  \"dropoffDateTime\": \"2026-06-07T10:00:00\",\n  \"currency\": \"GBP\"\n}\n```\n*Pick up in London, drop off in Paris - perfect for one-way trips!*\n\n**Example 3: Minimal Request (Defaults to Same Location)**\n```json\n{\n  \"pickupLocationCode\": \"JFK\",\n  \"pickupDateTime\": \"2026-03-15T10:00:00\",\n  \"currency\": \"USD\"\n}\n```\n*Dropoff defaults to pickup location, dropoff date defaults to pickup + 1 day*\n\n**Required Parameters:**\n- `pickupLocationCode` (string, required): Airport IATA code or city code for pickup (e.g., \"LHR\", \"LON\", \"JFK\")\n- `pickupDateTime` (string, required): Pickup date and time (ISO 8601 format: YYYY-MM-DDTHH:mm:ss, no timezone)\n  - Example: `2026-03-15T10:00:00`\n  - **Important:** Must be in the future, and dates are preserved as-is (no timezone conversion)\n\n**Optional Parameters:**\n- `dropoffLocationCode` (string, optional): Airport IATA code or city code for dropoff. **If not provided, defaults to pickup location** (same location return). **You CAN use a different location for one-way rentals!**\n- `dropoffDateTime` (string, optional): Dropoff date and time (ISO 8601 format). If not provided, defaults to pickup + 1 day\n  - **‚ö†Ô∏è Minimum Duration:** Dropoff must be at least **4 hours** after pickup time\n  - Example: If pickup is `2026-03-15T10:00:00`, dropoff must be at least `2026-03-15T14:00:00` or later\n\n**Optional Parameters:**\n- `currency` (string, optional): Currency code (default: GBP). Supported: GBP, USD, EUR, NGN, etc.\n- `vehicleTypes` (array, optional): Filter by vehicle types (e.g., [\"SEDAN\", \"SUV\", \"VAN\"])\n- `passengers` (number, optional): Number of passengers (1-9, default: 1)\n- `luggage` (number, optional): Number of luggage pieces (0-9, default: 0)\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"data\": [\n      {\n        \"id\": \"offer-id-123\",\n        \"type\": \"transfer-offer\",\n        \"vehicle\": {\n          \"type\": \"SEDAN\",\n          \"name\": \"Standard Sedan\",\n          \"passengers\": 4,\n          \"luggage\": 2\n        },\n        \"price\": {\n          \"currency\": \"GBP\",\n          \"base\": \"150.00\",\n          \"total\": \"165.00\",\n          \"final_price\": \"172.50\"\n        },\n        \"pickup\": {\n          \"locationCode\": \"LHR\",\n          \"dateTime\": \"2026-06-04T10:00:00\"\n        },\n        \"dropoff\": {\n          \"locationCode\": \"LHR\",\n          \"dateTime\": \"2026-06-07T10:00:00\"\n        },\n        \"policies\": { ... },\n        \"markup_percentage\": 10,\n        \"markup_amount\": \"15.00\",\n        \"service_fee\": \"7.50\"\n      }\n    ],\n    \"meta\": {\n      \"count\": 10,\n      \"total\": 10\n    },\n    \"currency\": \"GBP\"\n  },\n  \"message\": \"Car rentals retrieved successfully\"\n}\n```\n\n**Price Breakdown:**\n- `base`: Base price from Amadeus\n- `total`: Base + conversion fees\n- `final_price`: Total price customer pays (base + markup + service fee)\n- `markup_percentage`: Business markup percentage\n- `markup_amount`: Markup amount\n- `service_fee`: Fixed service fee\n\n**Tips:**\n- **One-Way Rentals**: You CAN use different pickup and dropoff locations! This is perfect for road trips (e.g., pick up in London, drop off in Paris)\n- **Same Location Return**: If you omit `dropoffLocationCode`, it defaults to pickup location (round trip)\n- Use airport IATA codes (LHR, JFK, CDG) for best results\n- Vehicle types: SEDAN, SUV, VAN, LUXURY, etc.\n- Prices include currency conversion and markup automatically\n- Save `offer.id` from response for booking creation\n\n**Common Use Cases:**\n- **Round Trip**: Pick up and drop off at same airport (e.g., LHR ‚Üí LHR)\n- **One-Way**: Pick up at one location, drop off at another (e.g., LHR ‚Üí CDG, JFK ‚Üí BOS)\n- **City to Airport**: Pick up in city, drop off at airport (e.g., LON ‚Üí LHR)\n- **Airport to City**: Pick up at airport, drop off in city (e.g., LHR ‚Üí LON)\n\n**‚ö†Ô∏è Important Requirements:**\n- **Minimum Rental Duration:** Dropoff must be at least **4 hours** after pickup time\n- **Date Format:** Use ISO 8601 format without timezone: `YYYY-MM-DDTHH:mm:ss` (e.g., `2026-03-15T10:00:00`)\n- **Future Dates Only:** Pickup date must be in the future (not in the past)\n- **‚ö†Ô∏è TEST ENVIRONMENT LIMITATION:** Amadeus test environment typically only supports dates within **1-7 days** from today. Dates further in the future may return \"INVALID PICKUP DATE\" error. **Use dates like tomorrow or within the next week for testing.**\n- **Production Date Range:** Production environment supports dates up to 12 months in the future\n\n**‚ö†Ô∏è Troubleshooting Empty Results:**\nIf you get empty results (`data: []`) or \"INVALID PICKUP DATE\" errors:\n1. **‚ö†Ô∏è MOST COMMON ISSUE - Date Too Far Ahead:** Amadeus test environment typically only supports dates within **1-7 days** from today. If you get \"INVALID PICKUP DATE\", try a date much closer (e.g., tomorrow or within the next week)\n2. **Check rental duration**: Ensure dropoff is at least 4 hours after pickup\n3. **Try major airports**: JFK (New York), CDG (Paris), LHR (London), FRA (Frankfurt)\n4. **Check date format**: Use `YYYY-MM-DDTHH:mm:ss` format (no timezone)\n5. **Check server logs**: The backend logs the full Amadeus API response and request body for debugging\n6. **Try different dates**: Some dates may not have available transfers\n7. **Verify location codes**: Use official IATA airport codes (3 letters)\n\n**Common Errors:**\n- `INVALID PICKUP DATE` (code 32698): **Most likely cause:** Date is too far in the future. Test environment typically only supports 1-7 days ahead. Try tomorrow's date or within the next week.\n- Empty results: Test environment has limited data - try different airports/dates within 1-7 days\n\n**Recommended Test Dates:**\n- Tomorrow: `2026-02-07T10:00:00` (if today is Feb 6)\n- 3 days ahead: `2026-02-09T10:00:00`\n- 7 days ahead: `2026-02-13T10:00:00`\n\n**Avoid:** Dates more than 7 days ahead in test environment\n\n**Note:** The Amadeus test environment has limited transfer/car rental data. Production environment will have more comprehensive results."
					},
					"response": []
				},
				{
					"name": "Create Car Rental Booking",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    pm.expect(response).to.have.property('data');",
									"    ",
									"    if (response.data && response.data.booking && response.data.booking.id) {",
									"        pm.environment.set('carBookingId', response.data.booking.id);",
									"        pm.environment.set('bookingId', response.data.booking.id);",
									"        console.log('‚úÖ Car rental booking ID saved:', response.data.booking.id);",
									"        console.log('üí° Use this booking ID to create payment intent');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{carOfferId}}\",\n  \"pickupLocationCode\": \"LHR\",\n  \"pickupDateTime\": \"2026-06-04T10:00:00\",\n  \"dropoffLocationCode\": \"LHR\",\n  \"dropoffDateTime\": \"2026-06-07T10:00:00\",\n  \"passengerInfo\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"phone\": \"+1234567890\"\n  },\n  \"specialRequests\": \"Child seat required\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/car-rentals/bookings",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"car-rentals",
								"bookings"
							]
						},
						"description": "**Create a car rental booking**\n\n**Authentication required.**\n\n**What This Does:**\n- Creates a local booking for a car rental/transfer offer\n- Stores booking details and passenger information\n- Booking status: `PENDING` (waiting for payment)\n- After payment succeeds, the actual Amadeus transfer order will be created automatically\n\n**Request Body:**\n```json\n{\n  \"offerId\": \"offer-id-from-search\",\n  \"pickupLocationCode\": \"LHR\",\n  \"pickupDateTime\": \"2026-06-04T10:00:00\",\n  \"dropoffLocationCode\": \"LHR\",\n  \"dropoffDateTime\": \"2026-06-07T10:00:00\",\n  \"passengerInfo\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"phone\": \"+1234567890\"\n  },\n  \"specialRequests\": \"Child seat required\"\n}\n```\n\n**Required Parameters:**\n- `offerId` (string, required): Offer ID from car rental search results\n- `pickupLocationCode` (string, required): Pickup location code\n- `pickupDateTime` (string, required): Pickup date and time (ISO 8601)\n- `dropoffLocationCode` (string, required): Dropoff location code\n- `dropoffDateTime` (string, required): Dropoff date and time (ISO 8601)\n- `passengerInfo` (object, required): Passenger details\n  - `firstName` (string, required)\n  - `lastName` (string, required)\n  - `email` (string, required)\n  - `phone` (string, required)\n\n**Optional Parameters:**\n- `specialRequests` (string, optional): Special requests or notes\n\n**Response:**\n- Returns booking object with `id`\n- Booking status: `PENDING`\n- **Next Step:** Create payment intent using booking ID\n\n**Complete Flow:**\n1. **Search Car Rentals** ‚Üí Get `offerId`\n2. **Create Car Rental Booking** ‚Üí Get `bookingId`\n3. **Create Payment Intent** ‚Üí Get `clientSecret`\n4. **Complete Payment** ‚Üí Stripe webhook automatically creates Amadeus transfer order\n5. **Get Booking** ‚Üí View confirmed booking details"
					},
					"response": []
				},
				{
					"name": "Cancel Car Rental Booking (Admin Only)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('success', true);",
									"    console.log('‚úÖ Car rental booking cancelled successfully');",
									"} else if (pm.response.code === 403) {",
									"    console.error('‚ùå Access denied. Only administrators can cancel car rental bookings.');",
									"    console.log('üí° Tip: Use an admin account token');",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/bookings/car-rentals/bookings/:bookingId/cancel",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"bookings",
								"car-rentals",
								"bookings",
								":bookingId",
								"cancel"
							],
							"variable": [
								{
									"key": "bookingId",
									"value": "{{carBookingId}}",
									"description": "Car rental booking ID to cancel"
								}
							]
						},
						"description": "**Cancel a car rental booking (Admin Only)**\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Admin Only:** Only administrators (ADMIN, SUPER_ADMIN) can cancel bookings\n- **Time Restriction:** Cancellations may be subject to provider policies\n- **After Departure:** Cannot cancel after pickup time has passed\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Requirements:**\n- Booking must be a car rental booking (`productType: CAR_RENTAL`)\n- Booking must be in `CONFIRMED` status\n- User must have ADMIN or SUPER_ADMIN role\n- Pickup must not have occurred yet\n\n**Process:**\n1. Validates cancellation restrictions\n2. Cancels transfer order in Amadeus\n3. Updates booking status to `CANCELLED`\n4. Processes refund if applicable\n5. Sends cancellation email to customer\n\n**URL Parameters:**\n- `bookingId` (string, required): Car rental booking ID to cancel\n\n**Response:**\n- Returns cancellation confirmation\n- Booking status updated to `CANCELLED`\n- Refund status updated if applicable\n\n**Error Responses:**\n- `403 Forbidden` - Not an admin user\n- `404 Not Found` - Booking not found\n- `400 Bad Request` - Booking cannot be cancelled (already cancelled, pickup passed, etc.)\n\n**Note:**\n- Only admins can cancel car rental bookings\n- Cancellation policies depend on Amadeus provider\n- Refunds processed according to provider cancellation policy"
					},
					"response": []
				}
			],
			"description": "**Car rental/transfer booking endpoints using Amadeus Transfers API**\n\n**üìã Complete Car Rental Booking Flow:**\n\n**Step 1: Search Car Rentals**\n`POST /api/v1/bookings/search/car-rentals`\n- Search by pickup/dropoff locations and dates\n- Returns available vehicles with pricing\n- **Save `offer.id` from response** (used in Step 2)\n\n**Step 2: Create Booking**\n`POST /api/v1/bookings/car-rentals/bookings`\n- Use `offer.id` from Step 1 as `offerId`\n- Provide passenger details\n- **Returns `booking.id`** (used in Step 3)\n- Booking status: `PENDING` (waiting for payment)\n\n**Step 3: Create Payment Intent**\n`POST /api/v1/payments/stripe/create-intent`\n- Use `booking.id` from Step 2\n- Returns `clientSecret` for Stripe Checkout\n\n**Step 4: Complete Payment**\n- Frontend: Use Stripe.js with `clientSecret`\n- User completes payment via Stripe\n\n**Step 5: Automatic Amadeus Transfer Order (Webhook)**\n- After payment success, Stripe webhook triggers\n- System automatically creates Amadeus transfer order\n- Booking status updates to `CONFIRMED`\n\n**Step 6: Cancel Booking (Admin Only)**\n`POST /api/v1/bookings/car-rentals/bookings/:bookingId/cancel`\n- Admin-only cancellation\n- Cancels in Amadeus system\n- Updates local database\n\n**üîê Security:**\n- Admin-only cancellations\n- Secure payment flow with Stripe\n- Booking data encrypted\n\n**üí° Tips:**\n- **One-Way Rentals Supported**: Pick up at one location, drop off at another (e.g., LHR ‚Üí CDG)\n- **Round Trip**: Omit `dropoffLocationCode` to return to pickup location\n- Use airport IATA codes for best results (LHR, JFK, CDG, etc.)\n- Vehicle types: SEDAN, SUV, VAN, LUXURY\n- Prices include currency conversion and markup automatically\n\n**Example Scenarios:**\n- **Round Trip**: LHR ‚Üí LHR (same location)\n- **One-Way**: LHR ‚Üí CDG (London to Paris)\n- **City Transfer**: LON ‚Üí LHR (city to airport)"
		},
		{
			"name": "Admin",
			"item": [
				{
					"name": "Admin Auth",
					"description": "**Protected admin-only auth.** Use these routes for all admin sign-in and sign-out. Only ADMIN/SUPER_ADMIN can obtain a token from Admin Login; customers get 403. Admin Logout requires a valid admin JWT.",
					"item": [
						{
							"name": "Admin Login",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 200) {",
											"    const response = pm.response.json();",
											"    if (response.token) {",
											"        pm.environment.set('token', response.token);",
											"        pm.environment.set('userId', response.user.id);",
											"        console.log('Admin token saved');",
											"    }",
											"}",
											"pm.test('Status code is 200', function () { pm.response.to.have.status(200); });",
											"if (pm.response.code === 403) pm.test('Forbidden - not an admin', function () { pm.response.to.have.status(403); });"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"email\": \"admin@example.com\",\n  \"password\": \"your-admin-password\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/auth/login",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"auth",
										"login"
									]
								}
							},
							"response": [],
							"description": "**Protected admin login.** No auth header. Only users with role ADMIN or SUPER_ADMIN can get a token; customers receive 403 Forbidden. Rate limit: 5/min.\n\n**Body:** `email`, `password`\n\n**200:** `{ user, token }` (token saved to {{token}})\n\n**401:** Invalid credentials\n**403:** Only administrators can sign in here\n**429:** Too many requests"
						},
						{
							"name": "Admin Logout",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Status code is 200', function () { pm.response.to.have.status(200); });",
											"if (pm.response.code === 200) pm.expect(pm.response.json()).to.have.property('success', true);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/auth/logout",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"auth",
										"logout"
									]
								}
							},
							"response": [],
							"description": "**Admin logout.** Requires Bearer token (admin JWT). Use after Admin Login to sign out. Client should remove token from storage."
						}
					]
				},
				{
					"name": "User Management",
					"item": [
						{
							"name": "Create Admin User (Super Admin Only)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Status code is 201', function () {",
											"    pm.response.to.have.status(201);",
											"});",
											"",
											"if (pm.response.code === 201) {",
											"    const response = pm.response.json();",
											"    pm.expect(response).to.have.property('success', true);",
											"    if (response.data && response.data.id) {",
											"        pm.environment.set('adminUserId', response.data.id);",
											"        console.log('‚úÖ Admin user created:', response.data.email);",
											"    }",
											"} else if (pm.response.code === 403) {",
											"    console.error('‚ùå Access denied. Only Super Admin can create admin users.');",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"email\": \"admin@example.com\",\n  \"name\": \"Admin User\",\n  \"password\": \"SecurePassword123!\",\n  \"role\": \"ADMIN\",\n  \"phone\": \"+1234567890\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/users",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"users"
									]
								},
								"description": "**Create a new admin user (Super Admin only)**\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Super Admin Only:** Only SUPER_ADMIN users can create admin users\n- **Role Validation:** Can only create ADMIN or SUPER_ADMIN roles\n- **Super Admin Creation:** Only SUPER_ADMIN can create other SUPER_ADMIN users\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**Request Body:**\n```json\n{\n  \"email\": \"admin@example.com\",\n  \"name\": \"Admin User\",\n  \"password\": \"SecurePassword123!\",\n  \"role\": \"ADMIN\",\n  \"phone\": \"+1234567890\"\n}\n```\n\n**Required Parameters:**\n- `email` (string, required): Email (must be unique)\n- `name` (string, required): Full name\n- `password` (string, required): Password (min 6 characters)\n- `role` (string, required): `CUSTOMER` | `ADMIN` | `SUPER_ADMIN`\n  - SUPER_ADMIN can create any role; ADMIN can create only CUSTOMER (onboard customer).\n- `phone` (string, optional): Phone number\n\n**Response:**\n- Returns created admin user object (without password)\n- Action logged in audit log\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user\n- `400 Bad Request` - Email already exists\n- `400 Bad Request` - Invalid role (must be ADMIN or SUPER_ADMIN)\n- `400 Bad Request` - Only Super Admin can create Super Admin users\n\n**Note:**\n- Password is hashed before storage\n- Admin creation is logged in audit log\n- Regular ADMIN users cannot create other admins (only SUPER_ADMIN can)"
							},
							"response": []
						},
						{
							"name": "List Admin Users (Super Admin Only)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/users?role=ADMIN&page=1&limit=20",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"users"
									],
									"query": [
										{
											"key": "role",
											"value": "ADMIN",
											"description": "Filter by role (ADMIN or SUPER_ADMIN)",
											"disabled": true
										},
										{
											"key": "page",
											"value": "1",
											"description": "Page number (default: 1)"
										},
										{
											"key": "limit",
											"value": "20",
											"description": "Per page (default: 20, max: 100)"
										}
									]
								},
								"description": "**List all admin users (Super Admin only)**\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**Query Parameters:**\n- `role` (string, optional): Filter by role - `ADMIN` or `SUPER_ADMIN`\n- `page` (number, optional): Page number (default: 1)\n- `limit` (number, optional): Per page (default: 20, max: 100)\n\n**Response:**\n- Returns paginated list: data (array), meta: { total, page, limit, totalPages }\n- Excludes deleted users\n- Ordered by creation date (newest first)\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"user-id\",\n      \"email\": \"admin@example.com\",\n      \"name\": \"Admin User\",\n      \"role\": \"ADMIN\",\n      \"phone\": \"+1234567890\",\n      \"image\": null,\n      \"createdAt\": \"2026-02-05T10:00:00.000Z\",\n      \"updatedAt\": \"2026-02-05T10:00:00.000Z\"\n    }\n  ],\n  \"message\": \"Admin users retrieved successfully\"\n}\n```\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user"
							},
							"response": []
						},
						{
							"name": "Get Admin User by ID (Super Admin Only)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/users/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"users",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "{{adminUserId}}",
											"description": "Admin user ID"
										}
									]
								},
								"description": "**Get admin user details by ID (Super Admin only)**\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**URL Parameters:**\n- `id` (string, required): Admin user ID\n\n**Response:**\n- Returns admin user details including permissions\n- Excludes password\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user\n- `404 Not Found` - Admin user not found"
							},
							"response": []
						},
						{
							"name": "Update Admin User (Super Admin Only)",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"Updated Admin Name\",\n  \"phone\": \"+9876543210\",\n  \"role\": \"ADMIN\",\n  \"permissions\": {\n    \"canManageBookings\": true,\n    \"canManageUsers\": false,\n    \"canManageMarkups\": true,\n    \"canViewReports\": true,\n    \"canCancelBookings\": true,\n    \"canViewAllBookings\": true\n  }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/users/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"users",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "{{adminUserId}}",
											"description": "Admin user ID to update"
										}
									]
								},
								"description": "**Update admin user (Super Admin only)**\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**Request Body (all fields optional):**\n```json\n{\n  \"name\": \"Updated Admin Name\",\n  \"phone\": \"+9876543210\",\n  \"role\": \"ADMIN\",\n  \"permissions\": {\n    \"canManageBookings\": true,\n    \"canManageUsers\": false,\n    \"canManageMarkups\": true,\n    \"canViewReports\": true,\n    \"canCancelBookings\": true,\n    \"canViewAllBookings\": true\n  }\n}\n```\n\n**Optional Parameters:**\n- `name` (string, optional): Updated name\n- `phone` (string, optional): Updated phone number\n- `role` (string, optional): Updated role (ADMIN or SUPER_ADMIN)\n- `permissions` (object, optional): Fine-grained permissions for regular admins\n  - `canManageBookings`: Can manage bookings\n  - `canManageUsers`: Can manage users\n  - `canManageMarkups`: Can manage markups\n  - `canViewReports`: Can view reports\n  - `canCancelBookings`: Can cancel bookings\n  - `canViewAllBookings`: Can view all bookings\n\n**Response:**\n- Returns updated admin user object\n- Action logged in audit log\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user\n- `404 Not Found` - Admin user not found\n\n**Note:**\n- Only SUPER_ADMIN can update admin users\n- Permissions are only applicable to regular ADMIN users (SUPER_ADMIN has all permissions)"
							},
							"response": []
						},
						{
							"name": "Delete Admin User (Super Admin Only)",
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/users/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"users",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "{{adminUserId}}",
											"description": "Admin user ID to delete"
										}
									]
								},
								"description": "**Delete (soft delete) admin user (Super Admin only)**\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**URL Parameters:**\n- `id` (string, required): Admin user ID to delete\n\n**Response:**\n- Returns success message\n- User is soft deleted (marked as deleted, not removed from database)\n- Action logged in audit log\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user\n- `404 Not Found` - Admin user not found\n\n**Note:**\n- Soft delete: User is marked as deleted but data is preserved\n- Deleted users cannot log in\n- Only SUPER_ADMIN can delete admin users"
							},
							"response": []
						},
						{
							"name": "Assign Permissions to Admin (Super Admin Only)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"permissions\": {\n    \"canManageBookings\": true,\n    \"canManageUsers\": false,\n    \"canManageMarkups\": true,\n    \"canViewReports\": true,\n    \"canCancelBookings\": true,\n    \"canViewAllBookings\": true\n  }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/users/:id/permissions",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"users",
										":id",
										"permissions"
									],
									"variable": [
										{
											"key": "id",
											"value": "{{adminUserId}}",
											"description": "Admin user ID"
										}
									]
								},
								"description": "**Assign permissions to admin user (Super Admin only)**\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**Request Body:**\n```json\n{\n  \"permissions\": {\n    \"canManageBookings\": true,\n    \"canManageUsers\": false,\n    \"canManageMarkups\": true,\n    \"canViewReports\": true,\n    \"canCancelBookings\": true,\n    \"canViewAllBookings\": true\n  }\n}\n```\n\n**Permissions Object:**\n- `canManageBookings` (boolean): Can manage bookings\n- `canManageUsers` (boolean): Can manage users\n- `canManageMarkups` (boolean): Can manage markups\n- `canViewReports` (boolean): Can view reports\n- `canCancelBookings` (boolean): Can cancel bookings\n- `canViewAllBookings` (boolean): Can view all bookings\n\n**Response:**\n- Returns updated admin user with new permissions\n- Action logged in audit log\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user\n- `404 Not Found` - Admin user not found\n\n**Note:**\n- Permissions are only applicable to regular ADMIN users\n- SUPER_ADMIN has all permissions by default\n- Use this endpoint to grant/revoke specific permissions to regular admins"
							},
							"response": []
						}
					],
					"description": "**Admin user management endpoints (Super Admin only)**\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Super Admin Only:** All endpoints require SUPER_ADMIN role\n- **Admin Creation:** Only SUPER_ADMIN can create ADMIN or SUPER_ADMIN users\n- **Super Admin Creation:** Only SUPER_ADMIN can create other SUPER_ADMIN users\n\n**Endpoints:**\n- **Create Admin User** - Create new admin (ADMIN or SUPER_ADMIN)\n- **List Admin Users** - List all admin users (with optional role filter)\n- **Get Admin User** - Get admin user details by ID\n- **Update Admin User** - Update admin details, role, and permissions\n- **Delete Admin User** - Soft delete admin user\n- **Assign Permissions** - Assign fine-grained permissions to admin\n\n**Permissions System:**\n- Regular ADMIN users can have fine-grained permissions\n- SUPER_ADMIN has all permissions by default\n- Permissions control access to specific features:\n  - `canManageBookings`: Can manage bookings\n  - `canManageUsers`: Can manage users\n  - `canManageMarkups`: Can manage markups\n  - `canViewReports`: Can view reports\n  - `canCancelBookings`: Can cancel bookings\n  - `canViewAllBookings`: Can view all bookings\n\n**Audit Logging:**\n- All admin user management actions are logged\n- Includes who performed the action, what changed, and when"
				},
				{
					"name": "Booking Management",
					"item": [
						{
							"name": "Create Booking (On Behalf of Customer)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    const j = pm.response.json();",
											"    if (j.data && j.data.id) { pm.environment.set('bookingId', j.data.id); console.log('bookingId saved:', j.data.id); }",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"userId\": \"{{customerId}}\",\n  \"productType\": \"FLIGHT_DOMESTIC\",\n  \"provider\": \"DUFFEL\",\n  \"basePrice\": 150.50,\n  \"currency\": \"GBP\",\n  \"bookingData\": { \"offerId\": \"{{offerId}}\" },\n  \"passengerInfo\": {\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Doe\",\n    \"email\": \"jane@example.com\"\n  }\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/bookings",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"bookings"
									]
								}
							},
							"response": [],
							"description": "Create a booking for a customer (admin pays on behalf). Body: same as user CreateBookingDto **plus userId** (customer ID). After creation, use POST /payments/stripe/create-intent (flights) or charge-margin (Amadeus hotel/car) with this bookingId; backend uses booking.userId so payment is attributed to the customer. No pay-later flow."
						},
						{
							"name": "List All Bookings (Admin Only)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/bookings?page=1&limit=20",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"bookings"
									],
									"query": [
										{
											"key": "status",
											"value": "",
											"description": "PENDING, CONFIRMED, CANCELLED, FAILED",
											"disabled": true
										},
										{
											"key": "productType",
											"value": "",
											"description": "FLIGHT_DOMESTIC, HOTEL, CAR_RENTAL, etc.",
											"disabled": true
										},
										{
											"key": "provider",
											"value": "",
											"description": "DUFFEL, AMADEUS",
											"disabled": true
										},
										{
											"key": "userId",
											"value": "",
											"description": "Filter by user ID",
											"disabled": true
										},
										{
											"key": "startDate",
											"value": "",
											"description": "ISO date",
											"disabled": true
										},
										{
											"key": "endDate",
											"value": "",
											"description": "ISO date",
											"disabled": true
										},
										{
											"key": "page",
											"value": "1",
											"description": "Page number (default: 1)"
										},
										{
											"key": "limit",
											"value": "20",
											"description": "Per page (default: 50, max: 100)"
										}
									]
								},
								"description": "List all bookings. Response: `data` = array of bookings, `meta` = { total, page, limit, totalPages }. Pagination uses page/limit, not cursor."
							},
							"response": []
						},
						{
							"name": "Export Bookings CSV",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/bookings/export?status=&startDate=&endDate=",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"bookings",
										"export"
									],
									"query": [
										{
											"key": "status",
											"value": "",
											"disabled": true
										},
										{
											"key": "startDate",
											"value": "",
											"disabled": true
										},
										{
											"key": "endDate",
											"value": "",
											"disabled": true
										}
									]
								},
								"description": "Download bookings as CSV. Query: status?, startDate?, endDate?. Response: text/csv attachment."
							},
							"response": []
						},
						{
							"name": "Mark Refund Status",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"refundAmount\": 100.00,\n  \"refundStatus\": \"COMPLETED\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/bookings/{{bookingId}}/refund",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"bookings",
										"{{bookingId}}",
										"refund"
									]
								},
								"description": "After processing refund manually (Stripe/bank), update booking. Body: refundAmount?, refundStatus? (PENDING | PROCESSING | COMPLETED | FAILED). Only for CANCELLED/REFUNDED bookings."
							},
							"response": []
						},
						{
							"name": "Get Dispute Evidence",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/bookings/{{bookingId}}/dispute-evidence",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"bookings",
										"{{bookingId}}",
										"dispute-evidence"
									]
								},
								"description": "Get evidence pack for Stripe dispute/chargeback: charge ID, policy snapshot, IP, user agent, confirmation email log, Amadeus confirmation, etc."
							},
							"response": []
						}
					],
					"description": "Admin booking: create on behalf, list (page/limit), export CSV, mark refund, get dispute evidence."
				},
				{
					"name": "Customer Management",
					"item": [
						{
							"name": "List Customers",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/customers?status=all&page=1&limit=20&search=",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"customers"
									],
									"query": [
										{
											"key": "status",
											"value": "all",
											"description": "all | active | suspended"
										},
										{
											"key": "page",
											"value": "1"
										},
										{
											"key": "limit",
											"value": "20"
										},
										{
											"key": "search",
											"value": "",
											"description": "Search by name or email",
											"disabled": true
										}
									]
								},
								"description": "List customers. Response: data (id, email, name, registeredDate, bookingsCount, points, status), meta (total, page, limit, totalPages)."
							},
							"response": []
						},
						{
							"name": "Get Customer by ID",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/customers/{{customerId}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"customers",
										"{{customerId}}"
									]
								},
								"description": "Profile, loyalty summary, bookings count, internal notes, interaction history (last 50 bookings)."
							},
							"response": []
						},
						{
							"name": "Update Customer Notes",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"notes\": \"VIP customer, prefer window seat\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/customers/{{customerId}}/notes",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"customers",
										"{{customerId}}",
										"notes"
									]
								}
							},
							"response": []
						},
						{
							"name": "Suspend Customer",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"reason\": \"Policy violation\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/customers/{{customerId}}/suspend",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"customers",
										"{{customerId}}",
										"suspend"
									]
								},
								"description": "Customer cannot log in. Audit: SUSPEND_CUSTOMER."
							},
							"response": []
						},
						{
							"name": "Activate Customer",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/customers/{{customerId}}/activate",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"customers",
										"{{customerId}}",
										"activate"
									]
								},
								"description": "Reactivate suspended customer. Audit: ACTIVATE_CUSTOMER."
							},
							"response": []
						},
						{
							"name": "Send Reset Password Link (Customer)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/customers/{{customerId}}/reset-password-link",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"customers",
										"{{customerId}}",
										"reset-password-link"
									]
								},
								"description": "Sends password reset email to customer."
							},
							"response": []
						}
					],
					"description": "List/get customers, internal notes, suspend, activate, send reset-password link."
				},
				{
					"name": "Recent Activity",
					"item": [
						{
							"name": "Get Recent Activity",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/activity?type=&startDate=&endDate=&page=1&limit=20",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"activity"
									],
									"query": [
										{
											"key": "type",
											"value": "",
											"description": "booking | user_registration | coupon_used",
											"disabled": true
										},
										{
											"key": "startDate",
											"value": "",
											"disabled": true
										},
										{
											"key": "endDate",
											"value": "",
											"disabled": true
										},
										{
											"key": "page",
											"value": "1"
										},
										{
											"key": "limit",
											"value": "20"
										}
									]
								},
								"description": "Unified feed: new bookings, user registrations, coupon usage. Requires canViewReports (ADMIN); SUPER_ADMIN bypasses. Response: data (array of { type, date, description, entityId, entityType, meta }), meta (total, page, limit, totalPages)."
							},
							"response": []
						}
					],
					"description": "Recent activity feed for analytics/reports. Permission: canViewReports."
				},
				{
					"name": "Cancellation Requests",
					"item": [
						{
							"name": "List Pending Cancellation Requests",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/cancellation-requests",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"cancellation-requests"
									]
								}
							},
							"response": [],
							"description": "List pending after-deadline hotel cancellation requests. Shows booking, policy snapshot, deadline, refundability."
						},
						{
							"name": "Process Cancellation Request",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"action\": \"APPROVE_FULL_REFUND\",\n  \"refundAmount\": 200,\n  \"adminNotes\": \"Goodwill gesture\",\n  \"rejectionReason\": null\n}\n"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/cancellation-requests/{{cancellationRequestId}}/process",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"cancellation-requests",
										":id",
										"process"
									],
									"variable": [
										{
											"key": "id",
											"value": "{{cancellationRequestId}}"
										}
									]
								},
								"description": "Body: action (APPROVE_FULL_REFUND | APPROVE_PARTIAL_REFUND | REJECT), refundAmount?, adminNotes?, rejectionReason?. Cancels in Amadeus and refunds via Stripe when approving."
							},
							"response": []
						}
					],
					"description": "After-deadline hotel cancellation queue: list pending, process (approve/partial/reject)."
				},
				{
					"name": "Contact Submissions",
					"description": "Contact Us form submissions. List and update status (NEW, READ, REPLIED). Admin/Super Admin.",
					"item": [
						{
							"name": "List Contact Submissions",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/contact-submissions?page=1&limit=20",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"contact-submissions"
									],
									"query": [
										{
											"key": "status",
											"value": "",
											"description": "Filter: NEW, READ, REPLIED",
											"disabled": true
										},
										{
											"key": "page",
											"value": "1"
										},
										{
											"key": "limit",
											"value": "20"
										}
									]
								},
								"description": "**List Contact Us submissions (paginated).** Auth: Bearer token (Admin/Super Admin). Query: status (NEW | READ | REPLIED), page, limit. Returns submissions with id, name, email, phone, serviceInterestedIn, message, status, createdAt."
							},
							"response": []
						},
						{
							"name": "Update Contact Submission Status",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"status\": \"READ\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/contact-submissions/{{contactSubmissionId}}/status",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"contact-submissions",
										":id",
										"status"
									],
									"variable": [
										{
											"key": "id",
											"value": "{{contactSubmissionId}}"
										}
									]
								},
								"description": "**Update submission status.** Auth: Bearer. Body: { \"status\": \"NEW\" | \"READ\" | \"REPLIED\" }. Use contactSubmissionId from List or from Submit Contact Us (test script sets contactSubmissionId)."
							},
							"response": []
						}
					]
				},
				{
					"name": "Audit Logs",
					"item": [
						{
							"name": "Get Audit Logs (Super Admin Only)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/audit-logs?page=1&limit=50",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"audit-logs"
									],
									"query": [
										{
											"key": "userId",
											"value": "",
											"description": "Filter by user who performed action",
											"disabled": true
										},
										{
											"key": "action",
											"value": "",
											"description": "Filter by action type",
											"disabled": true
										},
										{
											"key": "page",
											"value": "1",
											"description": "Page number (default: 1)"
										},
										{
											"key": "limit",
											"value": "50",
											"description": "Per page (default: 50, max: 100)"
										}
									]
								},
								"description": "**Get audit logs (Super Admin only)**\n\n**Authentication required:** JWT Bearer token (Super Admin role)\n\n**What This Does:**\n- Returns audit log of all sensitive admin actions\n- Tracks who performed what action, when, and what changed\n- Includes IP address and user agent for security\n\n**Query Parameters (all optional):**\n- `action` (string): Filter by action type (e.g., \"CREATE_ADMIN_USER\", \"UPDATE_ADMIN_USER\", \"DELETE_ADMIN_USER\", \"CANCEL_BOOKING\")\n- `userId` (string): Filter by user ID who performed the action\n- `entityType` (string): Filter by entity type (User, Booking, etc.)\n- `startDate` (string): Filter logs from this date (ISO string)\n- `endDate` (string): Filter logs until this date (ISO string)\n- `limit` (number): Items per page (default: 50, max: 200)\n- `cursor` (string): Pagination cursor\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"logs\": [\n      {\n        \"id\": \"log-id\",\n        \"userId\": \"admin-user-id\",\n        \"user\": {\n          \"id\": \"admin-user-id\",\n          \"email\": \"admin@example.com\",\n          \"name\": \"Admin User\"\n        },\n        \"action\": \"CREATE_ADMIN_USER\",\n        \"entityType\": \"User\",\n        \"entityId\": \"created-user-id\",\n        \"changes\": {\n          \"email\": \"newadmin@example.com\",\n          \"role\": \"ADMIN\",\n          \"createdBy\": \"admin@example.com\"\n        },\n        \"ipAddress\": \"192.168.1.1\",\n        \"userAgent\": \"Mozilla/5.0...\",\n        \"createdAt\": \"2026-02-05T10:00:00.000Z\"\n      }\n    ],\n    \"meta\": {\n      \"count\": 50,\n      \"hasMore\": true,\n      \"nextCursor\": \"cursor-string\"\n    }\n  },\n  \"message\": \"Audit logs retrieved successfully\"\n}\n```\n\n**Tracked Actions:**\n- `CREATE_ADMIN_USER` - Admin user creation\n- `UPDATE_ADMIN_USER` - Admin user updates\n- `DELETE_ADMIN_USER` - Admin user deletion\n- `ASSIGN_PERMISSIONS` - Permission assignments\n- `CANCEL_BOOKING` - Booking cancellations\n- `CHANGE_PASSWORD` - Password changes\n- `DELETE_ACCOUNT` - Account deletions\n\n**Error Responses:**\n- `403 Forbidden` - Not a Super Admin user\n\n**Note:**\n- Only SUPER_ADMIN can view audit logs\n- Logs include IP address and user agent for security\n- All sensitive admin actions are automatically logged"
							},
							"response": []
						}
					],
					"description": "**Audit logging endpoints (Super Admin only)**\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Super Admin Only:** Only SUPER_ADMIN can view audit logs\n\n**What This Does:**\n- Tracks all sensitive admin actions\n- Includes who, what, when, and what changed\n- Includes IP address and user agent for security\n- Helps with compliance and security monitoring\n\n**Tracked Actions:**\n- Admin user management (create, update, delete)\n- Permission assignments\n- Booking cancellations\n- Password changes\n- Account deletions\n\n**Use Cases:**\n- Security monitoring\n- Compliance auditing\n- Troubleshooting\n- User activity tracking"
				},
				{
					"name": "Rewards Management",
					"item": [
						{
							"name": "Get Rewards Dashboard",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/dashboard",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"dashboard"
									]
								},
								"description": "**Get rewards system dashboard overview (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Response includes:**\n- Total active loyalty accounts\n- Total points issued / redeemed\n- Active reward rules count\n- Active vouchers count\n- Tier distribution\n- Recent loyalty activity"
							},
							"response": []
						},
						{
							"name": "Create Reward Rule",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"10% Flight Discount\",\n  \"description\": \"Get 10% off your next flight booking\",\n  \"pointsCost\": 1000,\n  \"discountType\": \"PERCENTAGE\",\n  \"discountValue\": 10,\n  \"maxDiscountAmount\": 100,\n  \"applicableProductTypes\": [\"FLIGHT_INTERNATIONAL\", \"FLIGHT_DOMESTIC\"],\n  \"validityDays\": 30,\n  \"maxUsesPerUser\": 1,\n  \"isActive\": true\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/rules",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"rules"
									]
								},
								"description": "**Create a new reward rule (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Request Body:**\n- `name` (string, required): Rule name\n- `description` (string, optional): Description\n- `pointsCost` (number, required): Points needed to redeem\n- `discountType` (string, required): PERCENTAGE or FIXED\n- `discountValue` (number, required): Discount value (10 = 10% or $10)\n- `maxDiscountAmount` (number, optional): Max discount for percentage type\n- `applicableProductTypes` (array, optional): Product types this applies to. null = all\n- `validityDays` (number, optional): Days voucher is valid after redemption (default: 30)\n- `maxUsesPerUser` (number, optional): Max times a user can redeem this\n- `isActive` (boolean, optional): Whether rule is active (default: true)"
							},
							"response": []
						},
						{
							"name": "List Reward Rules",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/rules",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"rules"
									]
								},
								"description": "**List all reward rules (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Response:**\nArray of reward rules with details."
							},
							"response": []
						},
						{
							"name": "Get Reward Rule by ID",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/rules/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"rules",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "reward-rule-id",
											"description": "Reward rule ID"
										}
									]
								},
								"description": "**Get a specific reward rule by ID (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)"
							},
							"response": []
						},
						{
							"name": "Update Reward Rule",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"15% Flight Discount\",\n  \"pointsCost\": 1500,\n  \"discountValue\": 15,\n  \"isActive\": true\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/rules/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"rules",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "reward-rule-id",
											"description": "Reward rule ID to update"
										}
									]
								},
								"description": "**Update a reward rule (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**All fields optional - only provided fields are updated.**"
							},
							"response": []
						},
						{
							"name": "Delete Reward Rule",
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/rules/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"rules",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "reward-rule-id",
											"description": "Reward rule ID to delete"
										}
									]
								},
								"description": "**Delete a reward rule (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)"
							},
							"response": []
						},
						{
							"name": "Seed Default Tiers",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/tiers/seed-defaults",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"tiers",
										"seed-defaults"
									]
								},
								"description": "**Seed default loyalty tier configurations (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Creates the following tiers:**\n- BRONZE: 0 min points, 1x multiplier\n- SILVER: 1000 min points, 1.5x multiplier\n- GOLD: 5000 min points, 2x multiplier\n- PLATINUM: 10000 min points, 3x multiplier\n\n**Note:** Run this once after initial setup. Safe to run multiple times (uses upsert)."
							},
							"response": []
						},
						{
							"name": "Get Loyalty Tiers",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/tiers",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"tiers"
									]
								},
								"description": "**Get all loyalty tier configurations (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Response:**\nArray of tier configs with name, min points, multiplier, benefits."
							},
							"response": []
						},
						{
							"name": "Update Loyalty Tier",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"tier\": \"GOLD\",\n  \"name\": \"Gold Elite\",\n  \"minPoints\": 5000,\n  \"multiplier\": 2.5,\n  \"benefits\": [\"Priority support\", \"Free cancellation\", \"Lounge access\"]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/tiers",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"tiers"
									]
								},
								"description": "**Update a loyalty tier configuration (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Request Body:**\n- `tier` (string, required): Tier to update (BRONZE, SILVER, GOLD, PLATINUM)\n- `name` (string, optional): Display name\n- `minPoints` (number, optional): Minimum lifetime points for this tier\n- `multiplier` (number, optional): Points earning multiplier\n- `benefits` (array, optional): List of tier benefits"
							},
							"response": []
						},
						{
							"name": "Seed Default Earning Rules",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/earning-rules/seed-defaults",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"earning-rules",
										"seed-defaults"
									]
								},
								"description": "**Seed default points earning rules (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Creates the following earning rules:**\n- FLIGHT_INTERNATIONAL: 10 points per $1 spent\n- FLIGHT_DOMESTIC: 5 points per $1 spent\n- HOTEL: 8 points per $1 spent\n- CAR_RENTAL: 3 points per $1 spent\n\n**Note:** Run this once after initial setup. Safe to run multiple times (uses upsert)."
							},
							"response": []
						},
						{
							"name": "Get Points Earning Rules",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/earning-rules",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"earning-rules"
									]
								},
								"description": "**Get all points earning rules (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Response:**\nArray of earning rules with product type, points per unit, and currency."
							},
							"response": []
						},
						{
							"name": "Update Points Earning Rule",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"productType\": \"HOTEL\",\n  \"pointsPerUnit\": 12,\n  \"unitAmount\": 1,\n  \"currency\": \"USD\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/earning-rules",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"earning-rules"
									]
								},
								"description": "**Update a points earning rule (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Request Body:**\n- `productType` (string, required): Product type to update\n- `pointsPerUnit` (number, required): Points earned per unit of currency spent\n- `unitAmount` (number, optional): Currency unit (default: 1 = per $1)\n- `currency` (string, optional): Base currency for calculation"
							},
							"response": []
						},
						{
							"name": "List All Vouchers",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/vouchers",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"vouchers"
									]
								},
								"description": "**List all vouchers across all users (Admin only).** Query: userId?, status? (ACTIVE, USED, EXPIRED, CANCELLED), page?, limit?. Response: data, meta, message."
							},
							"response": []
						},
						{
							"name": "Create Coupon (Manual Voucher)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"userId\": \"{{customerId}}\",\n  \"code\": \"PROMO20\",\n  \"discountType\": \"PERCENTAGE\",\n  \"discountValue\": 20,\n  \"currency\": \"GBP\",\n  \"maxDiscountAmount\": 50,\n  \"minBookingAmount\": 100,\n  \"applicableProducts\": [\"FLIGHT_DOMESTIC\", \"FLIGHT_INTERNATIONAL\"],\n  \"expiresAt\": \"2026-12-31T23:59:59.000Z\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/vouchers/manual",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"vouchers",
										"manual"
									]
								},
								"description": "Issue a promotional voucher without points redemption. Body: userId, code (unique, stored uppercase), discountType (PERCENTAGE | FIXED_AMOUNT), discountValue, currency?, maxDiscountAmount?, minBookingAmount?, applicableProducts? (array or null = all), expiresAt (ISO, future)."
							},
							"response": []
						},
						{
							"name": "Delete Voucher",
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/vouchers/:id",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"vouchers",
										":id"
									],
									"variable": [
										{
											"key": "id",
											"value": "voucher-id",
											"description": "Voucher ID to delete"
										}
									]
								},
								"description": "**Delete a voucher (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)"
							},
							"response": []
						},
						{
							"name": "Adjust User Points",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"points\": 500,\n  \"reason\": \"Customer service compensation\",\n  \"type\": \"BONUS\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/users/:userId/adjust-points",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"users",
										":userId",
										"adjust-points"
									],
									"variable": [
										{
											"key": "userId",
											"value": "{{userId}}",
											"description": "User ID to adjust points for"
										}
									]
								},
								"description": "**Manually adjust a user's loyalty points (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**Request Body:**\n- `points` (number, required): Points to add (positive) or deduct (negative)\n- `reason` (string, required): Reason for adjustment\n- `type` (string, optional): BONUS, ADJUSTMENT, or EXPIRE (default: ADJUSTMENT)\n\n**Use Cases:**\n- Customer service compensation\n- Promotional bonus points\n- Manual correction\n- Expiring unused points"
							},
							"response": []
						},
						{
							"name": "Get User's Loyalty Account (Admin View)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/admin/rewards/users/:userId/loyalty",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"admin",
										"rewards",
										"users",
										":userId",
										"loyalty"
									],
									"variable": [
										{
											"key": "userId",
											"value": "{{userId}}",
											"description": "User ID to view loyalty for"
										}
									]
								},
								"description": "**Get a specific user's loyalty account (Admin only).**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**URL Parameters:**\n- `userId` (string, required): User ID to view\n\n**Response includes:**\n- Loyalty account details\n- Current points and tier\n- Transaction history\n- Vouchers"
							},
							"response": []
						}
					],
					"description": "**Admin rewards and loyalty management endpoints.**\n\n**All endpoints require Admin role.**\n\n**Features:**\n- Configure reward rules (what users can redeem)\n- Configure loyalty tiers (BRONZE, SILVER, GOLD, PLATINUM)\n- Configure points earning rules (points per $1 by product type)\n- Manage vouchers across all users\n- Adjust user points manually\n- View user loyalty accounts\n\n**Setup (run once):**\n1. Seed default tiers: `POST /admin/rewards/tiers/seed-defaults`\n2. Seed default earning rules: `POST /admin/rewards/earning-rules/seed-defaults`\n3. Create reward rules: `POST /admin/rewards/rules`\n\n**Ongoing Management:**\n- Adjust tier thresholds and multipliers\n- Create/modify reward redemption options\n- Adjust earning rates\n- Award bonus points to users\n- Monitor voucher usage"
				},
				{
					"name": "Dashboard",
					"item": [
						{
							"name": "Get Dashboard Statistics (Admin Only)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{token}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/api/v1/dashboard/stats?startDate=&endDate=&productType=&compareWithPrevious=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"v1",
										"dashboard",
										"stats"
									],
									"query": [
										{
											"key": "startDate",
											"value": "",
											"description": "Start date (ISO). Default: 30 days ago.",
											"disabled": true
										},
										{
											"key": "endDate",
											"value": "",
											"description": "End date (ISO). Default: today.",
											"disabled": true
										},
										{
											"key": "productType",
											"value": "",
											"description": "Filter all aggregates (e.g. FLIGHT_DOMESTIC, HOTEL, CAR_RENTAL)",
											"disabled": true
										},
										{
											"key": "compareWithPrevious",
											"value": "true",
											"description": "If true, adds previousPeriod and percentChange",
											"disabled": true
										}
									]
								},
								"description": "**Get dashboard statistics (Admin only)**\n\n**Authentication required:** JWT Bearer token (Admin role)\n\n**What This Does:**\n- Returns comprehensive dashboard statistics\n- Includes total bookings, revenue, breakdowns by status, product type, provider, payment status\n- Includes recent bookings\n- Supports date range filtering\n\n**Query Parameters (optional):**\n- `startDate` (string): Start date for statistics (ISO string). Defaults to 30 days ago.\n- `endDate` (string): End date for statistics (ISO string). Defaults to today.\n\n**Response Structure:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"period\": {\n      \"start\": \"2026-01-01T00:00:00.000Z\",\n      \"end\": \"2026-02-05T23:59:59.999Z\"\n    },\n    \"totalBookings\": 150,\n    \"totalRevenue\": 250000.50,\n    \"bookingsByStatus\": {\n      \"CONFIRMED\": 120,\n      \"PENDING\": 20,\n      \"CANCELLED\": 10\n    },\n    \"bookingsByProductType\": {\n      \"FLIGHT\": {\n        \"count\": 80,\n        \"revenue\": 150000.00\n      },\n      \"HOTEL\": {\n        \"count\": 60,\n        \"revenue\": 90000.50\n      },\n      \"CAR_RENTAL\": {\n        \"count\": 10,\n        \"revenue\": 10000.00\n      }\n    },\n    \"bookingsByProvider\": {\n      \"DUFFEL\": 100,\n      \"AMADEUS\": 50\n    },\n    \"paymentStatusBreakdown\": {\n      \"COMPLETED\": 120,\n      \"PENDING\": 20,\n      \"FAILED\": 10\n    },\n    \"recentBookings\": [\n      {\n        \"id\": \"booking-id\",\n        \"reference\": \"EBT-20260205-123456\",\n        \"productType\": \"HOTEL\",\n        \"status\": \"CONFIRMED\",\n        \"totalAmount\": 2002.40,\n        \"currency\": \"GBP\",\n        \"user\": {\n          \"id\": \"user-id\",\n          \"email\": \"user@example.com\",\n          \"name\": \"User Name\"\n        },\n        \"createdAt\": \"2026-02-05T10:00:00.000Z\"\n      }\n    ]\n  },\n  \"message\": \"Dashboard statistics retrieved successfully\"\n}\n```\n\n**Response Fields:**\n- `period`: { start, end }\n- `totalBookings`, `totalRevenue`, `activeUsers` (customers with booking or registered in period)\n- `bookingsByStatus`, `bookingsByProductType`, `bookingsByProvider`, `paymentStatusBreakdown`\n- `recentBookings`: Last 10 in period (respects startDate/endDate and productType)\n- If compareWithPrevious=true: `previousPeriod` (totalBookings, totalRevenue), `percentChange` (totalBookings, totalRevenue)\n\n**Error Responses:**\n- `403 Forbidden` - Not an admin user\n\n**Note:**\n- Only admins can access dashboard statistics\n- Revenue is calculated from bookings with `paymentStatus: COMPLETED`\n- Recent bookings show last 10 bookings regardless of date range filter"
							},
							"response": []
						}
					],
					"description": "**Dashboard statistics endpoints (Admin only)**\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Admin Only:** All endpoints require ADMIN or SUPER_ADMIN role\n\n**Endpoints:**\n- **Get Dashboard Statistics** - Comprehensive statistics with breakdowns\n\n**Statistics Include:**\n- Total bookings and revenue\n- Breakdowns by status, product type, provider, payment status\n- Recent bookings\n- Date range filtering\n\n**Use Cases:**\n- Admin dashboard overview\n- Business analytics\n- Performance monitoring\n- Revenue tracking"
				},
				{
					"name": "Admin Booking Flow",
					"description": "Complete admin booking workflow for Ebony Bruce Travel.\n\n## Setup\n1. Set `baseUrl` variable (e.g. `http://localhost:3000/api/v1`)\n2. Run **1. Admin Login** to auto-set the `authToken`\n3. Run flows in order ‚Äî variables propagate automatically\n\n## Flows\n- **Flight**: Search ‚Üí Offers ‚Üí Book ‚Üí Pay\n- **Amadeus Hotel**: Search ‚Üí Details ‚Üí Book\n- **Car Rental**: Search ‚Üí Book",
					"item": [
						{
							"name": "0. Auth",
							"item": [
								{
									"name": "Admin Login",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var json = pm.response.json();",
													"if (json.data && json.data.accessToken) {",
													"    pm.collectionVariables.set('authToken', json.data.accessToken);",
													"    pm.test('Auth token saved', function () { pm.expect(json.data.accessToken).to.be.a('string'); });",
													"}"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "noauth"
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"email\": \"admin@ebonybrucetravel.com\",\n  \"password\": \"YOUR_ADMIN_PASSWORD\"\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/login",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"login"
											]
										}
									}
								}
							]
						},
						{
							"name": "1. Flight Booking Flow",
							"item": [
								{
									"name": "1a. Search Flights",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var json = pm.response.json();",
													"if (json.data && json.data.offer_request_id) {",
													"    pm.collectionVariables.set('offerRequestId', json.data.offer_request_id);",
													"    pm.test('offer_request_id saved', function () { pm.expect(json.data.offer_request_id).to.be.a('string'); });",
													"}"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"origin\": \"LHR\",\n  \"destination\": \"JFK\",\n  \"departureDate\": \"2026-04-15\",\n  \"passengers\": [{ \"type\": \"adult\" }],\n  \"cabinClass\": \"economy\",\n  \"currency\": \"GBP\"\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/search/flights",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"search",
												"flights"
											]
										}
									}
								},
								{
									"name": "1b. List Flight Offers",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var json = pm.response.json();",
													"if (json.data && json.data.length > 0) {",
													"    pm.collectionVariables.set('offerId', json.data[0].id);",
													"    pm.test('First offer ID saved', function () { pm.expect(json.data[0].id).to.be.a('string'); });",
													"}"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/offers?offer_request_id={{offerRequestId}}&limit=5",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"offers"
											],
											"query": [
												{
													"key": "offer_request_id",
													"value": "{{offerRequestId}}"
												},
												{
													"key": "limit",
													"value": "5"
												}
											]
										}
									}
								},
								{
									"name": "1c. Create Flight Booking (Domestic)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var json = pm.response.json();",
													"if (json.data && json.data.id) {",
													"    pm.collectionVariables.set('bookingId', json.data.id);",
													"    pm.test('Booking ID saved', function () { pm.expect(json.data.id).to.be.a('string'); });",
													"}"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"userId\": \"{{customerId}}\",\n  \"productType\": \"FLIGHT_DOMESTIC\",\n  \"provider\": \"DUFFEL\",\n  \"basePrice\": 185.50,\n  \"currency\": \"GBP\",\n  \"bookingData\": {\n    \"offerId\": \"{{offerId}}\"\n  },\n  \"passengerInfo\": {\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Doe\",\n    \"email\": \"jane@example.com\",\n    \"title\": \"mrs\",\n    \"gender\": \"f\",\n    \"dateOfBirth\": \"1990-05-15\",\n    \"phone\": \"+447123456789\"\n  }\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings"
											]
										}
									}
								},
								{
									"name": "1d. Create Flight Booking (International + Passport)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"var json = pm.response.json();",
													"if (json.data && json.data.id) {",
													"    pm.collectionVariables.set('bookingId', json.data.id);",
													"    pm.test('Booking ID saved', function () { pm.expect(json.data.id).to.be.a('string'); });",
													"}"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"userId\": \"{{customerId}}\",\n  \"productType\": \"FLIGHT_INTERNATIONAL\",\n  \"provider\": \"DUFFEL\",\n  \"basePrice\": 450.00,\n  \"currency\": \"GBP\",\n  \"bookingData\": {\n    \"offerId\": \"{{offerId}}\"\n  },\n  \"passengerInfo\": {\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Doe\",\n    \"email\": \"jane@example.com\",\n    \"title\": \"mrs\",\n    \"gender\": \"f\",\n    \"dateOfBirth\": \"1990-05-15\",\n    \"phone\": \"+447123456789\",\n    \"identityDocuments\": [\n      {\n        \"type\": \"passport\",\n        \"uniqueIdentifier\": \"AB1234567\",\n        \"issuingCountryCode\": \"GB\",\n        \"expiresOn\": \"2030-06-15\"\n      }\n    ],\n    \"loyaltyProgrammeAccounts\": [\n      {\n        \"airlineIataCode\": \"BA\",\n        \"accountNumber\": \"12901014\"\n      }\n    ]\n  }\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings"
											]
										}
									}
								}
							]
						},
						{
							"name": "2. Amadeus Hotel Booking Flow",
							"item": [
								{
									"name": "2a. Search Amadeus Hotels",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"cityCode\": \"LON\",\n  \"checkInDate\": \"2026-04-20\",\n  \"checkOutDate\": \"2026-04-23\",\n  \"adults\": 2,\n  \"roomQuantity\": 1,\n  \"currency\": \"GBP\"\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/search/amadeus-hotels",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"search",
												"amadeus-hotels"
											]
										}
									}
								},
								{
									"name": "2b. Get Hotel Details",
									"request": {
										"method": "GET",
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/amadeus-hotels/{{hotelId}}/details?checkInDate=2026-04-20&checkOutDate=2026-04-23&adults=2&currency=GBP",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"amadeus-hotels",
												"{{hotelId}}",
												"details"
											],
											"query": [
												{
													"key": "checkInDate",
													"value": "2026-04-20"
												},
												{
													"key": "checkOutDate",
													"value": "2026-04-23"
												},
												{
													"key": "adults",
													"value": "2"
												},
												{
													"key": "currency",
													"value": "GBP"
												}
											]
										}
									}
								},
								{
									"name": "2c. Book Amadeus Hotel",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"hotelOfferId\": \"<OFFER_ID_FROM_SEARCH>\",\n  \"offerPrice\": 350.00,\n  \"currency\": \"GBP\",\n  \"guests\": [\n    {\n      \"name\": {\n        \"title\": \"MR\",\n        \"firstName\": \"John\",\n        \"lastName\": \"Smith\"\n      },\n      \"contact\": {\n        \"phone\": \"+447123456789\",\n        \"email\": \"john@example.com\"\n      }\n    }\n  ],\n  \"roomAssociations\": [\n    {\n      \"hotelOfferId\": \"<OFFER_ID_FROM_SEARCH>\",\n      \"guestReferences\": [\n        { \"guestReference\": \"1\" }\n      ]\n    }\n  ],\n  \"payment\": {\n    \"method\": \"CREDIT_CARD\",\n    \"paymentCard\": {\n      \"paymentCardInfo\": {\n        \"vendorCode\": \"VI\",\n        \"cardNumber\": \"4111111111111111\",\n        \"expiryDate\": \"2027-12\",\n        \"holderName\": \"JOHN SMITH\"\n      }\n    }\n  },\n  \"travelAgentEmail\": \"admin@ebonybrucetravel.com\",\n  \"cancellationDeadline\": \"2026-04-18T23:59:00\",\n  \"cancellationPolicySnapshot\": \"Free cancellation until 18 April 2026\",\n  \"policyAccepted\": true\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/amadeus-hotels/book",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"amadeus-hotels",
												"book"
											]
										}
									}
								}
							]
						},
						{
							"name": "3. Car Rental Booking Flow",
							"item": [
								{
									"name": "3a. Search Car Rentals",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"startLocationCode\": \"LHR\",\n  \"startDateTime\": \"2026-04-20T10:00:00\",\n  \"endLocationCode\": \"LHR\",\n  \"endDateTime\": \"2026-04-23T10:00:00\",\n  \"passengers\": 2,\n  \"currency\": \"GBP\"\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/search/car-rentals",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"search",
												"car-rentals"
											]
										}
									}
								},
								{
									"name": "3b. Book Car Rental",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"userId\": \"{{customerId}}\",\n  \"productType\": \"CAR_RENTAL\",\n  \"provider\": \"AMADEUS\",\n  \"basePrice\": 250.00,\n  \"currency\": \"GBP\",\n  \"bookingData\": {\n    \"offerId\": \"<OFFER_ID_FROM_SEARCH>\"\n  },\n  \"passengerInfo\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Smith\",\n    \"email\": \"john@example.com\",\n    \"phone\": \"+447123456789\"\n  }\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/admin/bookings",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings"
											]
										}
									}
								}
							]
						},
						{
							"name": "4. Booking Management",
							"item": [
								{
									"name": "4a. List All Bookings",
									"request": {
										"method": "GET",
										"url": {
											"raw": "{{baseUrl}}/admin/bookings?limit=20&page=1",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings"
											],
											"query": [
												{
													"key": "limit",
													"value": "20"
												},
												{
													"key": "page",
													"value": "1"
												}
											]
										}
									}
								},
								{
									"name": "4b. Get Booking by ID",
									"request": {
										"method": "GET",
										"url": {
											"raw": "{{baseUrl}}/admin/bookings/{{bookingId}}",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"bookings",
												"{{bookingId}}"
											]
										}
									}
								},
								{
									"name": "4c. List Customers",
									"request": {
										"method": "GET",
										"url": {
											"raw": "{{baseUrl}}/admin/customers?limit=20",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"admin",
												"customers"
											],
											"query": [
												{
													"key": "limit",
													"value": "20"
												}
											]
										}
									}
								}
							]
						}
					]
				}
			],
			"description": "**Admin endpoints for managing users, bookings, and viewing statistics**\n\n**‚ö†Ô∏è RESTRICTIONS:**\n- **Super Admin Only:** User management endpoints require SUPER_ADMIN role\n- **Admin Only:** Booking management and dashboard require ADMIN or SUPER_ADMIN role\n\n**Sections:**\n1. **User Management** - Create, list, get, update, delete admin users; assign permissions\n2. **Booking Management** - List all bookings with filters\n3. **Audit Logs** - View audit log of sensitive admin actions\n4. **Dashboard** - View dashboard statistics\n\n**Permissions System:**\n- Regular ADMIN users can have fine-grained permissions\n- SUPER_ADMIN has all permissions by default\n- Permissions control access to specific features\n\n**Audit Logging:**\n- All sensitive admin actions are logged\n- Includes who, what, when, and what changed\n- Includes IP address and user agent\n\n**Note:**\n- Only SUPER_ADMIN can create other admins\n- Only SUPER_ADMIN can view audit logs\n- Regular admins can view bookings and dashboard stats"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global pre-request script",
					"if (!pm.environment.get('baseUrl')) {",
					"    pm.environment.set('baseUrl', 'http://localhost:3001');",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global test script",
					"console.log('Response time:', pm.response.responseTime + 'ms');"
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:3001",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": "",
			"type": "string"
		},
		{
			"key": "bookingId",
			"value": "",
			"type": "string"
		},
		{
			"key": "offerId",
			"value": "",
			"type": "string"
		},
		{
			"key": "offerRequestId",
			"value": "",
			"type": "string"
		},
		{
			"key": "voucherCode",
			"value": "",
			"type": "string"
		},
		{
			"key": "adminUserId",
			"value": "",
			"type": "string"
		},
		{
			"key": "customerId",
			"value": "",
			"type": "string"
		},
		{
			"key": "markupId",
			"value": "",
			"type": "string"
		},
		{
			"key": "amadeusOfferId",
			"value": "",
			"type": "string"
		},
		{
			"key": "amadeusHotelId",
			"value": "",
			"type": "string"
		},
		{
			"key": "authToken",
			"value": ""
		},
		{
			"key": "hotelId",
			"value": ""
		}
	]
}